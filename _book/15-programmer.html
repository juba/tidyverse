<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Partie 15 Programmer avec R | Introduction à R et au tidyverse</title>
  <meta name="description" content="Une introduction à R et aux extensions du tidyverse" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Partie 15 Programmer avec R | Introduction à R et au tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Une introduction à R et aux extensions du tidyverse" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Partie 15 Programmer avec R | Introduction à R et au tidyverse" />
  
  <meta name="twitter:description" content="Une introduction à R et aux extensions du tidyverse" />
  

<meta name="author" content="Julien Barnier" />


<meta name="date" content="2021-09-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="14-fonctions.html"/>
<link rel="next" href="16-dplyr-avance.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Introduction à R et au <em>tidyverse</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>À propos de ce document</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="01-presentation.html"><a href="01-presentation.html"><i class="fa fa-check"></i><b>1</b> Présentation</a><ul>
<li class="chapter" data-level="1.1" data-path="01-presentation.html"><a href="01-presentation.html#à-propos-de-r"><i class="fa fa-check"></i><b>1.1</b> À propos de R</a></li>
<li class="chapter" data-level="1.2" data-path="01-presentation.html"><a href="01-presentation.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> À propos de RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="01-presentation.html"><a href="01-presentation.html#à-propos-du-tidyverse"><i class="fa fa-check"></i><b>1.3</b> À propos du <em>tidyverse</em></a></li>
<li class="chapter" data-level="1.4" data-path="01-presentation.html"><a href="01-presentation.html#structure-du-document"><i class="fa fa-check"></i><b>1.4</b> Structure du document</a></li>
<li class="chapter" data-level="1.5" data-path="01-presentation.html"><a href="01-presentation.html#prérequis"><i class="fa fa-check"></i><b>1.5</b> Prérequis</a></li>
</ul></li>
<li class="part"><span><b>I Introduction à R</b></span></li>
<li class="chapter" data-level="2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html"><i class="fa fa-check"></i><b>2</b> Prise en main</a><ul>
<li class="chapter" data-level="2.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#la-console"><i class="fa fa-check"></i><b>2.1</b> La console</a><ul>
<li class="chapter" data-level="2.1.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#linvite-de-commandes"><i class="fa fa-check"></i><b>2.1.1</b> L’invite de commandes</a></li>
<li class="chapter" data-level="2.1.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#précisions-concernant-la-saisie-des-commandes"><i class="fa fa-check"></i><b>2.1.2</b> Précisions concernant la saisie des commandes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#objets"><i class="fa fa-check"></i><b>2.2</b> Objets</a><ul>
<li class="chapter" data-level="2.2.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#objets-simples"><i class="fa fa-check"></i><b>2.2.1</b> Objets simples</a></li>
<li class="chapter" data-level="2.2.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#introvecteurs"><i class="fa fa-check"></i><b>2.2.2</b> Vecteurs</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#fonctions"><i class="fa fa-check"></i><b>2.3</b> Fonctions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#principe"><i class="fa fa-check"></i><b>2.3.1</b> Principe</a></li>
<li class="chapter" data-level="2.3.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#arguments"><i class="fa fa-check"></i><b>2.3.2</b> Arguments</a></li>
<li class="chapter" data-level="2.3.3" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#aide-sur-une-fonction"><i class="fa fa-check"></i><b>2.3.3</b> Aide sur une fonction</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#regrouper-ses-commandes-dans-des-scripts"><i class="fa fa-check"></i><b>2.4</b> Regrouper ses commandes dans des scripts</a><ul>
<li class="chapter" data-level="2.4.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#commentaires"><i class="fa fa-check"></i><b>2.4.1</b> Commentaires</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#packages"><i class="fa fa-check"></i><b>2.5</b> Installer et charger des extensions (<em>packages</em>)</a></li>
<li class="chapter" data-level="2.6" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#exercices"><i class="fa fa-check"></i><b>2.6</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-premier_travail.html"><a href="03-premier_travail.html"><i class="fa fa-check"></i><b>3</b> Premier travail avec des données</a><ul>
<li class="chapter" data-level="3.1" data-path="03-premier_travail.html"><a href="03-premier_travail.html#jeu-de-données-dexemple"><i class="fa fa-check"></i><b>3.1</b> Jeu de données d’exemple</a></li>
<li class="chapter" data-level="3.2" data-path="03-premier_travail.html"><a href="03-premier_travail.html#tableau-de-données-data-frame"><i class="fa fa-check"></i><b>3.2</b> Tableau de données (<em>data frame</em>)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="03-premier_travail.html"><a href="03-premier_travail.html#structure-du-tableau"><i class="fa fa-check"></i><b>3.2.1</b> Structure du tableau</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-premier_travail.html"><a href="03-premier_travail.html#accéder-aux-variables-dun-tableau"><i class="fa fa-check"></i><b>3.2.2</b> Accéder aux variables d’un tableau</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-premier_travail.html"><a href="03-premier_travail.html#créer-une-nouvelle-variable"><i class="fa fa-check"></i><b>3.2.3</b> Créer une nouvelle variable</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="03-premier_travail.html"><a href="03-premier_travail.html#analyse-univariée"><i class="fa fa-check"></i><b>3.3</b> Analyse univariée</a><ul>
<li class="chapter" data-level="3.3.1" data-path="03-premier_travail.html"><a href="03-premier_travail.html#analyser-une-variable-quantitative"><i class="fa fa-check"></i><b>3.3.1</b> Analyser une variable quantitative</a></li>
<li class="chapter" data-level="3.3.2" data-path="03-premier_travail.html"><a href="03-premier_travail.html#analyser-une-variable-qualitative"><i class="fa fa-check"></i><b>3.3.2</b> Analyser une variable qualitative</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="03-premier_travail.html"><a href="03-premier_travail.html#exercices-1"><i class="fa fa-check"></i><b>3.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-bivarie.html"><a href="04-bivarie.html"><i class="fa fa-check"></i><b>4</b> Analyse bivariée</a><ul>
<li class="chapter" data-level="4.1" data-path="04-bivarie.html"><a href="04-bivarie.html#croisement-de-deux-variables-qualitatives"><i class="fa fa-check"></i><b>4.1</b> Croisement de deux variables qualitatives</a><ul>
<li class="chapter" data-level="4.1.1" data-path="04-bivarie.html"><a href="04-bivarie.html#tableaux-croisés"><i class="fa fa-check"></i><b>4.1.1</b> Tableaux croisés</a></li>
<li class="chapter" data-level="4.1.2" data-path="04-bivarie.html"><a href="04-bivarie.html#test-du-χ²"><i class="fa fa-check"></i><b>4.1.2</b> Test du χ²</a></li>
<li class="chapter" data-level="4.1.3" data-path="04-bivarie.html"><a href="04-bivarie.html#représentation-graphique-1"><i class="fa fa-check"></i><b>4.1.3</b> Représentation graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="04-bivarie.html"><a href="04-bivarie.html#croisement-dune-variable-quantitative-et-dune-variable-qualitative"><i class="fa fa-check"></i><b>4.2</b> Croisement d’une variable quantitative et d’une variable qualitative</a><ul>
<li class="chapter" data-level="4.2.1" data-path="04-bivarie.html"><a href="04-bivarie.html#représentation-graphique-2"><i class="fa fa-check"></i><b>4.2.1</b> Représentation graphique</a></li>
<li class="chapter" data-level="4.2.2" data-path="04-bivarie.html"><a href="04-bivarie.html#tapply"><i class="fa fa-check"></i><b>4.2.2</b> Calculs d’indicateurs</a></li>
<li class="chapter" data-level="4.2.3" data-path="04-bivarie.html"><a href="04-bivarie.html#tests-statistiques"><i class="fa fa-check"></i><b>4.2.3</b> Tests statistiques</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="04-bivarie.html"><a href="04-bivarie.html#croisement-de-deux-variables-quantitatives"><i class="fa fa-check"></i><b>4.3</b> Croisement de deux variables quantitatives</a><ul>
<li class="chapter" data-level="4.3.1" data-path="04-bivarie.html"><a href="04-bivarie.html#représentation-graphique-3"><i class="fa fa-check"></i><b>4.3.1</b> Représentation graphique</a></li>
<li class="chapter" data-level="4.3.2" data-path="04-bivarie.html"><a href="04-bivarie.html#calcul-dindicateurs"><i class="fa fa-check"></i><b>4.3.2</b> Calcul d’indicateurs</a></li>
<li class="chapter" data-level="4.3.3" data-path="04-bivarie.html"><a href="04-bivarie.html#régression-linéaire"><i class="fa fa-check"></i><b>4.3.3</b> Régression linéaire</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="04-bivarie.html"><a href="04-bivarie.html#exercices-2"><i class="fa fa-check"></i><b>4.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-organiser.html"><a href="05-organiser.html"><i class="fa fa-check"></i><b>5</b> Organiser ses scripts</a><ul>
<li class="chapter" data-level="5.1" data-path="05-organiser.html"><a href="05-organiser.html#projets"><i class="fa fa-check"></i><b>5.1</b> Les projets dans RStudio</a></li>
<li class="chapter" data-level="5.2" data-path="05-organiser.html"><a href="05-organiser.html#créer-des-sections-dans-un-script"><i class="fa fa-check"></i><b>5.2</b> Créer des sections dans un script</a></li>
<li class="chapter" data-level="5.3" data-path="05-organiser.html"><a href="05-organiser.html#répartir-son-travail-entre-plusieurs-scripts"><i class="fa fa-check"></i><b>5.3</b> Répartir son travail entre plusieurs scripts</a></li>
<li class="chapter" data-level="5.4" data-path="05-organiser.html"><a href="05-organiser.html#désactiver-la-sauvegarde-de-lespace-de-travail"><i class="fa fa-check"></i><b>5.4</b> Désactiver la sauvegarde de l’espace de travail</a></li>
</ul></li>
<li class="part"><span><b>II Introduction au tidyverse</b></span></li>
<li class="chapter" data-level="6" data-path="06-tidyverse.html"><a href="06-tidyverse.html"><i class="fa fa-check"></i><b>6</b> Le tidyverse</a><ul>
<li class="chapter" data-level="6.1" data-path="06-tidyverse.html"><a href="06-tidyverse.html#extensions"><i class="fa fa-check"></i><b>6.1</b> Extensions</a></li>
<li class="chapter" data-level="6.2" data-path="06-tidyverse.html"><a href="06-tidyverse.html#installation"><i class="fa fa-check"></i><b>6.2</b> Installation</a></li>
<li class="chapter" data-level="6.3" data-path="06-tidyverse.html"><a href="06-tidyverse.html#tidydata"><i class="fa fa-check"></i><b>6.3</b> tidy data</a></li>
<li class="chapter" data-level="6.4" data-path="06-tidyverse.html"><a href="06-tidyverse.html#tibbles"><i class="fa fa-check"></i><b>6.4</b> tibbles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-import.html"><a href="07-import.html"><i class="fa fa-check"></i><b>7</b> Importer et exporter des données</a><ul>
<li class="chapter" data-level="7.1" data-path="07-import.html"><a href="07-import.html#import-de-fichiers-textes"><i class="fa fa-check"></i><b>7.1</b> Import de fichiers textes</a><ul>
<li class="chapter" data-level="7.1.1" data-path="07-import.html"><a href="07-import.html#interface-interactive-dimport-de-fichiers"><i class="fa fa-check"></i><b>7.1.1</b> Interface interactive d’import de fichiers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="07-import.html"><a href="07-import.html#import-depuis-un-fichier-excel"><i class="fa fa-check"></i><b>7.2</b> Import depuis un fichier Excel</a></li>
<li class="chapter" data-level="7.3" data-path="07-import.html"><a href="07-import.html#import-de-fichiers-sas-spss-et-stata"><i class="fa fa-check"></i><b>7.3</b> Import de fichiers SAS, SPSS et Stata</a></li>
<li class="chapter" data-level="7.4" data-path="07-import.html"><a href="07-import.html#import-de-fichiers-dbase"><i class="fa fa-check"></i><b>7.4</b> Import de fichiers dBase</a></li>
<li class="chapter" data-level="7.5" data-path="07-import.html"><a href="07-import.html#connexion-à-des-bases-de-données"><i class="fa fa-check"></i><b>7.5</b> Connexion à des bases de données</a><ul>
<li class="chapter" data-level="7.5.1" data-path="07-import.html"><a href="07-import.html#interfaçage-via-lextension-dbi"><i class="fa fa-check"></i><b>7.5.1</b> Interfaçage via l’extension <code>DBI</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="07-import.html"><a href="07-import.html#utilisation-de-dplyr-et-dbplyr"><i class="fa fa-check"></i><b>7.5.2</b> Utilisation de <code>dplyr</code> et <code>dbplyr</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="07-import.html"><a href="07-import.html#ressources"><i class="fa fa-check"></i><b>7.5.3</b> Ressources</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="07-import.html"><a href="07-import.html#export-de-données"><i class="fa fa-check"></i><b>7.6</b> Export de données</a><ul>
<li class="chapter" data-level="7.6.1" data-path="07-import.html"><a href="07-import.html#export-de-tableaux-de-données"><i class="fa fa-check"></i><b>7.6.1</b> Export de tableaux de données</a></li>
<li class="chapter" data-level="7.6.2" data-path="07-import.html"><a href="07-import.html#sauvegarder-des-objets"><i class="fa fa-check"></i><b>7.6.2</b> Sauvegarder des objets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-ggplot2.html"><a href="08-ggplot2.html"><i class="fa fa-check"></i><b>8</b> Visualiser avec <code>ggplot2</code></a><ul>
<li class="chapter" data-level="8.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#préparation"><i class="fa fa-check"></i><b>8.1</b> Préparation</a></li>
<li class="chapter" data-level="8.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#initialisation"><i class="fa fa-check"></i><b>8.2</b> Initialisation</a></li>
<li class="chapter" data-level="8.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#exemples-de-geom"><i class="fa fa-check"></i><b>8.3</b> Exemples de <code>geom</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_boxplot"><i class="fa fa-check"></i><b>8.3.1</b> <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="8.3.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_violin"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_violin</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_bar"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_bar</code></a></li>
<li class="chapter" data-level="8.3.4" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_text"><i class="fa fa-check"></i><b>8.3.4</b> <code>geom_text</code></a></li>
<li class="chapter" data-level="8.3.5" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_label"><i class="fa fa-check"></i><b>8.3.5</b> <code>geom_label</code></a></li>
<li class="chapter" data-level="8.3.6" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_density"><i class="fa fa-check"></i><b>8.3.6</b> <code>geom_density</code></a></li>
<li class="chapter" data-level="8.3.7" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_line"><i class="fa fa-check"></i><b>8.3.7</b> <code>geom_line</code></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="08-ggplot2.html"><a href="08-ggplot2.html#mappages"><i class="fa fa-check"></i><b>8.4</b> Mappages</a><ul>
<li class="chapter" data-level="8.4.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#exemples-de-mappages"><i class="fa fa-check"></i><b>8.4.1</b> Exemples de mappages</a></li>
<li class="chapter" data-level="8.4.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#aes-or-not-aes"><i class="fa fa-check"></i><b>8.4.2</b> <code>aes()</code> or not <code>aes()</code> ?</a></li>
<li class="chapter" data-level="8.4.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_bar-et-position"><i class="fa fa-check"></i><b>8.4.3</b> <code>geom_bar</code> et <code>position</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="08-ggplot2.html"><a href="08-ggplot2.html#représentation-de-plusieurs-geom"><i class="fa fa-check"></i><b>8.5</b> Représentation de plusieurs <code>geom</code></a><ul>
<li class="chapter" data-level="8.5.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#plusieurs-sources-de-données"><i class="fa fa-check"></i><b>8.5.1</b> Plusieurs sources de données</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="08-ggplot2.html"><a href="08-ggplot2.html#faceting"><i class="fa fa-check"></i><b>8.6</b> Faceting</a></li>
<li class="chapter" data-level="8.7" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scales"><i class="fa fa-check"></i><b>8.7</b> Scales</a><ul>
<li class="chapter" data-level="8.7.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scale_size"><i class="fa fa-check"></i><b>8.7.1</b> <code>scale_size</code></a></li>
<li class="chapter" data-level="8.7.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scale_x-scale_y"><i class="fa fa-check"></i><b>8.7.2</b> <code>scale_x</code>, <code>scale_y</code></a></li>
<li class="chapter" data-level="8.7.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scalecolor"><i class="fa fa-check"></i><b>8.7.3</b> <code>scale_color</code>, <code>scale_fill</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="08-ggplot2.html"><a href="08-ggplot2.html#thèmes"><i class="fa fa-check"></i><b>8.8</b> Thèmes</a></li>
<li class="chapter" data-level="8.9" data-path="08-ggplot2.html"><a href="08-ggplot2.html#ladd-in-esquisse"><i class="fa fa-check"></i><b>8.9</b> L’add-in <code>esquisse</code></a></li>
<li class="chapter" data-level="8.10" data-path="08-ggplot2.html"><a href="08-ggplot2.html#ressources-1"><i class="fa fa-check"></i><b>8.10</b> Ressources</a></li>
<li class="chapter" data-level="8.11" data-path="08-ggplot2.html"><a href="08-ggplot2.html#exercices-3"><i class="fa fa-check"></i><b>8.11</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-recodages.html"><a href="09-recodages.html"><i class="fa fa-check"></i><b>9</b> Recoder des variables</a><ul>
<li class="chapter" data-level="9.1" data-path="09-recodages.html"><a href="09-recodages.html#vecteurs"><i class="fa fa-check"></i><b>9.1</b> Rappel sur les variables et les vecteurs</a></li>
<li class="chapter" data-level="9.2" data-path="09-recodages.html"><a href="09-recodages.html#tests"><i class="fa fa-check"></i><b>9.2</b> Tests et comparaison</a></li>
<li class="chapter" data-level="9.3" data-path="09-recodages.html"><a href="09-recodages.html#recoder-une-variable-qualitative"><i class="fa fa-check"></i><b>9.3</b> Recoder une variable qualitative</a><ul>
<li class="chapter" data-level="9.3.1" data-path="09-recodages.html"><a href="09-recodages.html#facteurs"><i class="fa fa-check"></i><b>9.3.1</b> Facteurs et <code>forcats</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="09-recodages.html"><a href="09-recodages.html#recode"><i class="fa fa-check"></i><b>9.3.2</b> Modifier les modalités d’une variable qualitative</a></li>
<li class="chapter" data-level="9.3.3" data-path="09-recodages.html"><a href="09-recodages.html#ordonner-les-modalités-dune-variable-qualitative"><i class="fa fa-check"></i><b>9.3.3</b> Ordonner les modalités d’une variable qualitative</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="09-recodages.html"><a href="09-recodages.html#combiner-plusieurs-variables"><i class="fa fa-check"></i><b>9.4</b> Combiner plusieurs variables</a><ul>
<li class="chapter" data-level="9.4.1" data-path="09-recodages.html"><a href="09-recodages.html#if-else"><i class="fa fa-check"></i><b>9.4.1</b> <code>if_else</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="09-recodages.html"><a href="09-recodages.html#case_when"><i class="fa fa-check"></i><b>9.4.2</b> <code>case_when</code></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="09-recodages.html"><a href="09-recodages.html#découper-une-variable-numérique-en-classes"><i class="fa fa-check"></i><b>9.5</b> Découper une variable numérique en classes</a><ul>
<li class="chapter" data-level="9.5.1" data-path="09-recodages.html"><a href="09-recodages.html#interface-graphique"><i class="fa fa-check"></i><b>9.5.1</b> Interface graphique</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="09-recodages.html"><a href="09-recodages.html#exercices-4"><i class="fa fa-check"></i><b>9.6</b> Exercices</a><ul>
<li class="chapter" data-level="9.6.1" data-path="09-recodages.html"><a href="09-recodages.html#préparation-1"><i class="fa fa-check"></i><b>9.6.1</b> Préparation</a></li>
<li class="chapter" data-level="9.6.2" data-path="09-recodages.html"><a href="09-recodages.html#vecteurs-et-tests"><i class="fa fa-check"></i><b>9.6.2</b> Vecteurs et tests</a></li>
<li class="chapter" data-level="9.6.3" data-path="09-recodages.html"><a href="09-recodages.html#recodages-de-variable-qualitative"><i class="fa fa-check"></i><b>9.6.3</b> Recodages de variable qualitative</a></li>
<li class="chapter" data-level="9.6.4" data-path="09-recodages.html"><a href="09-recodages.html#combiner-plusieurs-variables-1"><i class="fa fa-check"></i><b>9.6.4</b> Combiner plusieurs variables</a></li>
<li class="chapter" data-level="9.6.5" data-path="09-recodages.html"><a href="09-recodages.html#découper-une-variable-numérique"><i class="fa fa-check"></i><b>9.6.5</b> Découper une variable numérique</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-dplyr.html"><a href="10-dplyr.html"><i class="fa fa-check"></i><b>10</b> Manipuler les données avec <code>dplyr</code></a><ul>
<li class="chapter" data-level="10.1" data-path="10-dplyr.html"><a href="10-dplyr.html#préparation-2"><i class="fa fa-check"></i><b>10.1</b> Préparation</a></li>
<li class="chapter" data-level="10.2" data-path="10-dplyr.html"><a href="10-dplyr.html#les-verbes-de-dplyr"><i class="fa fa-check"></i><b>10.2</b> Les verbes de <code>dplyr</code></a><ul>
<li class="chapter" data-level="10.2.1" data-path="10-dplyr.html"><a href="10-dplyr.html#slice"><i class="fa fa-check"></i><b>10.2.1</b> <code>slice</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="10-dplyr.html"><a href="10-dplyr.html#filter"><i class="fa fa-check"></i><b>10.2.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="10-dplyr.html"><a href="10-dplyr.html#select-rename"><i class="fa fa-check"></i><b>10.2.3</b> <code>select</code> et <code>rename</code></a></li>
<li class="chapter" data-level="10.2.4" data-path="10-dplyr.html"><a href="10-dplyr.html#arrange"><i class="fa fa-check"></i><b>10.2.4</b> <code>arrange</code></a></li>
<li class="chapter" data-level="10.2.5" data-path="10-dplyr.html"><a href="10-dplyr.html#mutate"><i class="fa fa-check"></i><b>10.2.5</b> <code>mutate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-dplyr.html"><a href="10-dplyr.html#pipe"><i class="fa fa-check"></i><b>10.3</b> Enchaîner les opérations avec le <em>pipe</em></a></li>
<li class="chapter" data-level="10.4" data-path="10-dplyr.html"><a href="10-dplyr.html#opérations-groupées"><i class="fa fa-check"></i><b>10.4</b> Opérations groupées</a><ul>
<li class="chapter" data-level="10.4.1" data-path="10-dplyr.html"><a href="10-dplyr.html#group_by"><i class="fa fa-check"></i><b>10.4.1</b> <code>group_by</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="10-dplyr.html"><a href="10-dplyr.html#summarise-et-count"><i class="fa fa-check"></i><b>10.4.2</b> <code>summarise</code> et <code>count</code></a></li>
<li class="chapter" data-level="10.4.3" data-path="10-dplyr.html"><a href="10-dplyr.html#grouper-selon-plusieurs-variables"><i class="fa fa-check"></i><b>10.4.3</b> Grouper selon plusieurs variables</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="10-dplyr.html"><a href="10-dplyr.html#autres-fonctions-utiles"><i class="fa fa-check"></i><b>10.5</b> Autres fonctions utiles</a><ul>
<li class="chapter" data-level="10.5.1" data-path="10-dplyr.html"><a href="10-dplyr.html#slice_sample"><i class="fa fa-check"></i><b>10.5.1</b> <code>slice_sample</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="10-dplyr.html"><a href="10-dplyr.html#slice_head-slice_tail-slice_min-slice_max"><i class="fa fa-check"></i><b>10.5.2</b> <code>slice_head</code>, <code>slice_tail</code>, <code>slice_min</code>, <code>slice_max</code></a></li>
<li class="chapter" data-level="10.5.3" data-path="10-dplyr.html"><a href="10-dplyr.html#lead-et-lag"><i class="fa fa-check"></i><b>10.5.3</b> <code>lead</code> et <code>lag</code></a></li>
<li class="chapter" data-level="10.5.4" data-path="10-dplyr.html"><a href="10-dplyr.html#distinct-et-n_distinct"><i class="fa fa-check"></i><b>10.5.4</b> <code>distinct</code> et <code>n_distinct</code></a></li>
<li class="chapter" data-level="10.5.5" data-path="10-dplyr.html"><a href="10-dplyr.html#relocate"><i class="fa fa-check"></i><b>10.5.5</b> <code>relocate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="10-dplyr.html"><a href="10-dplyr.html#tables-multiples"><i class="fa fa-check"></i><b>10.6</b> Tables multiples</a><ul>
<li class="chapter" data-level="10.6.1" data-path="10-dplyr.html"><a href="10-dplyr.html#concaténation-bind_rows-et-bind_cols"><i class="fa fa-check"></i><b>10.6.1</b> Concaténation : <code>bind_rows</code> et <code>bind_cols</code></a></li>
<li class="chapter" data-level="10.6.2" data-path="10-dplyr.html"><a href="10-dplyr.html#jointures"><i class="fa fa-check"></i><b>10.6.2</b> Jointures</a></li>
<li class="chapter" data-level="10.6.3" data-path="10-dplyr.html"><a href="10-dplyr.html#types-de-jointures"><i class="fa fa-check"></i><b>10.6.3</b> Types de jointures</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="10-dplyr.html"><a href="10-dplyr.html#ressources-2"><i class="fa fa-check"></i><b>10.7</b> Ressources</a></li>
<li class="chapter" data-level="10.8" data-path="10-dplyr.html"><a href="10-dplyr.html#exercices-5"><i class="fa fa-check"></i><b>10.8</b> Exercices</a><ul>
<li class="chapter" data-level="10.8.1" data-path="10-dplyr.html"><a href="10-dplyr.html#les-verbes-de-base-de-dplyr"><i class="fa fa-check"></i><b>10.8.1</b> Les verbes de base de <code>dplyr</code></a></li>
<li class="chapter" data-level="10.8.2" data-path="10-dplyr.html"><a href="10-dplyr.html#enchaîner-des-opérations"><i class="fa fa-check"></i><b>10.8.2</b> Enchaîner des opérations</a></li>
<li class="chapter" data-level="10.8.3" data-path="10-dplyr.html"><a href="10-dplyr.html#group_by-et-summarise"><i class="fa fa-check"></i><b>10.8.3</b> <code>group_by</code> et <code>summarise</code></a></li>
<li class="chapter" data-level="10.8.4" data-path="10-dplyr.html"><a href="10-dplyr.html#jointures-1"><i class="fa fa-check"></i><b>10.8.4</b> Jointures</a></li>
<li class="chapter" data-level="10.8.5" data-path="10-dplyr.html"><a href="10-dplyr.html#bonus"><i class="fa fa-check"></i><b>10.8.5</b> Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-stringr.html"><a href="11-stringr.html"><i class="fa fa-check"></i><b>11</b> Manipuler du texte avec <code>stringr</code></a><ul>
<li class="chapter" data-level="11.1" data-path="11-stringr.html"><a href="11-stringr.html#expressions-régulières"><i class="fa fa-check"></i><b>11.1</b> Expressions régulières</a></li>
<li class="chapter" data-level="11.2" data-path="11-stringr.html"><a href="11-stringr.html#concat"><i class="fa fa-check"></i><b>11.2</b> Concaténer des chaînes</a></li>
<li class="chapter" data-level="11.3" data-path="11-stringr.html"><a href="11-stringr.html#convertir-en-majuscules-minuscules"><i class="fa fa-check"></i><b>11.3</b> Convertir en majuscules / minuscules</a></li>
<li class="chapter" data-level="11.4" data-path="11-stringr.html"><a href="11-stringr.html#découper-des-chaînes"><i class="fa fa-check"></i><b>11.4</b> Découper des chaînes</a></li>
<li class="chapter" data-level="11.5" data-path="11-stringr.html"><a href="11-stringr.html#extraire-des-sous-chaînes-par-position"><i class="fa fa-check"></i><b>11.5</b> Extraire des sous-chaînes par position</a></li>
<li class="chapter" data-level="11.6" data-path="11-stringr.html"><a href="11-stringr.html#str-detect"><i class="fa fa-check"></i><b>11.6</b> Détecter des motifs</a></li>
<li class="chapter" data-level="11.7" data-path="11-stringr.html"><a href="11-stringr.html#extraire-des-motifs"><i class="fa fa-check"></i><b>11.7</b> Extraire des motifs</a></li>
<li class="chapter" data-level="11.8" data-path="11-stringr.html"><a href="11-stringr.html#remplacer-des-motifs"><i class="fa fa-check"></i><b>11.8</b> Remplacer des motifs</a></li>
<li class="chapter" data-level="11.9" data-path="11-stringr.html"><a href="11-stringr.html#modificateurs"><i class="fa fa-check"></i><b>11.9</b> Modificateurs de motifs</a></li>
<li class="chapter" data-level="11.10" data-path="11-stringr.html"><a href="11-stringr.html#ressources-3"><i class="fa fa-check"></i><b>11.10</b> Ressources</a></li>
<li class="chapter" data-level="11.11" data-path="11-stringr.html"><a href="11-stringr.html#exercices-6"><i class="fa fa-check"></i><b>11.11</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-tidyr.html"><a href="12-tidyr.html"><i class="fa fa-check"></i><b>12</b> Mettre en ordre avec <code>tidyr</code></a><ul>
<li class="chapter" data-level="12.1" data-path="12-tidyr.html"><a href="12-tidyr.html#tidy-data"><i class="fa fa-check"></i><b>12.1</b> Tidy data</a></li>
<li class="chapter" data-level="12.2" data-path="12-tidyr.html"><a href="12-tidyr.html#trois-règles-pour-des-données-bien-rangées"><i class="fa fa-check"></i><b>12.2</b> Trois règles pour des données bien rangées</a></li>
<li class="chapter" data-level="12.3" data-path="12-tidyr.html"><a href="12-tidyr.html#les-verbes-de-tidyr"><i class="fa fa-check"></i><b>12.3</b> Les verbes de <code>tidyr</code></a><ul>
<li class="chapter" data-level="12.3.1" data-path="12-tidyr.html"><a href="12-tidyr.html#pivot_longer-transformer-des-colonnes-en-lignes"><i class="fa fa-check"></i><b>12.3.1</b> <code>pivot_longer</code> : transformer des colonnes en lignes</a></li>
<li class="chapter" data-level="12.3.2" data-path="12-tidyr.html"><a href="12-tidyr.html#pivot_wider-transformer-des-lignes-en-colonnes"><i class="fa fa-check"></i><b>12.3.2</b> <code>pivot_wider</code> : transformer des lignes en colonnes</a></li>
<li class="chapter" data-level="12.3.3" data-path="12-tidyr.html"><a href="12-tidyr.html#separate"><i class="fa fa-check"></i><b>12.3.3</b> <code>separate</code> : séparer une colonne en plusieurs colonnes</a></li>
<li class="chapter" data-level="12.3.4" data-path="12-tidyr.html"><a href="12-tidyr.html#separate-rows"><i class="fa fa-check"></i><b>12.3.4</b> <code>separate_rows</code> : séparer une colonne en plusieurs lignes</a></li>
<li class="chapter" data-level="12.3.5" data-path="12-tidyr.html"><a href="12-tidyr.html#unite-regrouper-plusieurs-colonnes-en-une-seule"><i class="fa fa-check"></i><b>12.3.5</b> <code>unite</code> : regrouper plusieurs colonnes en une seule</a></li>
<li class="chapter" data-level="12.3.6" data-path="12-tidyr.html"><a href="12-tidyr.html#extract"><i class="fa fa-check"></i><b>12.3.6</b> <code>extract</code> : créer de nouvelles colonnes à partir d’une colonne de texte</a></li>
<li class="chapter" data-level="12.3.7" data-path="12-tidyr.html"><a href="12-tidyr.html#complete-compléter-des-combinaisons-de-variables-manquantes"><i class="fa fa-check"></i><b>12.3.7</b> <code>complete</code> : compléter des combinaisons de variables manquantes</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="12-tidyr.html"><a href="12-tidyr.html#ressources-4"><i class="fa fa-check"></i><b>12.4</b> Ressources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html"><i class="fa fa-check"></i><b>13</b> Diffuser et publier avec <code>rmarkdown</code></a><ul>
<li class="chapter" data-level="13.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#créer-un-nouveau-document"><i class="fa fa-check"></i><b>13.1</b> Créer un nouveau document</a></li>
<li class="chapter" data-level="13.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#éléments-dun-document-r-markdown"><i class="fa fa-check"></i><b>13.2</b> Éléments d’un document R Markdown</a><ul>
<li class="chapter" data-level="13.2.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#en-tête-préambule"><i class="fa fa-check"></i><b>13.2.1</b> En-tête (préambule)</a></li>
<li class="chapter" data-level="13.2.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#texte-du-document"><i class="fa fa-check"></i><b>13.2.2</b> Texte du document</a></li>
<li class="chapter" data-level="13.2.3" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#blocs-de-code-r"><i class="fa fa-check"></i><b>13.2.3</b> Blocs de code R</a></li>
<li class="chapter" data-level="13.2.4" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#compiler-un-document-knit"><i class="fa fa-check"></i><b>13.2.4</b> Compiler un document (<em>Knit</em>)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#personnaliser-le-document-généré"><i class="fa fa-check"></i><b>13.3</b> Personnaliser le document généré</a></li>
<li class="chapter" data-level="13.4" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#options-des-blocs-de-code-r"><i class="fa fa-check"></i><b>13.4</b> Options des blocs de code R</a><ul>
<li class="chapter" data-level="13.4.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#nom-du-bloc"><i class="fa fa-check"></i><b>13.4.1</b> Nom du bloc</a></li>
<li class="chapter" data-level="13.4.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#options"><i class="fa fa-check"></i><b>13.4.2</b> Options</a></li>
<li class="chapter" data-level="13.4.3" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#modifier-les-options"><i class="fa fa-check"></i><b>13.4.3</b> Modifier les options</a></li>
<li class="chapter" data-level="13.4.4" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#options-globales"><i class="fa fa-check"></i><b>13.4.4</b> Options globales</a></li>
<li class="chapter" data-level="13.4.5" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#mise-en-cache-des-résultats"><i class="fa fa-check"></i><b>13.4.5</b> Mise en cache des résultats</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#rendu-des-tableaux"><i class="fa fa-check"></i><b>13.5</b> Rendu des tableaux</a><ul>
<li class="chapter" data-level="13.5.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#tableaux-croisés-1"><i class="fa fa-check"></i><b>13.5.1</b> Tableaux croisés</a></li>
<li class="chapter" data-level="13.5.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#tableaux-de-données-et-tris-à-plat"><i class="fa fa-check"></i><b>13.5.2</b> Tableaux de données et tris à plat</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#templates"><i class="fa fa-check"></i><b>13.6</b> Modèles de documents</a><ul>
<li class="chapter" data-level="13.6.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#slides"><i class="fa fa-check"></i><b>13.6.1</b> Slides</a></li>
<li class="chapter" data-level="13.6.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#templates-1"><i class="fa fa-check"></i><b>13.6.2</b> Templates</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#ressources-5"><i class="fa fa-check"></i><b>13.7</b> Ressources</a></li>
</ul></li>
<li class="part"><span><b>III Aller plus loin</b></span></li>
<li class="chapter" data-level="14" data-path="14-fonctions.html"><a href="14-fonctions.html"><i class="fa fa-check"></i><b>14</b> Écrire ses propres fonctions</a><ul>
<li class="chapter" data-level="14.1" data-path="14-fonctions.html"><a href="14-fonctions.html#introduction-et-exemples"><i class="fa fa-check"></i><b>14.1</b> Introduction et exemples</a><ul>
<li class="chapter" data-level="14.1.1" data-path="14-fonctions.html"><a href="14-fonctions.html#structure-dune-fonction"><i class="fa fa-check"></i><b>14.1.1</b> Structure d’une fonction</a></li>
<li class="chapter" data-level="14.1.2" data-path="14-fonctions.html"><a href="14-fonctions.html#exemples-de-fonctions"><i class="fa fa-check"></i><b>14.1.2</b> Exemples de fonctions</a></li>
<li class="chapter" data-level="14.1.3" data-path="14-fonctions.html"><a href="14-fonctions.html#effets-de-bord"><i class="fa fa-check"></i><b>14.1.3</b> Effets de bord</a></li>
<li class="chapter" data-level="14.1.4" data-path="14-fonctions.html"><a href="14-fonctions.html#utilité-des-fonctions"><i class="fa fa-check"></i><b>14.1.4</b> Utilité des fonctions</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="14-fonctions.html"><a href="14-fonctions.html#arguments-et-résultat-dune-fonction"><i class="fa fa-check"></i><b>14.2</b> Arguments et résultat d’une fonction</a><ul>
<li class="chapter" data-level="14.2.1" data-path="14-fonctions.html"><a href="14-fonctions.html#définition-des-arguments"><i class="fa fa-check"></i><b>14.2.1</b> Définition des arguments</a></li>
<li class="chapter" data-level="14.2.2" data-path="14-fonctions.html"><a href="14-fonctions.html#valeurs-par-défaut"><i class="fa fa-check"></i><b>14.2.2</b> Valeurs par défaut</a></li>
<li class="chapter" data-level="14.2.3" data-path="14-fonctions.html"><a href="14-fonctions.html#largument-..."><i class="fa fa-check"></i><b>14.2.3</b> L’argument <code>...</code></a></li>
<li class="chapter" data-level="14.2.4" data-path="14-fonctions.html"><a href="14-fonctions.html#resfunc"><i class="fa fa-check"></i><b>14.2.4</b> Résultat d’une fonction</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14-fonctions.html"><a href="14-fonctions.html#portée-des-variables"><i class="fa fa-check"></i><b>14.3</b> Portée des variables</a><ul>
<li class="chapter" data-level="14.3.1" data-path="14-fonctions.html"><a href="14-fonctions.html#une-fonction-peut-accéder-à-un-objet-extérieur"><i class="fa fa-check"></i><b>14.3.1</b> Une fonction peut accéder à un objet extérieur</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="14-fonctions.html"><a href="14-fonctions.html#les-fonctions-comme-objets"><i class="fa fa-check"></i><b>14.4</b> Les fonctions comme objets</a><ul>
<li class="chapter" data-level="14.4.1" data-path="14-fonctions.html"><a href="14-fonctions.html#passer-des-fonctions-comme-argument"><i class="fa fa-check"></i><b>14.4.1</b> Passer des fonctions comme argument</a></li>
<li class="chapter" data-level="14.4.2" data-path="14-fonctions.html"><a href="14-fonctions.html#fonctions-anonymes"><i class="fa fa-check"></i><b>14.4.2</b> Fonctions anonymes</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="14-fonctions.html"><a href="14-fonctions.html#ressources-6"><i class="fa fa-check"></i><b>14.5</b> Ressources</a></li>
<li class="chapter" data-level="14.6" data-path="14-fonctions.html"><a href="14-fonctions.html#exercices-7"><i class="fa fa-check"></i><b>14.6</b> Exercices</a><ul>
<li class="chapter" data-level="14.6.1" data-path="14-fonctions.html"><a href="14-fonctions.html#introduction-et-exemples-1"><i class="fa fa-check"></i><b>14.6.1</b> Introduction et exemples</a></li>
<li class="chapter" data-level="14.6.2" data-path="14-fonctions.html"><a href="14-fonctions.html#arguments-et-résultats"><i class="fa fa-check"></i><b>14.6.2</b> Arguments et résultats</a></li>
<li class="chapter" data-level="14.6.3" data-path="14-fonctions.html"><a href="14-fonctions.html#portée-des-variables-1"><i class="fa fa-check"></i><b>14.6.3</b> Portée des variables</a></li>
<li class="chapter" data-level="14.6.4" data-path="14-fonctions.html"><a href="14-fonctions.html#les-fonctions-comme-objets-1"><i class="fa fa-check"></i><b>14.6.4</b> Les fonctions comme objets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-programmer.html"><a href="15-programmer.html"><i class="fa fa-check"></i><b>15</b> Programmer avec R</a><ul>
<li class="chapter" data-level="15.1" data-path="15-programmer.html"><a href="15-programmer.html#structures-de-données"><i class="fa fa-check"></i><b>15.1</b> Structures de données</a><ul>
<li class="chapter" data-level="15.1.1" data-path="15-programmer.html"><a href="15-programmer.html#vecteurs-atomiques"><i class="fa fa-check"></i><b>15.1.1</b> Vecteurs atomiques</a></li>
<li class="chapter" data-level="15.1.2" data-path="15-programmer.html"><a href="15-programmer.html#listes"><i class="fa fa-check"></i><b>15.1.2</b> Listes</a></li>
<li class="chapter" data-level="15.1.3" data-path="15-programmer.html"><a href="15-programmer.html#data-frame-tibbles"><i class="fa fa-check"></i><b>15.1.3</b> Tableaux de données (<em>data frame</em> et <em>tibble</em>)</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="15-programmer.html"><a href="15-programmer.html#if-else-exécuter-du-code-sous-certaines-conditions"><i class="fa fa-check"></i><b>15.2</b> <code>if</code>, <code>else</code> : exécuter du code sous certaines conditions</a><ul>
<li class="chapter" data-level="15.2.1" data-path="15-programmer.html"><a href="15-programmer.html#if"><i class="fa fa-check"></i><b>15.2.1</b> <code>if</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="15-programmer.html"><a href="15-programmer.html#if-else-1"><i class="fa fa-check"></i><b>15.2.2</b> <code>if</code> / <code>else</code></a></li>
<li class="chapter" data-level="15.2.3" data-path="15-programmer.html"><a href="15-programmer.html#if-else-if-else"><i class="fa fa-check"></i><b>15.2.3</b> “<code>if</code>” / “<code>else if</code>” / “<code>else</code>”</a></li>
<li class="chapter" data-level="15.2.4" data-path="15-programmer.html"><a href="15-programmer.html#construction-de-conditions-complexes"><i class="fa fa-check"></i><b>15.2.4</b> Construction de conditions complexes</a></li>
<li class="chapter" data-level="15.2.5" data-path="15-programmer.html"><a href="15-programmer.html#différence-entre-if-else-et-ifelse"><i class="fa fa-check"></i><b>15.2.5</b> Différence entre <code>if</code> / <code>else</code> et <code>ifelse</code></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="15-programmer.html"><a href="15-programmer.html#contrôle-de-lexécution-et-gestion-des-erreurs"><i class="fa fa-check"></i><b>15.3</b> Contrôle de l’exécution et gestion des erreurs</a><ul>
<li class="chapter" data-level="15.3.1" data-path="15-programmer.html"><a href="15-programmer.html#utilisation-de-return-pour-sortir-de-la-fonction"><i class="fa fa-check"></i><b>15.3.1</b> Utilisation de <code>return</code> pour sortir de la fonction</a></li>
<li class="chapter" data-level="15.3.2" data-path="15-programmer.html"><a href="15-programmer.html#warning"><i class="fa fa-check"></i><b>15.3.2</b> <code>warning</code></a></li>
<li class="chapter" data-level="15.3.3" data-path="15-programmer.html"><a href="15-programmer.html#stop-et-stopifnot"><i class="fa fa-check"></i><b>15.3.3</b> <code>stop</code> et <code>stopifnot</code></a></li>
<li class="chapter" data-level="15.3.4" data-path="15-programmer.html"><a href="15-programmer.html#tester-la-présence-dun-argument"><i class="fa fa-check"></i><b>15.3.4</b> Tester la présence d’un argument</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="15-programmer.html"><a href="15-programmer.html#for-et-while-répéter-des-instructions-dans-une-boucle"><i class="fa fa-check"></i><b>15.4</b> <code>for</code> et <code>while</code> : répéter des instructions dans une boucle</a><ul>
<li class="chapter" data-level="15.4.1" data-path="15-programmer.html"><a href="15-programmer.html#for"><i class="fa fa-check"></i><b>15.4.1</b> <code>for</code></a></li>
<li class="chapter" data-level="15.4.2" data-path="15-programmer.html"><a href="15-programmer.html#while"><i class="fa fa-check"></i><b>15.4.2</b> <code>while</code></a></li>
<li class="chapter" data-level="15.4.3" data-path="15-programmer.html"><a href="15-programmer.html#break-et-next"><i class="fa fa-check"></i><b>15.4.3</b> <code>break</code> et <code>next</code></a></li>
<li class="chapter" data-level="15.4.4" data-path="15-programmer.html"><a href="15-programmer.html#no-boucles"><i class="fa fa-check"></i><b>15.4.4</b> Quand (ne pas) utiliser des boucles</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="15-programmer.html"><a href="15-programmer.html#ressources-7"><i class="fa fa-check"></i><b>15.5</b> Ressources</a></li>
<li class="chapter" data-level="15.6" data-path="15-programmer.html"><a href="15-programmer.html#exercices-8"><i class="fa fa-check"></i><b>15.6</b> Exercices</a><ul>
<li class="chapter" data-level="15.6.1" data-path="15-programmer.html"><a href="15-programmer.html#vecteurs-atomiques-1"><i class="fa fa-check"></i><b>15.6.1</b> Vecteurs atomiques</a></li>
<li class="chapter" data-level="15.6.2" data-path="15-programmer.html"><a href="15-programmer.html#listes-1"><i class="fa fa-check"></i><b>15.6.2</b> Listes</a></li>
<li class="chapter" data-level="15.6.3" data-path="15-programmer.html"><a href="15-programmer.html#data-frame-et-tibble"><i class="fa fa-check"></i><b>15.6.3</b> <em>data frame</em> et <em>tibble</em></a></li>
<li class="chapter" data-level="15.6.4" data-path="15-programmer.html"><a href="15-programmer.html#if-et-else"><i class="fa fa-check"></i><b>15.6.4</b> <code>if</code> et <code>else</code></a></li>
<li class="chapter" data-level="15.6.5" data-path="15-programmer.html"><a href="15-programmer.html#contrôle-de-lexécution"><i class="fa fa-check"></i><b>15.6.5</b> Contrôle de l’exécution</a></li>
<li class="chapter" data-level="15.6.6" data-path="15-programmer.html"><a href="15-programmer.html#boucles"><i class="fa fa-check"></i><b>15.6.6</b> Boucles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html"><i class="fa fa-check"></i><b>16</b> <code>dplyr</code> avancé</a><ul>
<li class="chapter" data-level="16.1" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#appliquer-ses-propres-fonctions"><i class="fa fa-check"></i><b>16.1</b> Appliquer ses propres fonctions</a><ul>
<li class="chapter" data-level="16.1.1" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#exemple-avec-un-mutate"><i class="fa fa-check"></i><b>16.1.1</b> Exemple avec un <code>mutate</code></a></li>
<li class="chapter" data-level="16.1.2" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#exemple-avec-un-summarise"><i class="fa fa-check"></i><b>16.1.2</b> Exemple avec un <code>summarise</code></a></li>
<li class="chapter" data-level="16.1.3" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#exemple-avec-un-rename_with"><i class="fa fa-check"></i><b>16.1.3</b> Exemple avec un <code>rename_with</code></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#across"><i class="fa fa-check"></i><b>16.2</b> <code>across()</code> : appliquer des fonctions à plusieurs colonnes</a><ul>
<li class="chapter" data-level="16.2.1" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#appliquer-une-fonction-à-plusieurs-colonnes"><i class="fa fa-check"></i><b>16.2.1</b> Appliquer une fonction à plusieurs colonnes</a></li>
<li class="chapter" data-level="16.2.2" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#appliquer-plusieurs-fonctions-à-plusieurs-colonnes"><i class="fa fa-check"></i><b>16.2.2</b> Appliquer plusieurs fonctions à plusieurs colonnes</a></li>
<li class="chapter" data-level="16.2.3" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#renommer-plusieurs-colonnes-avec-une-fonctions"><i class="fa fa-check"></i><b>16.2.3</b> Renommer plusieurs colonnes avec une fonctions</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#rowwise-et-c_across-appliquer-une-transformation-ligne-par-ligne"><i class="fa fa-check"></i><b>16.3</b> <code>rowwise()</code> et <code>c_across()</code> : appliquer une transformation ligne par ligne</a></li>
<li class="chapter" data-level="16.4" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#syntaxes-abregees"><i class="fa fa-check"></i><b>16.4</b> Fonctions anonymes et syntaxes abrégées</a></li>
<li class="chapter" data-level="16.5" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#ressources-8"><i class="fa fa-check"></i><b>16.5</b> Ressources</a></li>
<li class="chapter" data-level="16.6" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#exercices-9"><i class="fa fa-check"></i><b>16.6</b> Exercices</a><ul>
<li class="chapter" data-level="16.6.1" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#appliquer-ses-propres-fonctions-1"><i class="fa fa-check"></i><b>16.6.1</b> Appliquer ses propres fonctions</a></li>
<li class="chapter" data-level="16.6.2" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#across-1"><i class="fa fa-check"></i><b>16.6.2</b> <code>across()</code></a></li>
<li class="chapter" data-level="16.6.3" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#rowwise-et-c_across"><i class="fa fa-check"></i><b>16.6.3</b> <code>rowwise()</code> et <code>c_across()</code></a></li>
<li class="chapter" data-level="16.6.4" data-path="16-dplyr-avance.html"><a href="16-dplyr-avance.html#fonctions-anonymes-et-notations-abrégées"><i class="fa fa-check"></i><b>16.6.4</b> Fonctions anonymes et notations abrégées</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-purrr.html"><a href="17-purrr.html"><i class="fa fa-check"></i><b>17</b> Itérer avec <code>purrr</code></a><ul>
<li class="chapter" data-level="17.1" data-path="17-purrr.html"><a href="17-purrr.html#exemple-dapplication"><i class="fa fa-check"></i><b>17.1</b> Exemple d’application</a></li>
<li class="chapter" data-level="17.2" data-path="17-purrr.html"><a href="17-purrr.html#map-et-ses-variantes"><i class="fa fa-check"></i><b>17.2</b> <code>map</code> et ses variantes</a><ul>
<li class="chapter" data-level="17.2.1" data-path="17-purrr.html"><a href="17-purrr.html#modes-dappel-de-map"><i class="fa fa-check"></i><b>17.2.1</b> Modes d’appel de <code>map</code></a></li>
<li class="chapter" data-level="17.2.2" data-path="17-purrr.html"><a href="17-purrr.html#variantes-de-map"><i class="fa fa-check"></i><b>17.2.2</b> Variantes de <code>map</code></a></li>
<li class="chapter" data-level="17.2.3" data-path="17-purrr.html"><a href="17-purrr.html#map_dfr-et-map_dfc"><i class="fa fa-check"></i><b>17.2.3</b> <code>map_dfr()</code> et <code>map_dfc()</code></a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="17-purrr.html"><a href="17-purrr.html#itérer-sur-les-colonnes-dun-tableau-de-données"><i class="fa fa-check"></i><b>17.3</b> Itérer sur les colonnes d’un tableau de données</a></li>
<li class="chapter" data-level="17.4" data-path="17-purrr.html"><a href="17-purrr.html#modify"><i class="fa fa-check"></i><b>17.4</b> <code>modify</code></a></li>
<li class="chapter" data-level="17.5" data-path="17-purrr.html"><a href="17-purrr.html#imap"><i class="fa fa-check"></i><b>17.5</b> <code>imap</code></a></li>
<li class="chapter" data-level="17.6" data-path="17-purrr.html"><a href="17-purrr.html#walk"><i class="fa fa-check"></i><b>17.6</b> <code>walk</code></a></li>
<li class="chapter" data-level="17.7" data-path="17-purrr.html"><a href="17-purrr.html#map2-et-pmap-itérer-sur-plusieurs-vecteurs-en-parallèle"><i class="fa fa-check"></i><b>17.7</b> <code>map2</code> et <code>pmap</code> : itérer sur plusieurs vecteurs en parallèle</a></li>
<li class="chapter" data-level="17.8" data-path="17-purrr.html"><a href="17-purrr.html#répéter-une-opération"><i class="fa fa-check"></i><b>17.8</b> Répéter une opération</a></li>
<li class="chapter" data-level="17.9" data-path="17-purrr.html"><a href="17-purrr.html#quand-ne-pas-utiliser-map"><i class="fa fa-check"></i><b>17.9</b> Quand ne pas utiliser <code>map</code></a></li>
<li class="chapter" data-level="17.10" data-path="17-purrr.html"><a href="17-purrr.html#purrr-vs-apply"><i class="fa fa-check"></i><b>17.10</b> <code>purrr</code> vs *apply</a></li>
<li class="chapter" data-level="17.11" data-path="17-purrr.html"><a href="17-purrr.html#ressources-9"><i class="fa fa-check"></i><b>17.11</b> Ressources</a></li>
<li class="chapter" data-level="17.12" data-path="17-purrr.html"><a href="17-purrr.html#exercices-10"><i class="fa fa-check"></i><b>17.12</b> Exercices</a><ul>
<li class="chapter" data-level="17.12.1" data-path="17-purrr.html"><a href="17-purrr.html#map-et-ses-variantes-1"><i class="fa fa-check"></i><b>17.12.1</b> <code>map</code> et ses variantes</a></li>
<li class="chapter" data-level="17.12.2" data-path="17-purrr.html"><a href="17-purrr.html#modify-et-itération-sur-les-colonnes-dun-tableau"><i class="fa fa-check"></i><b>17.12.2</b> <code>modify</code> et itération sur les colonnes d’un tableau</a></li>
<li class="chapter" data-level="17.12.3" data-path="17-purrr.html"><a href="17-purrr.html#imap-et-walk"><i class="fa fa-check"></i><b>17.12.3</b> <code>imap</code> et <code>walk</code></a></li>
<li class="chapter" data-level="17.12.4" data-path="17-purrr.html"><a href="17-purrr.html#map2-et-pmap"><i class="fa fa-check"></i><b>17.12.4</b> <code>map2</code> et <code>pmap</code></a></li>
<li class="chapter" data-level="17.12.5" data-path="17-purrr.html"><a href="17-purrr.html#répéter-une-opération-1"><i class="fa fa-check"></i><b>17.12.5</b> Répéter une opération</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="18-programmer-tidyverse.html"><a href="18-programmer-tidyverse.html"><i class="fa fa-check"></i><b>18</b> Programmer avec le <em>tidyverse</em></a></li>
<li class="chapter" data-level="19" data-path="19-targets.html"><a href="19-targets.html"><i class="fa fa-check"></i><b>19</b> Organiser ses traitements avec <code>targets</code></a><ul>
<li class="chapter" data-level="19.1" data-path="19-targets.html"><a href="19-targets.html#ressources-10"><i class="fa fa-check"></i><b>19.1</b> Ressources</a></li>
</ul></li>
<li class="appendix"><span><b>Annexes</b></span></li>
<li class="chapter" data-level="A" data-path="20-ressources.html"><a href="20-ressources.html"><i class="fa fa-check"></i><b>A</b> Ressources</a><ul>
<li class="chapter" data-level="A.1" data-path="20-ressources.html"><a href="20-ressources.html#aide"><i class="fa fa-check"></i><b>A.1</b> Aide</a><ul>
<li class="chapter" data-level="A.1.1" data-path="20-ressources.html"><a href="20-ressources.html#aide-de-r-et-rstudio"><i class="fa fa-check"></i><b>A.1.1</b> Aide de R et RStudio</a></li>
<li class="chapter" data-level="A.1.2" data-path="20-ressources.html"><a href="20-ressources.html#aide-en-ligne"><i class="fa fa-check"></i><b>A.1.2</b> Aide en ligne</a></li>
<li class="chapter" data-level="A.1.3" data-path="20-ressources.html"><a href="20-ressources.html#antisèches"><i class="fa fa-check"></i><b>A.1.3</b> Antisèches</a></li>
<li class="chapter" data-level="A.1.4" data-path="20-ressources.html"><a href="20-ressources.html#où-poser-des-questions"><i class="fa fa-check"></i><b>A.1.4</b> Où poser des questions</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="20-ressources.html"><a href="20-ressources.html#ouvrages-blogs-moocs"><i class="fa fa-check"></i><b>A.2</b> Ouvrages, blogs, MOOCs…</a><ul>
<li class="chapter" data-level="A.2.1" data-path="20-ressources.html"><a href="20-ressources.html#francophones"><i class="fa fa-check"></i><b>A.2.1</b> Francophones</a></li>
<li class="chapter" data-level="A.2.2" data-path="20-ressources.html"><a href="20-ressources.html#anglophones"><i class="fa fa-check"></i><b>A.2.2</b> Anglophones</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="20-ressources.html"><a href="20-ressources.html#extensions-1"><i class="fa fa-check"></i><b>A.3</b> Extensions</a><ul>
<li class="chapter" data-level="A.3.1" data-path="20-ressources.html"><a href="20-ressources.html#où-trouver-des-extensions-intéressantes"><i class="fa fa-check"></i><b>A.3.1</b> Où trouver des extensions intéressantes ?</a></li>
<li class="chapter" data-level="A.3.2" data-path="20-ressources.html"><a href="20-ressources.html#lextension-questionr"><i class="fa fa-check"></i><b>A.3.2</b> L’extension <code>questionr</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction à R et au tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programmer-avec-r" class="section level1">
<h1><span class="header-section-number">Partie 15</span> Programmer avec R</h1>
<p>Nous avons vu dans la partie précédente comment écrire nos propres fonctions. Pour pouvoir aller plus loin nous allons rappeler ou aborder ici des types de données et des éléments du langage qui permettent de programmer des actions un peu plus complexes.</p>
<p>Les notions décrites dans cette partie s’appliquent pour le développement de fonctions, mais peuvent aussi être mises en oeuvre à tout moment dans un script.</p>
<p>On commence par charger les jeux de données d’exemple utilisés par la suite :</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb697-1" title="1"><span class="kw">library</span>(questionr)</a>
<a class="sourceLine" id="cb697-2" title="2"><span class="kw">data</span>(hdv2003)</a>
<a class="sourceLine" id="cb697-3" title="3"><span class="kw">data</span>(rp2012)</a></code></pre></div>
<div id="structures-de-données" class="section level2">
<h2><span class="header-section-number">15.1</span> Structures de données</h2>
<p>R propose de nombreuses structures de données différentes, et les extensions peuvent en implémenter de nouvelles. Cette section présente trois structures parmi les plus utilisées : les <strong>vecteurs atomiques</strong>, les <strong>listes</strong> et les <strong>tableaux de données</strong>.</p>
<div id="vecteurs-atomiques" class="section level3">
<h3><span class="header-section-number">15.1.1</span> Vecteurs atomiques</h3>
<p>Les vecteurs atomiques sont des structures qui regroupent plusieurs éléments, avec une contrainte : ces éléments doivent tous être du même type, et ils ne peuvent pas contenir d’objets complexes. Les vecteurs atomiques ont déjà été introduits section <a href="09-recodages.html#vecteurs">9.1</a>.</p>
<div id="création-dun-vecteur" class="section level4">
<h4><span class="header-section-number">15.1.1.1</span> Création d’un vecteur</h4>
<p>On peut construire un vecteur manuellement avec la fonction <code>c()</code>.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb698-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>)</a></code></pre></div>
<p>Si on souhaite générer un vecteur de valeurs entières successives, on peut utiliser l’opérateur <code>:</code> ou la fonction <code>seq_len()</code>.</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" title="1"><span class="dv">2</span><span class="op">:</span><span class="dv">8</span></a>
<a class="sourceLine" id="cb699-2" title="2"><span class="co">#&gt; [1] 2 3 4 5 6 7 8</span></a>
<a class="sourceLine" id="cb699-3" title="3"><span class="kw">seq_len</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb699-4" title="4"><span class="co">#&gt; [1] 1 2 3 4 5</span></a></code></pre></div>
<p>La fonction <code>seq()</code> permet de générer des séquences régulière plus complexes.</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb700-1" title="1"><span class="kw">seq</span>(<span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="dt">by =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb700-2" title="2"><span class="co">#&gt; [1] 0.5 1.0 1.5 2.0 2.5</span></a>
<a class="sourceLine" id="cb700-3" title="3"><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">length.out =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb700-4" title="4"><span class="co">#&gt; [1] 0.0 0.8 1.6 2.4 3.2 4.0</span></a></code></pre></div>
<p>Enfin, la fonction <code>rep()</code> permet de répéter un élément ou un vecteur.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1"><span class="kw">rep</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb701-2" title="2"><span class="co">#&gt; [1] &quot;Pomme&quot; &quot;Pomme&quot; &quot;Pomme&quot; &quot;Pomme&quot; &quot;Pomme&quot; &quot;Pomme&quot;</span></a>
<a class="sourceLine" id="cb701-3" title="3"><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb701-4" title="4"><span class="co">#&gt; [1] 1 2 3 4 1 2 3 4</span></a></code></pre></div>
<p>Il peut parfois être utile de créer des vecteurs “vides”. Dans ce cas on peut les initialiser avec les fonctions <code>vector()</code>, <code>character()</code> ou <code>numeric()</code>. Par défaut ces fonctions renvoient un vecteur vide, sans éléments, mais on peut aussi leur indiquer en argument le nombre d’éléments souhaités.</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb702-1" title="1"><span class="kw">numeric</span>()</a>
<a class="sourceLine" id="cb702-2" title="2"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb702-3" title="3"><span class="kw">character</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb702-4" title="4"><span class="co">#&gt; [1] &quot;&quot; &quot;&quot;</span></a></code></pre></div>
</div>
<div id="vecteurs-nommés" class="section level4">
<h4><span class="header-section-number">15.1.1.2</span> Vecteurs nommés</h4>
<p>Les éléments d’un vecteur peuvent être nommés. Ceci peut se faire au moment de la création du vecteur.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">e1 =</span> <span class="dv">1</span>, <span class="dt">e2 =</span> <span class="dv">3</span>, <span class="dt">e3 =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb703-2" title="2">x</a>
<a class="sourceLine" id="cb703-3" title="3"><span class="co">#&gt; e1 e2 e3 </span></a>
<a class="sourceLine" id="cb703-4" title="4"><span class="co">#&gt;  1  3  8</span></a></code></pre></div>
<p>On peut utiliser <code>names()</code> pour récupérer les noms des éléments d’un vecteur.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb704-1" title="1"><span class="kw">names</span>(x)</a>
<a class="sourceLine" id="cb704-2" title="2"><span class="co">#&gt; [1] &quot;e1&quot; &quot;e2&quot; &quot;e3&quot;</span></a></code></pre></div>
<p>On peut aussi utiliser <code>names()</code> pour créer ou modifier les noms d’un vecteur existant.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" title="1"><span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;brouette&quot;</span>, <span class="st">&quot;moto&quot;</span>, <span class="st">&quot;igloo&quot;</span>)</a>
<a class="sourceLine" id="cb705-2" title="2">x</a>
<a class="sourceLine" id="cb705-3" title="3"><span class="co">#&gt; brouette     moto    igloo </span></a>
<a class="sourceLine" id="cb705-4" title="4"><span class="co">#&gt;        1        3        8</span></a></code></pre></div>
</div>
<div id="types-de-vecteurs" class="section level4">
<h4><span class="header-section-number">15.1.1.3</span> Types de vecteurs</h4>
<p>On peut déterminer le type d’un vecteur avec l’instruction <code>typeof</code>.</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb706-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb706-2" title="2"><span class="kw">typeof</span>(x)</a>
<a class="sourceLine" id="cb706-3" title="3"><span class="co">#&gt; [1] &quot;double&quot;</span></a>
<a class="sourceLine" id="cb706-4" title="4">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>)</a>
<a class="sourceLine" id="cb706-5" title="5"><span class="kw">typeof</span>(y)</a>
<a class="sourceLine" id="cb706-6" title="6"><span class="co">#&gt; [1] &quot;character&quot;</span></a>
<a class="sourceLine" id="cb706-7" title="7">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb706-8" title="8"><span class="kw">typeof</span>(z)</a>
<a class="sourceLine" id="cb706-9" title="9"><span class="co">#&gt; [1] &quot;logical&quot;</span></a></code></pre></div>
<p>Parmi les principaux types de données on notera<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a> :</p>
<ul>
<li>les chaînes de caractères (<code>character</code>)</li>
<li>les nombres flottants (<code>double</code>)</li>
<li>les nombres entiers (<code>integer</code>)</li>
<li>les valeurs logiques (<code>logical</code>)</li>
</ul>
<p>À noter que par défaut les nombres sont considérés comme des nombres flottants (des nombres décimaux avec une virgule) : pour les définir explicitement comme nombres entiers on peut leur ajouter le suffixe <code>L</code>.</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 3L, 8L)</a>
<a class="sourceLine" id="cb707-2" title="2"><span class="kw">typeof</span>(x)</a>
<a class="sourceLine" id="cb707-3" title="3"><span class="co">#&gt; [1] &quot;integer&quot;</span></a></code></pre></div>
<p>On peut tester le type d’un vecteur avec les fonctions <code>is.character</code>, <code>is.double</code>, <code>is.logical</code>… Autre fonction utile, <code>is.numeric</code> teste si un vecteur est de type <code>double</code> ou <code>integer</code>.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb708-1" title="1"><span class="kw">is.character</span>(<span class="st">&quot;Chihuahua&quot;</span>)</a>
<a class="sourceLine" id="cb708-2" title="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb708-3" title="3"><span class="kw">is.logical</span>(<span class="dv">3</span> <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb708-4" title="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb708-5" title="5"><span class="kw">is.numeric</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb708-6" title="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Petite spécificité, les facteurs (voir section <a href="09-recodages.html#facteurs">9.3.1</a>) ne sont pas considérés par R comme des <code>character</code>, même s’ils comportent des chaînes de caractères. Pour tester si un vecteur est de type facteur, on utilise <code>is.factor()</code>.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" title="1">fac &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;rouge&quot;</span>, <span class="st">&quot;vert&quot;</span>, <span class="st">&quot;rouge&quot;</span>))</a>
<a class="sourceLine" id="cb709-2" title="2"><span class="kw">is.character</span>(fac)</a>
<a class="sourceLine" id="cb709-3" title="3"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb709-4" title="4"><span class="kw">is.factor</span>(fac)</a>
<a class="sourceLine" id="cb709-5" title="5"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Tous les éléments d’un vecteur doivent être du même type. Si ça n’est pas le cas, les éléments seront convertis au type le plus “général”, sachant que les <code>character</code> sont plus généraux que les <code>numeric</code>, qui sont eux-mêmes plus généraux que les <code>logical</code>.</p>
<p>Dans l’exemple suivant, le nombre <code>1</code> est transformé en chaîne de caractère <code>"1"</code>.</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb710-1" title="1"><span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;foo&quot;</span>)</a>
<a class="sourceLine" id="cb710-2" title="2"><span class="co">#&gt; [1] &quot;1&quot;   &quot;foo&quot;</span></a></code></pre></div>
<p>Si on mélange nombres et valeurs logiques, les <code>TRUE</code> sont convertis en <code>1</code> et les <code>FALSE</code> en <code>0</code>.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" title="1"><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="dv">2</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb711-2" title="2"><span class="co">#&gt; [1] 1 2 0</span></a></code></pre></div>
<div class="rmdnote">
<p>
Si la valeur <code>NA</code>, comme on l’a vu, permet d’indiquer une valeur manquante (<code>Not Available</code>), il existe en réalité plusieurs types de <code>NA</code>, même si cette distinction est la plupart du temps transparente pour l’utilisateur. On a ainsi notamment des valeur <code>NA_integer_</code>, <code>NA_character_</code>, <code>NA_real_</code>.
</p>
</div>
<p>La conversion automatique d’un type en un autre est à l’origine d’un idiome courant en R. Quand on applique une fonction qui attend un vecteur de nombres à un vecteur de valeurs logiques, celles-ci sont automatiquement converties, les <code>TRUE</code> devenant 1 et les <code>FALSE</code> devenant 0. Du coup, si on applique <code>sum()</code> à un vecteur de valeurs logiques, le résultat est égal au nombre de valeurs <code>TRUE</code>.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb712-1" title="1"><span class="kw">sum</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb712-2" title="2"><span class="co">#&gt; [1] 3</span></a></code></pre></div>
<p>On peut donc aussi appliquer <code>sum()</code> à un test, et on obtiendra le nombre de valeurs pour lesquelles le test est vrai.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb713-2" title="2"><span class="kw">sum</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb713-3" title="3"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>Ceci fournit un raccourci très pratique. Dans l’exemple suivant, on tire 1000 nombres au hasard entre 0 et 1 et on regarde le nombre de valeurs obtenues inférieures à 0,5.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb714-1" title="1">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb714-2" title="2"><span class="kw">sum</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb714-3" title="3"><span class="co">#&gt; [1] 494</span></a></code></pre></div>
<p>Autre raccourci moins utilisé, appliquer <code>mean()</code> au résultat d’un test donne la proportion de valeurs pour lesquelles le test est vrai.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb715-2" title="2"><span class="kw">mean</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb715-3" title="3"><span class="co">#&gt; [1] 0.4</span></a>
<a class="sourceLine" id="cb715-4" title="4">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb715-5" title="5"><span class="kw">mean</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb715-6" title="6"><span class="co">#&gt; [1] 0.493</span></a></code></pre></div>
</div>
<div id="sélection-déléments" class="section level4">
<h4><span class="header-section-number">15.1.1.4</span> Sélection d’éléments</h4>
<p>On a vu section <a href="09-recodages.html#vecteurs">9.1</a> que l’opérateur <code>[]</code> peut être utilisé pour sélectionner ou modifier des éléments d’un vecteur. Cet opérateur peut comporter :</p>
<ul>
<li>des nombres (qui sélectionnent par position)</li>
<li>des chaînes de caractères (qui sélectionnent par nom)</li>
<li>un test ou des valeurs logiques (qui sélectionnent les éléments correspondant à <code>TRUE</code>)</li>
</ul>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb716-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">e1 =</span> <span class="dv">1</span>, <span class="dt">e2 =</span> <span class="dv">2</span>, <span class="dt">e3 =</span> <span class="dv">8</span>, <span class="dt">e4 =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb716-2" title="2">x[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb716-3" title="3"><span class="co">#&gt; e1 e4 </span></a>
<a class="sourceLine" id="cb716-4" title="4"><span class="co">#&gt;  1 12</span></a>
<a class="sourceLine" id="cb716-5" title="5">x[<span class="kw">c</span>(<span class="st">&quot;e2&quot;</span>, <span class="st">&quot;e4&quot;</span>)]</a>
<a class="sourceLine" id="cb716-6" title="6"><span class="co">#&gt; e2 e4 </span></a>
<a class="sourceLine" id="cb716-7" title="7"><span class="co">#&gt;  2 12</span></a>
<a class="sourceLine" id="cb716-8" title="8">x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb716-9" title="9"><span class="co">#&gt; e1 e2 e3 </span></a>
<a class="sourceLine" id="cb716-10" title="10"><span class="co">#&gt;  1  2  8</span></a></code></pre></div>
<p>Si on fournit à <code>[]</code> un ou plusieurs nombres négatifs, les valeurs correspondantes seront supprimées plutôt que sélectionnées.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" title="1">x[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb717-2" title="2"><span class="co">#&gt; e2 e3 e4 </span></a>
<a class="sourceLine" id="cb717-3" title="3"><span class="co">#&gt;  2  8 12</span></a>
<a class="sourceLine" id="cb717-4" title="4">x[<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">-4</span>)]</a>
<a class="sourceLine" id="cb717-5" title="5"><span class="co">#&gt; e1 e3 </span></a>
<a class="sourceLine" id="cb717-6" title="6"><span class="co">#&gt;  1  8</span></a></code></pre></div>
<p>Si on souhaite afficher les premières ou dernières valeurs d’un vecteur, les fonctions <code>head()</code> et <code>tail()</code> peuvent être utiles.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb718-1" title="1"><span class="kw">head</span>(x, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb718-2" title="2"><span class="co">#&gt; e1 e2 </span></a>
<a class="sourceLine" id="cb718-3" title="3"><span class="co">#&gt;  1  2</span></a>
<a class="sourceLine" id="cb718-4" title="4"><span class="kw">tail</span>(x, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb718-5" title="5"><span class="co">#&gt; e4 </span></a>
<a class="sourceLine" id="cb718-6" title="6"><span class="co">#&gt; 12</span></a></code></pre></div>
</div>
<div id="modification" class="section level4">
<h4><span class="header-section-number">15.1.1.5</span> Modification</h4>
<p>Utilisé conjointement avec l’opérateur d’assignation <code>&lt;-</code>, l’opérateur <code>[]</code> permet de remplacer des éléments.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">e1 =</span> <span class="dv">1</span>, <span class="dt">e2 =</span> <span class="dv">2</span>, <span class="dt">e3 =</span> <span class="dv">8</span>, <span class="dt">e4 =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb719-2" title="2">x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">-1000</span></a>
<a class="sourceLine" id="cb719-3" title="3">x[<span class="st">&quot;e2&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb719-4" title="4">x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb719-5" title="5">x</a>
<a class="sourceLine" id="cb719-6" title="6"><span class="co">#&gt;    e1    e2    e3    e4 </span></a>
<a class="sourceLine" id="cb719-7" title="7"><span class="co">#&gt; -1000     0     8    NA</span></a></code></pre></div>
<p>Utilisé sans arguments, <code>[]</code> se contente de renvoyer le vecteur. Mais couplé à une assignation, il remplace chacun des éléments du vecteur plutôt que le vecteur lui-même.</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb720-1" title="1">x[] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb720-2" title="2">x</a>
<a class="sourceLine" id="cb720-3" title="3"><span class="co">#&gt; e1 e2 e3 e4 </span></a>
<a class="sourceLine" id="cb720-4" title="4"><span class="co">#&gt;  3  3  3  3</span></a></code></pre></div>
</div>
</div>
<div id="listes" class="section level3">
<h3><span class="header-section-number">15.1.2</span> Listes</h3>
<p>Les listes sont une généralisation des vecteurs : elles regroupent également plusieurs éléments, mais ceux-ci peuvent être de n’importe quel type, y compris des objets complexes. Une liste peut donc contenir elle-même des vecteurs, des listes, des tableaux de données, des fonctions, des graphiques <code>ggplot2</code> stockés dans un objet, etc.</p>
<div id="création" class="section level4">
<h4><span class="header-section-number">15.1.2.1</span> Création</h4>
<p>On construit une liste avec la fonction <code>list</code>.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1"><span class="kw">list</span>(<span class="dv">1</span>, <span class="st">&quot;foo&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb721-2" title="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb721-3" title="3"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb721-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb721-5" title="5"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb721-6" title="6"><span class="co">#&gt; [1] &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb721-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb721-8" title="8"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb721-9" title="9"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>La manière dont R affiche le contenu d’une liste dans la console diffère de celle des vecteurs. Dans le cas d’une liste ses éléments sont affichés les uns en dessous des autres, et séparés par leur indice numérique entre une paire de crochets.</p>
<p>Comme pour les vecteurs, on peut nommer les éléments à la création de la liste ou avec la fonction <code>names()</code>.</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb722-1" title="1"><span class="kw">list</span>(<span class="dt">nombre =</span> <span class="dv">1</span>, <span class="dt">char =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">vecteur =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb722-2" title="2"><span class="co">#&gt; $nombre</span></a>
<a class="sourceLine" id="cb722-3" title="3"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb722-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb722-5" title="5"><span class="co">#&gt; $char</span></a>
<a class="sourceLine" id="cb722-6" title="6"><span class="co">#&gt; [1] &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb722-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb722-8" title="8"><span class="co">#&gt; $vecteur</span></a>
<a class="sourceLine" id="cb722-9" title="9"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>Dans ce cas l’affichage de la liste dans la console montre ces noms plutôt que les indices numériques.</p>
<p>Si les noms comportent des caractères spéciaux comme des espaces, il faut les entourer de guillemets ou de quotes inverses.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1"><span class="kw">list</span>(<span class="st">&quot;Élément 1&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">Élément 2</span><span class="st">`</span> =<span class="st"> &quot;foo&quot;</span>)</a>
<a class="sourceLine" id="cb723-2" title="2"><span class="co">#&gt; $`Élément 1`</span></a>
<a class="sourceLine" id="cb723-3" title="3"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb723-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb723-5" title="5"><span class="co">#&gt; $`Élément 2`</span></a>
<a class="sourceLine" id="cb723-6" title="6"><span class="co">#&gt; [1] &quot;foo&quot;</span></a></code></pre></div>
<p>L’affichage des listes peut vite devenir illisible quand la liste est plus complexe<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a>.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb724-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb724-2" title="2">    <span class="dt">l2 =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>)),</a>
<a class="sourceLine" id="cb724-3" title="3">    <span class="dt">df =</span> <span class="kw">data.frame</span>(<span class="dt">v1 =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">v2 =</span> LETTERS[<span class="dv">2</span><span class="op">:</span><span class="dv">5</span>]),</a>
<a class="sourceLine" id="cb724-4" title="4">    <span class="dt">y =</span> <span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb724-5" title="5">)</a>
<a class="sourceLine" id="cb724-6" title="6">l</a>
<a class="sourceLine" id="cb724-7" title="7"><span class="co">#&gt; $l2</span></a>
<a class="sourceLine" id="cb724-8" title="8"><span class="co">#&gt; $l2$x</span></a>
<a class="sourceLine" id="cb724-9" title="9"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a>
<a class="sourceLine" id="cb724-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb724-11" title="11"><span class="co">#&gt; $l2$y</span></a>
<a class="sourceLine" id="cb724-12" title="12"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a>
<a class="sourceLine" id="cb724-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb724-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb724-15" title="15"><span class="co">#&gt; $df</span></a>
<a class="sourceLine" id="cb724-16" title="16"><span class="co">#&gt;   v1 v2</span></a>
<a class="sourceLine" id="cb724-17" title="17"><span class="co">#&gt; 1  2  B</span></a>
<a class="sourceLine" id="cb724-18" title="18"><span class="co">#&gt; 2  3  C</span></a>
<a class="sourceLine" id="cb724-19" title="19"><span class="co">#&gt; 3  4  D</span></a>
<a class="sourceLine" id="cb724-20" title="20"><span class="co">#&gt; 4  5  E</span></a>
<a class="sourceLine" id="cb724-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb724-22" title="22"><span class="co">#&gt; $y</span></a>
<a class="sourceLine" id="cb724-23" title="23"><span class="co">#&gt;  [1] 0.57274064 0.56530964 0.30606234 0.09129552 0.66332688 0.02656857</span></a>
<a class="sourceLine" id="cb724-24" title="24"><span class="co">#&gt;  [7] 0.72651089 0.70001916 0.74131429 0.48641652</span></a></code></pre></div>
<p>Dans ce cas la fonction <code>str</code> peut être utile pour afficher de manière plus compacte la structure de la liste.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" title="1"><span class="kw">str</span>(l)</a>
<a class="sourceLine" id="cb725-2" title="2"><span class="co">#&gt; List of 3</span></a>
<a class="sourceLine" id="cb725-3" title="3"><span class="co">#&gt;  $ l2:List of 2</span></a>
<a class="sourceLine" id="cb725-4" title="4"><span class="co">#&gt;   ..$ x: int [1:10] 1 2 3 4 5 6 7 8 9 10</span></a>
<a class="sourceLine" id="cb725-5" title="5"><span class="co">#&gt;   ..$ y: chr [1:2] &quot;Pomme&quot; &quot;Citron&quot;</span></a>
<a class="sourceLine" id="cb725-6" title="6"><span class="co">#&gt;  $ df:&#39;data.frame&#39;:  4 obs. of  2 variables:</span></a>
<a class="sourceLine" id="cb725-7" title="7"><span class="co">#&gt;   ..$ v1: int [1:4] 2 3 4 5</span></a>
<a class="sourceLine" id="cb725-8" title="8"><span class="co">#&gt;   ..$ v2: chr [1:4] &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot;</span></a>
<a class="sourceLine" id="cb725-9" title="9"><span class="co">#&gt;  $ y : num [1:10] 0.5727 0.5653 0.3061 0.0913 0.6633 ...</span></a></code></pre></div>
</div>
<div id="ajout-déléments" class="section level4">
<h4><span class="header-section-number">15.1.2.2</span> Ajout d’éléments</h4>
<p>Attention, si on souhaite ajouter un nouvel élément à une liste, il ne faut pas utiliser à nouveau <code>list()</code>, car dans ce cas notre liste de départ est vue comme une “sous-liste”.</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb726-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">e1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">e2 =</span> <span class="st">&quot;Chihuhua&quot;</span>)</a>
<a class="sourceLine" id="cb726-2" title="2">l2 &lt;-<span class="st"> </span><span class="kw">list</span>(l, <span class="dt">nouveau =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb726-3" title="3"><span class="kw">str</span>(l2)</a>
<a class="sourceLine" id="cb726-4" title="4"><span class="co">#&gt; List of 2</span></a>
<a class="sourceLine" id="cb726-5" title="5"><span class="co">#&gt;  $        :List of 2</span></a>
<a class="sourceLine" id="cb726-6" title="6"><span class="co">#&gt;   ..$ e1: int [1:3] 1 2 3</span></a>
<a class="sourceLine" id="cb726-7" title="7"><span class="co">#&gt;   ..$ e2: chr &quot;Chihuhua&quot;</span></a>
<a class="sourceLine" id="cb726-8" title="8"><span class="co">#&gt;  $ nouveau: num 100</span></a></code></pre></div>
<p>Il faut à la place utiliser <code>c()</code>, comme pour les vecteurs.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb727-1" title="1">l3 &lt;-<span class="st"> </span><span class="kw">c</span>(l, <span class="dt">nouveau =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb727-2" title="2"><span class="kw">str</span>(l3)</a>
<a class="sourceLine" id="cb727-3" title="3"><span class="co">#&gt; List of 3</span></a>
<a class="sourceLine" id="cb727-4" title="4"><span class="co">#&gt;  $ e1     : int [1:3] 1 2 3</span></a>
<a class="sourceLine" id="cb727-5" title="5"><span class="co">#&gt;  $ e2     : chr &quot;Chihuhua&quot;</span></a>
<a class="sourceLine" id="cb727-6" title="6"><span class="co">#&gt;  $ nouveau: num 100</span></a></code></pre></div>
<p><code>c()</code> permet aussi de “concaténer” deux listes existantes en une seule.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb728-1" title="1">l1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb728-2" title="2">l2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb728-3" title="3"><span class="kw">c</span>(l1, l2)</a>
<a class="sourceLine" id="cb728-4" title="4"><span class="co">#&gt; $a</span></a>
<a class="sourceLine" id="cb728-5" title="5"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb728-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb728-7" title="7"><span class="co">#&gt; $b</span></a>
<a class="sourceLine" id="cb728-8" title="8"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb728-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb728-10" title="10"><span class="co">#&gt; $x</span></a>
<a class="sourceLine" id="cb728-11" title="11"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb728-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb728-13" title="13"><span class="co">#&gt; $y</span></a>
<a class="sourceLine" id="cb728-14" title="14"><span class="co">#&gt; [1] 4</span></a></code></pre></div>
<p>On peut aussi utiliser la fonction <code>append()</code> qui permet d’ajouter de nouveaux éléments à la fin de la liste ou de les insérer à une position spécifique indiquée par l’argument <code>after</code>.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" title="1"><span class="kw">append</span>(l, <span class="kw">list</span>(<span class="dt">nouveau1 =</span> <span class="dv">100</span>, <span class="dt">nouveau2 =</span> <span class="dv">102</span>), <span class="dt">after =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb729-2" title="2"><span class="co">#&gt; $e1</span></a>
<a class="sourceLine" id="cb729-3" title="3"><span class="co">#&gt; [1] 1 2 3</span></a>
<a class="sourceLine" id="cb729-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb729-5" title="5"><span class="co">#&gt; $nouveau1</span></a>
<a class="sourceLine" id="cb729-6" title="6"><span class="co">#&gt; [1] 100</span></a>
<a class="sourceLine" id="cb729-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb729-8" title="8"><span class="co">#&gt; $nouveau2</span></a>
<a class="sourceLine" id="cb729-9" title="9"><span class="co">#&gt; [1] 102</span></a>
<a class="sourceLine" id="cb729-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb729-11" title="11"><span class="co">#&gt; $e2</span></a>
<a class="sourceLine" id="cb729-12" title="12"><span class="co">#&gt; [1] &quot;Chihuhua&quot;</span></a></code></pre></div>
</div>
<div id="sélection-déléments-1" class="section level4">
<h4><span class="header-section-number">15.1.2.3</span> Sélection d’éléments</h4>
<p>Il y a deux opérateurs différents qui permettent de sélectionner ou modifier les éléments d’une liste : les crochets simples <code>[]</code> et les crochets doubles <code>[[]]</code>. La différence entre ces deux opérateurs est souvent source de confusion.</p>
<p>Partons de la liste suivante :</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb730-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="st">&quot;foo&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb730-2" title="2">l</a>
<a class="sourceLine" id="cb730-3" title="3"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb730-4" title="4"><span class="co">#&gt; [1] 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb730-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb730-6" title="6"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb730-7" title="7"><span class="co">#&gt; [1] &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb730-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb730-9" title="9"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb730-10" title="10"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>Si on utilise les crochets simples pour sélectionner le premier élément de cette liste, on obtient le résultat suivant :</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb731-1" title="1">l[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb731-2" title="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb731-3" title="3"><span class="co">#&gt; [1] 1 2 3 4 5</span></a></code></pre></div>
<p>On notera que le résultat est une liste à un seul élément.</p>
<p>Si on utilise les crochets doubles :</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb732-1" title="1">l[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb732-2" title="2"><span class="co">#&gt; [1] 1 2 3 4 5</span></a></code></pre></div>
<p>On obtient cette fois-ci non pas une liste composée du premier élément, mais le contenu de ce premier élément.</p>
<div class="rmdimportant">
<p>
La différence est importante, mais pas toujours facile à retenir. On peut utiliser deux petites astuces mnémotechniques :
</p>
<ul>
<li>
si une liste est un train composé de plusieurs wagons, <code>[1]</code> retourne le premier wagon du train, tandis que <code>[[1]]</code> renvoie le contenu du premier wagon.
</li>
<li>
une alternative est de considérer que <code>[[]]</code> va chercher “plus profondément” que <code>[]</code>.
</li>
</ul>
</div>
<p>Un autre point important est que si on passe plusieurs éléments à <code>[[]]</code>, la sélection se fait d’une manière récursive peu intuitive et source d’erreurs. Il est donc conseillé de <strong>toujours utiliser <code>[[]]</code> avec un seul argument</strong>, et d’utiliser <code>[]</code> si on souhaite sélectionner plusieurs éléments d’une liste.</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb733-1" title="1">l[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</a>
<a class="sourceLine" id="cb733-2" title="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb733-3" title="3"><span class="co">#&gt; [1] 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb733-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb733-5" title="5"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb733-6" title="6"><span class="co">#&gt; [1] &quot;foo&quot;</span></a></code></pre></div>
<div class="rmdimportant">
<p>
En résumé :
</p>
<ul>
<li>
si on souhaite récupérer uniquement le contenu d’un élément d’une liste, on utilise <code>[[]]</code> avec un seul argument.
</li>
<li>
si on souhaite récupérer une nouvelle liste en sélectionnant des éléments de notre liste actuelle, on utilise <code>[]</code> avec un ou plusieurs arguments.
</li>
</ul>
</div>
<div class="rmdnote">
<p>
Comme pour les vecteurs, on peut aussi utiliser des nombres négatifs avec <code>[]</code> pour exclure des éléments plutôt que les sélectionner, ainsi que les fonctions <code>head()</code> et <code>tail()</code>.
</p>
</div>
<p>Si la liste est nommée, on peut sélectionner des éléments par noms avec les deux opérateurs.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb734-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">nombre =</span> <span class="dv">1</span>, <span class="dt">char =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">vecteur =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb734-2" title="2">l[<span class="kw">c</span>(<span class="st">&quot;nombre&quot;</span>, <span class="st">&quot;char&quot;</span>)]</a>
<a class="sourceLine" id="cb734-3" title="3"><span class="co">#&gt; $nombre</span></a>
<a class="sourceLine" id="cb734-4" title="4"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb734-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb734-6" title="6"><span class="co">#&gt; $char</span></a>
<a class="sourceLine" id="cb734-7" title="7"><span class="co">#&gt; [1] &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb734-8" title="8">l[[<span class="st">&quot;vecteur&quot;</span>]]</a>
<a class="sourceLine" id="cb734-9" title="9"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>On peut aussi utiliser l’opérateur <code>$</code>, qui équivaut à <code>[[]]</code> :</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb735-1" title="1">l<span class="op">$</span>vecteur</a>
<a class="sourceLine" id="cb735-2" title="2"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>Là aussi, si le nom comporte des espaces, on doit l’entourer avec des quotes inverses.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb736-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">`</span><span class="dt">Élément 1</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">Élément 2</span><span class="st">`</span> =<span class="st"> &quot;foo&quot;</span>)</a>
<a class="sourceLine" id="cb736-2" title="2">l<span class="op">$</span><span class="st">`</span><span class="dt">Élément 1</span><span class="st">`</span></a>
<a class="sourceLine" id="cb736-3" title="3"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>Attention, <code>$</code> effectue ce qu’on appelle du <em>“partial matching”</em>, c’est-à-dire qu’il peut récupérer un élément même si on lui a passé seulement le début du nom.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb737-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">nombre =</span> <span class="dv">1</span>, <span class="dt">char =</span> <span class="st">&quot;foo&quot;</span>)</a>
<a class="sourceLine" id="cb737-2" title="2">l<span class="op">$</span>no</a>
<a class="sourceLine" id="cb737-3" title="3"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
</div>
<div id="modification-1" class="section level4">
<h4><span class="header-section-number">15.1.2.4</span> Modification</h4>
<p>Comme pour les vecteurs, on peut utiliser les opérateurs de sélection pour modifier des éléments. Si on n’en modifie qu’un seul, <code>[]</code> et <code>[[]]</code> sont équivalents.</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb738-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">nombre =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">char =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">vecteur =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb738-2" title="2">l[<span class="dv">1</span>] &lt;-<span class="st"> &quot;first&quot;</span></a>
<a class="sourceLine" id="cb738-3" title="3">l[[<span class="dv">2</span>]] &lt;-<span class="st"> &quot;second&quot;</span></a>
<a class="sourceLine" id="cb738-4" title="4">l</a>
<a class="sourceLine" id="cb738-5" title="5"><span class="co">#&gt; $nombre</span></a>
<a class="sourceLine" id="cb738-6" title="6"><span class="co">#&gt; [1] &quot;first&quot;</span></a>
<a class="sourceLine" id="cb738-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb738-8" title="8"><span class="co">#&gt; $char</span></a>
<a class="sourceLine" id="cb738-9" title="9"><span class="co">#&gt; [1] &quot;second&quot;</span></a>
<a class="sourceLine" id="cb738-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb738-11" title="11"><span class="co">#&gt; $vecteur</span></a>
<a class="sourceLine" id="cb738-12" title="12"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>Si on souhaite modifier plusieurs éléments, on doit utiliser les crochets simples.</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb739-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">nombre =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">char =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">vecteur =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb739-2" title="2">l[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb739-3" title="3">l</a>
<a class="sourceLine" id="cb739-4" title="4"><span class="co">#&gt; $nombre</span></a>
<a class="sourceLine" id="cb739-5" title="5"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb739-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb739-7" title="7"><span class="co">#&gt; $char</span></a>
<a class="sourceLine" id="cb739-8" title="8"><span class="co">#&gt; [1] &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb739-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb739-10" title="10"><span class="co">#&gt; $vecteur</span></a>
<a class="sourceLine" id="cb739-11" title="11"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<div class="rmdimportant">
<p>
Comme pour la sélection, attention à ne pas utiliser les crochets doubles pour modifier plusieurs éléments d’une liste. Ceux-ci ne génèreront pas forcément d’erreur mais n’auront pas le comportement attendu.
</p>
</div>
<p>Enfin, si on souhaite supprimer un ou plusieurs éléments d’une liste, il faut leur attribuer la valeur <code>NULL</code><a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a>.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb740-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">nombre =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">char =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">vecteur =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb740-2" title="2">l<span class="op">$</span>char &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb740-3" title="3">l</a>
<a class="sourceLine" id="cb740-4" title="4"><span class="co">#&gt; $nombre</span></a>
<a class="sourceLine" id="cb740-5" title="5"><span class="co">#&gt; [1] 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb740-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb740-7" title="7"><span class="co">#&gt; $vecteur</span></a>
<a class="sourceLine" id="cb740-8" title="8"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
</div>
<div id="utilisation" class="section level4">
<h4><span class="header-section-number">15.1.2.5</span> Utilisation</h4>
<p>En tant que généralisation des vecteurs atomiques, les listes sont utiles dès qu’on souhaite regrouper des éléments complexes ou hétérogènes.</p>
<p>On les utilisera par exemple pour retourner plusieurs résultats différents depuis une fonction.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb741-1" title="1">indicateurs &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb741-2" title="2">    <span class="kw">list</span>(<span class="dt">moyenne =</span> <span class="kw">mean</span>(x), <span class="dt">variance =</span> <span class="kw">var</span>(x))</a>
<a class="sourceLine" id="cb741-3" title="3">}</a>
<a class="sourceLine" id="cb741-4" title="4"></a>
<a class="sourceLine" id="cb741-5" title="5">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb741-6" title="6">res &lt;-<span class="st"> </span><span class="kw">indicateurs</span>(x)</a>
<a class="sourceLine" id="cb741-7" title="7">res<span class="op">$</span>moyenne</a>
<a class="sourceLine" id="cb741-8" title="8"><span class="co">#&gt; [1] 5.5</span></a></code></pre></div>
<p>On utilise également les listes pour stocker une série d’objets complexes et leur appliquer des fonctions. Ce fonctionnement sera abordé en détail dans la section <a href="17-purrr.html#purrr">17</a>, mais en guise de petit aperçu, l’exemple fictif suivant récupère les noms de tous les fichiers CSV du répertoire courant et les importe tous dans une liste à l’aide de <code>purrr::map()</code> et de <code>read_csv()</code>.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb742-1" title="1">files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">pattern =</span> <span class="st">&quot;*.csv&quot;</span>)</a>
<a class="sourceLine" id="cb742-2" title="2">dfs &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(files, read_csv)</a></code></pre></div>
<p>On pourra ensuite utiliser cette liste de tableaux pour leur appliquer des transformations ou les fusionner.</p>
</div>
</div>
<div id="data-frame-tibbles" class="section level3">
<h3><span class="header-section-number">15.1.3</span> Tableaux de données (<em>data frame</em> et <em>tibble</em>)</h3>
<p>On a déjà utilisé les tableaux de données à de nombreux reprises en manipulant des <em>data frames</em> ou des <em>tibbles</em>. Les seconds sont une variante des premiers, les différences entre les deux ayant été abordées section <a href="06-tidyverse.html#tibbles">6.4</a>.</p>
<p>Un tableau de données est en réalité une liste nommée de vecteurs avec une contrainte spécifique : ces vecteurs doivent tous être de même longueur, ce qui garantit le format “tabulaire” des données.</p>
<div id="création-1" class="section level4">
<h4><span class="header-section-number">15.1.3.1</span> Création</h4>
<p>Un tableau de données est le plus souvent créé en important des données depuis un fichier au format CSV, tableur ou autre. On peut cependant créer un <em>data frame</em> manuellement via la fonction <code>data.frame()</code> :</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb743-2" title="2">    <span class="dt">fruit =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>),</a>
<a class="sourceLine" id="cb743-3" title="3">    <span class="dt">poids =</span> <span class="kw">c</span>(<span class="dv">154</span>, <span class="dv">167</span>, <span class="dv">92</span>),</a>
<a class="sourceLine" id="cb743-4" title="4">    <span class="dt">couleur =</span> <span class="kw">c</span>(<span class="st">&quot;vert&quot;</span>, <span class="st">&quot;vert&quot;</span>, <span class="st">&quot;jaune&quot;</span>)</a>
<a class="sourceLine" id="cb743-5" title="5">)</a></code></pre></div>
<p>On peut aussi créer un <em>tibble</em> manuellement avec la fonction <code>tibble()</code>. La syntaxe est la même que celle de <code>data.frame()</code>, mais avec un comportement un peu différent : notamment, les noms comportant des espaces ou des caractères spéciaux sont conservés tels quels.</p>
<p>La fonction <code>tribble()</code> permet de créer un tableau manuellement avec une syntaxe “par ligne” qui peut être un peu plus naturelle.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb744-1" title="1">df_tib &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb744-2" title="2">    <span class="op">~</span>fruit,   <span class="op">~</span>poids, <span class="op">~</span>couleur,</a>
<a class="sourceLine" id="cb744-3" title="3">    <span class="st">&quot;Pomme&quot;</span>,  <span class="dv">154</span>,    <span class="st">&quot;vert&quot;</span>,</a>
<a class="sourceLine" id="cb744-4" title="4">    <span class="st">&quot;Pomme&quot;</span>,  <span class="dv">167</span>,    <span class="st">&quot;vert&quot;</span>,</a>
<a class="sourceLine" id="cb744-5" title="5">    <span class="st">&quot;Citron&quot;</span>, <span class="dv">92</span>,     <span class="st">&quot;jaune&quot;</span></a>
<a class="sourceLine" id="cb744-6" title="6">)</a></code></pre></div>
<p>Enfin, on peut convertir un <em>data frame</em> en <em>tibble</em> avec la fonction <code>as_tibble()</code>.</p>
</div>
<div id="noms-de-colonnes-et-de-lignes" class="section level4">
<h4><span class="header-section-number">15.1.3.2</span> Noms de colonnes et de lignes</h4>
<p>On peut accéder et modifier les noms des colonnes d’un tableau avec les fonctions <code>names()</code> ou <code>colnames()</code> (qui sont équivalentes).</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" title="1"><span class="kw">names</span>(df)</a>
<a class="sourceLine" id="cb745-2" title="2"><span class="co">#&gt; [1] &quot;fruit&quot;   &quot;poids&quot;   &quot;couleur&quot;</span></a>
<a class="sourceLine" id="cb745-3" title="3"><span class="kw">colnames</span>(df)</a>
<a class="sourceLine" id="cb745-4" title="4"><span class="co">#&gt; [1] &quot;fruit&quot;   &quot;poids&quot;   &quot;couleur&quot;</span></a></code></pre></div>
<p>On peut attribuer des noms aux lignes d’un <em>data frame</em> à l’aide de la fonction <code>rownames()</code>. Attention cependant, les noms de ligne ne sont (volontairement) pas pris en charge par les <em>tibbles</em>.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb746-1" title="1"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruit1&quot;</span>, <span class="st">&quot;fruit2&quot;</span>, <span class="st">&quot;fruit3&quot;</span>)</a>
<a class="sourceLine" id="cb746-2" title="2"><span class="kw">rownames</span>(df)</a>
<a class="sourceLine" id="cb746-3" title="3"><span class="co">#&gt; [1] &quot;fruit1&quot; &quot;fruit2&quot; &quot;fruit3&quot;</span></a>
<a class="sourceLine" id="cb746-4" title="4"><span class="kw">rownames</span>(<span class="kw">as_tibble</span>(df))</a>
<a class="sourceLine" id="cb746-5" title="5"><span class="co">#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</span></a></code></pre></div>
<p>Si on souhaite conserver des noms de ligne en passant d’un <em>data frame</em> à un <em>tibble</em>, il faut les stocker dans une nouvelle colonne, soit en la créant manuellement soit avec la fonction <code>rownames_to_column()</code> (qui a l’avantage de placer la nouvelle colonne en première position du tableau).</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" title="1"><span class="kw">rownames_to_column</span>(df, <span class="st">&quot;name&quot;</span>)</a>
<a class="sourceLine" id="cb747-2" title="2"><span class="co">#&gt; # A tibble: 3 × 4</span></a>
<a class="sourceLine" id="cb747-3" title="3"><span class="co">#&gt;   name   fruit  poids couleur</span></a>
<a class="sourceLine" id="cb747-4" title="4"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb747-5" title="5"><span class="co">#&gt; 1 fruit1 Pomme    154 vert   </span></a>
<a class="sourceLine" id="cb747-6" title="6"><span class="co">#&gt; 2 fruit2 Pomme    167 vert   </span></a>
<a class="sourceLine" id="cb747-7" title="7"><span class="co">#&gt; 3 fruit3 Citron    92 jaune</span></a></code></pre></div>
</div>
<div id="sélection-de-lignes-et-de-colonnes" class="section level4">
<h4><span class="header-section-number">15.1.3.3</span> Sélection de lignes et de colonnes</h4>
<p>On a déjà vu dans les parties précédentes plusieurs manières de sélectionner des éléments dans un tableau de données.</p>
<p>Ainsi, on peut sélectionner une colonne via l’opérateur <code>$</code>.</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb748-1" title="1">df<span class="op">$</span>fruit</a>
<a class="sourceLine" id="cb748-2" title="2"><span class="co">#&gt; [1] &quot;Pomme&quot;  &quot;Pomme&quot;  &quot;Citron&quot;</span></a></code></pre></div>
<p>Attention, si votre tableau de données est un <em>data frame</em>, R fera du <em>partial matching</em> sur le nom donné à <code>$</code>, ce qui n’est pas toujours souhaitable (les <em>tibbles</em> n’ont pas ce comportement).</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" title="1">df<span class="op">$</span>poi</a>
<a class="sourceLine" id="cb749-2" title="2"><span class="co">#&gt; [1] 154 167  92</span></a></code></pre></div>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb750-1" title="1">tib &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(df)</a>
<a class="sourceLine" id="cb750-2" title="2">tib<span class="op">$</span>poi</a>
<a class="sourceLine" id="cb750-3" title="3"><span class="co">#&gt; Warning: Unknown or uninitialised column: `poi`.</span></a></code></pre></div>
<p>Comme un tableau de données est en réalité une liste de colonnes, on peut utiliser l’opérateur <code>[[]]</code> pour sélectionner l’une de ses colonnes, par position ou par nom<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a>.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" title="1">df[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb751-2" title="2"><span class="co">#&gt; [1] 154 167  92</span></a>
<a class="sourceLine" id="cb751-3" title="3">df[[<span class="st">&quot;couleur&quot;</span>]]</a>
<a class="sourceLine" id="cb751-4" title="4"><span class="co">#&gt; [1] &quot;vert&quot;  &quot;vert&quot;  &quot;jaune&quot;</span></a></code></pre></div>
<p>Comme pour les listes, on peut aussi utiliser <code>[]</code> pour sélectionner des colonnes. La différence avec <code>[[]]</code> est que lorsqu’on sélectionne une unique colonne le résultat est un tableau à une colonne, et non un vecteur.</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb752-1" title="1">df[[<span class="st">&quot;couleur&quot;</span>]]</a>
<a class="sourceLine" id="cb752-2" title="2"><span class="co">#&gt; [1] &quot;vert&quot;  &quot;vert&quot;  &quot;jaune&quot;</span></a>
<a class="sourceLine" id="cb752-3" title="3">df[<span class="st">&quot;couleur&quot;</span>]</a>
<a class="sourceLine" id="cb752-4" title="4"><span class="co">#&gt; # A tibble: 3 × 1</span></a>
<a class="sourceLine" id="cb752-5" title="5"><span class="co">#&gt;   couleur</span></a>
<a class="sourceLine" id="cb752-6" title="6"><span class="co">#&gt;   &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb752-7" title="7"><span class="co">#&gt; 1 vert   </span></a>
<a class="sourceLine" id="cb752-8" title="8"><span class="co">#&gt; 2 vert   </span></a>
<a class="sourceLine" id="cb752-9" title="9"><span class="co">#&gt; 3 jaune</span></a></code></pre></div>
<p>On peut également utiliser l’opérateur <code>[]</code> pour sélectionner à la fois des lignes et des colonnes, en lui passant deux arguments séparés par une virgule : d’abord la sélection des lignes puis celle des colonnes. Dans les deux cas on peut sélectionner par position, nom ou condition. Si on laisse un argument vide, on sélectionne l’intégralité des lignes ou des colonnes.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" title="1">df[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="st">&quot;poids&quot;</span>]</a>
<a class="sourceLine" id="cb753-2" title="2"><span class="co">#&gt; [1] 154  92</span></a>
<a class="sourceLine" id="cb753-3" title="3">df[df<span class="op">$</span>poids <span class="op">&gt;</span><span class="st"> </span><span class="dv">150</span>, ]</a>
<a class="sourceLine" id="cb753-4" title="4"><span class="co">#&gt; # A tibble: 2 × 3</span></a>
<a class="sourceLine" id="cb753-5" title="5"><span class="co">#&gt;   fruit poids couleur</span></a>
<a class="sourceLine" id="cb753-6" title="6"><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb753-7" title="7"><span class="co">#&gt; 1 Pomme   154 vert   </span></a>
<a class="sourceLine" id="cb753-8" title="8"><span class="co">#&gt; 2 Pomme   167 vert</span></a>
<a class="sourceLine" id="cb753-9" title="9"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb753-10" title="10">df[, <span class="kw">str_detect</span>(<span class="kw">names</span>(df), <span class="st">&quot;o&quot;</span>)]</a>
<a class="sourceLine" id="cb753-11" title="11"><span class="co">#&gt; # A tibble: 3 × 2</span></a>
<a class="sourceLine" id="cb753-12" title="12"><span class="co">#&gt;   poids couleur</span></a>
<a class="sourceLine" id="cb753-13" title="13"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb753-14" title="14"><span class="co">#&gt; 1   154 vert   </span></a>
<a class="sourceLine" id="cb753-15" title="15"><span class="co">#&gt; 2   167 vert   </span></a>
<a class="sourceLine" id="cb753-16" title="16"><span class="co">#&gt; 3    92 jaune</span></a></code></pre></div>
<p>Attention, le comportement de <code>[,]</code> est différent entre les <em>tibbles</em> et les <em>data frame</em> lorsqu’on ne sélectionne qu’une seule colonne. Dans le cas d’un <em>data frame</em>, le résultat est un vecteur, dans le cas d’un <em>tibble</em> le résultat est un tableau à une colonne.</p>
<p>Cette différence peut être source d’erreurs, il est donc important, notamment quand on développe une fonction qui prend un tableau de données en argument, de savoir si ce tableau est un <em>data frame</em> ou un <em>tibble</em>.</p>
<p>Par exemple, la fonction suivante prend comme arguments un tableau <code>d</code> et des noms de variable <code>vars</code>, puis retourne la matrice de variance-covariance du sous-tableau correspondant.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb754-1" title="1">tab_cov &lt;-<span class="st"> </span><span class="cf">function</span>(d, vars) {</a>
<a class="sourceLine" id="cb754-2" title="2">    <span class="kw">cov</span>(d[, vars])</a>
<a class="sourceLine" id="cb754-3" title="3">}</a></code></pre></div>
<p>On peut l’appliquer sans souci à deux colonnes d’un <em>data frame</em>.</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" title="1">tab &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">runif</span>(<span class="dv">5</span>), <span class="dt">y =</span> <span class="kw">runif</span>(<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb755-2" title="2"><span class="kw">tab_cov</span>(tab, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</a>
<a class="sourceLine" id="cb755-3" title="3"><span class="co">#&gt;             x           y</span></a>
<a class="sourceLine" id="cb755-4" title="4"><span class="co">#&gt; x  0.07915637 -0.05172231</span></a>
<a class="sourceLine" id="cb755-5" title="5"><span class="co">#&gt; y -0.05172231  0.14087428</span></a></code></pre></div>
<p>Mais si on essaie de l’appliquer à une seule colonne, on obtient une erreur car <code>d[, vars]</code> renvoie un vecteur, tandis que <code>cov()</code> ne s’applique qu’à un tableau de données.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb756-1" title="1"><span class="kw">tab_cov</span>(tab, <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb756-2" title="2"><span class="co">#&gt; Error in cov(d[, vars]): supply both &#39;x&#39; and &#39;y&#39; or a matrix-like &#39;x&#39;</span></a></code></pre></div>
<p>Si on transforme notre <em>data frame</em> en <em>tibble</em>, alors on peut appeler <code>tab_cov()</code> avec un seul nom de variables, car dans ce cas <code>d[, vars]</code> retourne bien un tableau à une colonne, et pas un vecteur.</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb757-1" title="1">tib &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(tab)</a>
<a class="sourceLine" id="cb757-2" title="2"><span class="kw">tab_cov</span>(tib, <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb757-3" title="3"><span class="co">#&gt;            x</span></a>
<a class="sourceLine" id="cb757-4" title="4"><span class="co">#&gt; x 0.07915637</span></a></code></pre></div>
<p>Pour corriger le problème dans notre fonction, on peut soit convertir l’objet <code>d</code> en <em>tibble</em> avant d’utiliser <code>[,]</code>.</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb758-1" title="1">tab_cov &lt;-<span class="st"> </span><span class="cf">function</span>(d, vars) {</a>
<a class="sourceLine" id="cb758-2" title="2">    d &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(d)</a>
<a class="sourceLine" id="cb758-3" title="3">    <span class="kw">cov</span>(d[, vars])</a>
<a class="sourceLine" id="cb758-4" title="4">}</a></code></pre></div>
<p>Soit ajouter un troisième argument <code>drop = FALSE</code> dans notre appel à <code>[,]</code>, qui fait que le résultat sera bien un tableau à une colonne même si <code>d</code> est un <em>data frame</em>.</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb759-1" title="1">tab_cov &lt;-<span class="st"> </span><span class="cf">function</span>(d, vars) {</a>
<a class="sourceLine" id="cb759-2" title="2">    tab &lt;-<span class="st"> </span>d[, vars, drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb759-3" title="3">    <span class="kw">cov</span>(tab)</a>
<a class="sourceLine" id="cb759-4" title="4">}</a></code></pre></div>
</div>
<div id="modification-2" class="section level4">
<h4><span class="header-section-number">15.1.3.4</span> Modification</h4>
<p>On peut utiliser <code>[[]]</code> et <code>[]</code> avec l’opérateur d’assignation <code>&lt;-</code> pour modifier tout ou partie d’un tableau de données.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb760-1" title="1">df[[<span class="st">&quot;poids_kg&quot;</span>]] &lt;-<span class="st"> </span>df<span class="op">$</span>poids <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb760-2" title="2">df[df<span class="op">$</span>fruit <span class="op">==</span><span class="st"> &quot;Citron&quot;</span>, <span class="st">&quot;fruit&quot;</span>] &lt;-<span class="st"> &quot;Agrume&quot;</span></a>
<a class="sourceLine" id="cb760-3" title="3">df</a>
<a class="sourceLine" id="cb760-4" title="4"><span class="co">#&gt; # A tibble: 3 × 4</span></a>
<a class="sourceLine" id="cb760-5" title="5"><span class="co">#&gt;   fruit  poids couleur poids_kg</span></a>
<a class="sourceLine" id="cb760-6" title="6"><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb760-7" title="7"><span class="co">#&gt; 1 Pomme    154 vert       0.154</span></a>
<a class="sourceLine" id="cb760-8" title="8"><span class="co">#&gt; 2 Pomme    167 vert       0.167</span></a>
<a class="sourceLine" id="cb760-9" title="9"><span class="co">#&gt; 3 Agrume    92 jaune      0.092</span></a></code></pre></div>
<p>Enfin, <code>[]</code> utilisé sans arguments permet de sélectionner et de modifier l’ensemble des valeurs du tableau. Ainsi les deux instructions suivantes ont des effets très différents :</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb761-1" title="1">df[] &lt;-<span class="st"> &quot;a&quot;</span></a>
<a class="sourceLine" id="cb761-2" title="2">df</a>
<a class="sourceLine" id="cb761-3" title="3"><span class="co">#&gt; # A tibble: 3 × 4</span></a>
<a class="sourceLine" id="cb761-4" title="4"><span class="co">#&gt;   fruit poids couleur poids_kg</span></a>
<a class="sourceLine" id="cb761-5" title="5"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   </span></a>
<a class="sourceLine" id="cb761-6" title="6"><span class="co">#&gt; 1 a     a     a       a       </span></a>
<a class="sourceLine" id="cb761-7" title="7"><span class="co">#&gt; 2 a     a     a       a       </span></a>
<a class="sourceLine" id="cb761-8" title="8"><span class="co">#&gt; 3 a     a     a       a</span></a>
<a class="sourceLine" id="cb761-9" title="9">df &lt;-<span class="st"> &quot;a&quot;</span></a>
<a class="sourceLine" id="cb761-10" title="10">df</a>
<a class="sourceLine" id="cb761-11" title="11"><span class="co">#&gt; [1] &quot;a&quot;</span></a></code></pre></div>
<p>Pour conclure, on peut noter que l’utilisation des opérateurs <code>[[]]</code> et <code>[]</code> sur un tableau de données peut sembler redondante et moins pratique que l’utilisation des verbes de <code>dplyr</code> comme <code>select()</code> ou <code>filter()</code>. Ils peuvent cependant être utiles lorsqu’on souhaite éviter les complications liées à l’utilisation du <em>tidyverse</em> à l’intérieur de fonctions, comme indiqué section <a href="18-programmer-tidyverse.html#programmer-tidyverse">18</a>.</p>
</div>
</div>
</div>
<div id="if-else-exécuter-du-code-sous-certaines-conditions" class="section level2">
<h2><span class="header-section-number">15.2</span> <code>if</code>, <code>else</code> : exécuter du code sous certaines conditions</h2>
<div id="if" class="section level3">
<h3><span class="header-section-number">15.2.1</span> <code>if</code></h3>
<p>L’instruction <code>if</code> permet de n’exécuter du code que si une condition est remplie.</p>
<p><img src="figures/structure_if.svg" /></p>
<p><code>if</code> prend une condition (entre parenthèses) puis un bloc de code (entre accolades) qui n’est exécuté que si la condition est vraie.</p>
<p>Par exemple, dans le code suivant, le message <code>Bonjour !</code> ne sera affiché que si la valeur de l’objet <code>prenom</code> vaut <code>"Pierre-Edmond"</code> :</p>
<p>Prenons tout de suite un exemple :</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb762-1" title="1">prenom &lt;-<span class="st"> &quot;Pierre-Edmond&quot;</span></a>
<a class="sourceLine" id="cb762-2" title="2"><span class="cf">if</span> (prenom <span class="op">==</span><span class="st"> &quot;Pierre-Edmond&quot;</span>) {</a>
<a class="sourceLine" id="cb762-3" title="3">    <span class="kw">message</span>(<span class="st">&quot;Bonjour !&quot;</span>)</a>
<a class="sourceLine" id="cb762-4" title="4">}</a>
<a class="sourceLine" id="cb762-5" title="5"><span class="co">#&gt; Bonjour !</span></a></code></pre></div>
<p>On peut utiliser ce code pour créer une passionnante fonction qui a pour objectif de ne dire bonjour qu’aux personnes qui s’appellent Pierre-Edmond :</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb763-1" title="1">bonjour_pierre_edmond &lt;-<span class="st"> </span><span class="cf">function</span>(prenom) {</a>
<a class="sourceLine" id="cb763-2" title="2">    <span class="cf">if</span> (prenom <span class="op">==</span><span class="st"> &quot;Pierre-Edmond&quot;</span>) {</a>
<a class="sourceLine" id="cb763-3" title="3">        <span class="kw">message</span>(<span class="st">&quot;Bonjour !&quot;</span>)</a>
<a class="sourceLine" id="cb763-4" title="4">    }</a>
<a class="sourceLine" id="cb763-5" title="5">}</a>
<a class="sourceLine" id="cb763-6" title="6"></a>
<a class="sourceLine" id="cb763-7" title="7"><span class="kw">bonjour_pierre_edmond</span>(<span class="st">&quot;Pierre-Edmond&quot;</span>)</a>
<a class="sourceLine" id="cb763-8" title="8"><span class="co">#&gt; Bonjour !</span></a>
<a class="sourceLine" id="cb763-9" title="9"><span class="kw">bonjour_pierre_edmond</span>(<span class="st">&quot;Valérie-Charlotte&quot;</span>)</a></code></pre></div>
<p>Une autre utilisation possible (et un peu plus utile) dans le cadre d’une fonction est de n’exécuter certaines instructions que si la valeur d’un argument remplit une certaine condition. Dans l’exemple suivant, on n’applique la fonction <code>round()</code> que si l’argument <code>arrondir</code> vaut <code>TRUE</code>.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb764-1" title="1">moyenne &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">arrondir =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb764-2" title="2">    res &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb764-3" title="3">    <span class="cf">if</span> (arrondir) {</a>
<a class="sourceLine" id="cb764-4" title="4">        res &lt;-<span class="st"> </span><span class="kw">round</span>(res)</a>
<a class="sourceLine" id="cb764-5" title="5">    }</a>
<a class="sourceLine" id="cb764-6" title="6">    res</a>
<a class="sourceLine" id="cb764-7" title="7">}</a>
<a class="sourceLine" id="cb764-8" title="8"></a>
<a class="sourceLine" id="cb764-9" title="9">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.4</span>, <span class="fl">2.3</span>, <span class="fl">8.9</span>)</a>
<a class="sourceLine" id="cb764-10" title="10"><span class="kw">moyenne</span>(v)</a>
<a class="sourceLine" id="cb764-11" title="11"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb764-12" title="12"><span class="kw">moyenne</span>(v, <span class="dt">arrondir =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb764-13" title="13"><span class="co">#&gt; [1] 4.2</span></a></code></pre></div>
<p>À noter que quand le bloc de code qui suit une instruction <code>if</code> ne comporte qu’une seule instruction, on peut omettre les accolades qui l’entourent. Les syntaxe suivantes sont donc équivalentes :</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb765-1" title="1"><span class="cf">if</span> (arrondir) {</a>
<a class="sourceLine" id="cb765-2" title="2">    res &lt;-<span class="st"> </span><span class="kw">round</span>(res)</a>
<a class="sourceLine" id="cb765-3" title="3">}</a>
<a class="sourceLine" id="cb765-4" title="4"></a>
<a class="sourceLine" id="cb765-5" title="5"><span class="cf">if</span> (arrondir) res &lt;-<span class="st"> </span><span class="kw">round</span>(res)</a>
<a class="sourceLine" id="cb765-6" title="6"></a>
<a class="sourceLine" id="cb765-7" title="7"><span class="cf">if</span> (arrondir) </a>
<a class="sourceLine" id="cb765-8" title="8">    res &lt;-<span class="st"> </span><span class="kw">round</span>(res)</a></code></pre></div>
<p>Pour des raisons de lisibilité, dans ce qui suit on conservera les accolades dans tous les cas.</p>
</div>
<div id="if-else-1" class="section level3">
<h3><span class="header-section-number">15.2.2</span> <code>if</code> / <code>else</code></h3>
<p>On utilise souvent <code>if</code> en conjonction avec l’instruction <code>else</code>. <code>else</code> précède un autre bloc de code R qui ne s’exécute que si la condition donnée à <code>if</code> est fausse :</p>
<p><img src="figures/structure_if_else.svg" /></p>
<p>On peut ainsi utiliser <code>if</code> / <code>else</code> pour une nouvelle fonction fort utile qui nous évitera bien des désagréments météorologiques :</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb766-1" title="1">conseil_vestimentaire &lt;-<span class="st"> </span><span class="cf">function</span>(temperature) {</a>
<a class="sourceLine" id="cb766-2" title="2">    <span class="cf">if</span> (temperature <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>) {</a>
<a class="sourceLine" id="cb766-3" title="3">        <span class="kw">message</span>(<span class="st">&quot;La polaire n&#39;est pas forcément nécessaire.&quot;</span>)</a>
<a class="sourceLine" id="cb766-4" title="4">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb766-5" title="5">        <span class="kw">message</span>(<span class="st">&quot;Vous devriez prendre une petite laine.&quot;</span>)</a>
<a class="sourceLine" id="cb766-6" title="6">    }</a>
<a class="sourceLine" id="cb766-7" title="7">}</a>
<a class="sourceLine" id="cb766-8" title="8"></a>
<a class="sourceLine" id="cb766-9" title="9"><span class="kw">conseil_vestimentaire</span>(<span class="op">-</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb766-10" title="10"><span class="co">#&gt; Vous devriez prendre une petite laine.</span></a></code></pre></div>
<p>Plus utile, on peut l’utiliser pour effectuer deux actions différentes en fonction de la valeur d’un argument. La fonction suivante génère deux graphiques différents selon le type du vecteur passé en argument :</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb767-1" title="1">graph_var &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb767-2" title="2">    <span class="cf">if</span> (<span class="kw">is.character</span>(x)) {</a>
<a class="sourceLine" id="cb767-3" title="3">        <span class="kw">barplot</span>(<span class="kw">table</span>(x))</a>
<a class="sourceLine" id="cb767-4" title="4">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb767-5" title="5">        <span class="kw">hist</span>(x)</a>
<a class="sourceLine" id="cb767-6" title="6">    }</a>
<a class="sourceLine" id="cb767-7" title="7">}</a>
<a class="sourceLine" id="cb767-8" title="8"></a>
<a class="sourceLine" id="cb767-9" title="9"><span class="kw">graph_var</span>(<span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a></code></pre></div>
<p><img src="introduction_au_tidyverse_files/figure-html/unnamed-chunk-860-1.svg" width="672" /></p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb768-1" title="1"><span class="kw">graph_var</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>))</a></code></pre></div>
<p><img src="introduction_au_tidyverse_files/figure-html/unnamed-chunk-860-2.svg" width="672" /></p>
<p>On peut évidemment passer des conditions plus complexes. Dans notre fonction, le test <code>is.character(x)</code> échoue si <code>x</code> est un facteur, alors qu’on souhaiterait quand même réaliser un <code>barplot</code>. On peut donc compléter la condition du <code>if</code> :</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb769-1" title="1">graph_var &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb769-2" title="2">    <span class="cf">if</span> (<span class="kw">is.character</span>(x) <span class="op">||</span><span class="st"> </span><span class="kw">is.factor</span>(x)) {</a>
<a class="sourceLine" id="cb769-3" title="3">        <span class="kw">barplot</span>(<span class="kw">table</span>(x))</a>
<a class="sourceLine" id="cb769-4" title="4">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb769-5" title="5">        <span class="kw">hist</span>(x)</a>
<a class="sourceLine" id="cb769-6" title="6">    }</a>
<a class="sourceLine" id="cb769-7" title="7">}</a>
<a class="sourceLine" id="cb769-8" title="8"></a>
<a class="sourceLine" id="cb769-9" title="9"><span class="kw">graph_var</span>(<span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>)))</a></code></pre></div>
<p><img src="introduction_au_tidyverse_files/figure-html/unnamed-chunk-861-1.svg" width="672" /></p>
</div>
<div id="if-else-if-else" class="section level3">
<h3><span class="header-section-number">15.2.3</span> “<code>if</code>” / “<code>else if</code>” / “<code>else</code>”</h3>
<p>On peut aussi utiliser des blocs supplémentaires <code>else if</code> qui permettent d’ajouter de nouvelles conditions. Dès qu’une condition est vraie, le bloc de code correspondant est exécuté. Le dernier bloc <code>else</code> est exécuté si aucune des conditions n’est vraie.</p>
<p>On peut donc améliorer encore notre fonction <code>graph_var()</code> pour tester les différents types explicitement et afficher un message si aucun type géré n’a été reconnu.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb770-1" title="1">graph_var &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb770-2" title="2">    <span class="cf">if</span> (<span class="kw">is.character</span>(x) <span class="op">||</span><span class="st"> </span><span class="kw">is.factor</span>(x)) {</a>
<a class="sourceLine" id="cb770-3" title="3">        <span class="kw">barplot</span>(<span class="kw">table</span>(x))</a>
<a class="sourceLine" id="cb770-4" title="4">    } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(x)) {</a>
<a class="sourceLine" id="cb770-5" title="5">        <span class="kw">hist</span>(x)</a>
<a class="sourceLine" id="cb770-6" title="6">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb770-7" title="7">        <span class="kw">message</span>(<span class="st">&quot;Le type de x n&#39;est pas géré par la fonction&quot;</span>)</a>
<a class="sourceLine" id="cb770-8" title="8">    }</a>
<a class="sourceLine" id="cb770-9" title="9">}</a>
<a class="sourceLine" id="cb770-10" title="10"></a>
<a class="sourceLine" id="cb770-11" title="11"><span class="kw">graph_var</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb770-12" title="12"><span class="co">#&gt; Le type de x n&#39;est pas géré par la fonction</span></a></code></pre></div>
<p>Attention, seul le bloc de la première condition vraie est exécuté, l’ordre des conditions est donc important. Dans l’exemple suivant, le second bloc n’est jamais exécuté et donc le second message jamais affiché.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb771-1" title="1">test_x &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb771-2" title="2">    <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>) {</a>
<a class="sourceLine" id="cb771-3" title="3">        <span class="kw">message</span>(<span class="st">&quot;x est inférieur à 100&quot;</span>)</a>
<a class="sourceLine" id="cb771-4" title="4">    } <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb771-5" title="5">        <span class="kw">message</span>(<span class="st">&quot;x est inférieur à 10&quot;</span>)</a>
<a class="sourceLine" id="cb771-6" title="6">    }</a>
<a class="sourceLine" id="cb771-7" title="7">}</a>
<a class="sourceLine" id="cb771-8" title="8"></a>
<a class="sourceLine" id="cb771-9" title="9"><span class="kw">test_x</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb771-10" title="10"><span class="co">#&gt; x est inférieur à 100</span></a></code></pre></div>
<p>Il est donc important d’ordonner les conditions de la plus spécifique à la plus générale.</p>
</div>
<div id="construction-de-conditions-complexes" class="section level3">
<h3><span class="header-section-number">15.2.4</span> Construction de conditions complexes</h3>
<p>On peut combiner plusieurs tests avec les opérateurs logiques classiques :</p>
<ul>
<li><code>&amp;&amp;</code> est l’opérateur “et”, qui est vrai si les deux conditions qu’il réunit sont vraies</li>
<li><code>||</code> est l’opérateur “ou”, qui est vrai si au moins l’une des deux conditions qu’il réunit sont vraies</li>
<li><code>!</code> est l’opérateur “non”, qui teste si la condition qu’il précède est fausse</li>
</ul>
<p>Ainsi, si on veut qu’une variable <code>taille</code> soit comprise entre 100 et 150, on écrira :</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb772-1" title="1"><span class="cf">if</span> (taille <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;&amp;</span><span class="st"> </span>taille <span class="op">&lt;=</span><span class="st"> </span><span class="dv">150</span>) { }</a></code></pre></div>
<p>Si on souhaite que <code>temperature</code> soit inférieure à 10 ou que <code>pluie</code> soit égale à “averse” :</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb773-1" title="1"><span class="cf">if</span> (temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">||</span><span class="st"> </span>pluie <span class="op">==</span><span class="st"> &quot;averse&quot;</span>) { }</a></code></pre></div>
<p>Enfin, si on souhaite que la variable <code>v</code> ne soit pas égale à <code>NULL</code> :</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb774-1" title="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(v)) { }</a></code></pre></div>
<div class="rmdnote">
<p>
On pourra noter qu’il existe deux types d’opérateurs “et” et “ou” dans R :
</p>
<ul>
<li>
<code>&amp;</code> et <code>|</code> sont des opérateurs <em>vectorisés</em>. Ils peuvent s’appliquer à des vecteurs et retourneront un vecteur de <code>TRUE</code> et <code>FALSE</code>
</li>
<li>
<code>&amp;&amp;</code> et <code>||</code> ne peuvent retourner qu’une seule valeur, et si on leur fournit des vecteurs ils n’utiliseront que leurs premières valeurs
</li>
</ul>
<p>
Comme la condition passée à un <code>if</code> ne doit retourner qu’une seule valeur (et non un vecteur), on utilisera de préférence <code>&amp;&amp;</code> et <code>||</code> (et on privilégiera les autres pour les recodages).
</p>
</div>
</div>
<div id="différence-entre-if-else-et-ifelse" class="section level3">
<h3><span class="header-section-number">15.2.5</span> Différence entre <code>if</code> / <code>else</code> et <code>ifelse</code></h3>
<p>Une source fréquente de confusion concerne la différence entre les instructions <code>if</code> / <code>else</code> et la fonction <code>ifelse()</code> de R base (ou son équivalent <code>if_else</code> de <code>dplyr</code>, voir section <a href="09-recodages.html#if-else">9.4.1</a>). Les deux sont pourtant très différentes :</p>
<ul>
<li><code>if</code> / <code>else</code> s’utilisent quand on teste une seule condition et qu’on veut exécuter des blocs de code différents</li>
<li><code>ifelse</code> et <code>if_else</code> appliquent un test à un vecteur et retournent un vecteur</li>
</ul>
<p>Premier cas de figure : on a une seule valeur <code>x</code> et on veut afficher un message différent selon si celle-ci est inférieure ou supérieure à 10. Dans ce cas on utilise <code>if</code> / <code>else</code>.</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb775-1" title="1">x &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb775-2" title="2"></a>
<a class="sourceLine" id="cb775-3" title="3"><span class="cf">if</span> (x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb775-4" title="4">    <span class="kw">message</span>(<span class="st">&quot;&gt;=5&quot;</span>)</a>
<a class="sourceLine" id="cb775-5" title="5">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb775-6" title="6">    <span class="kw">message</span>(<span class="st">&quot;&lt;5&quot;</span>)</a>
<a class="sourceLine" id="cb775-7" title="7">}</a>
<a class="sourceLine" id="cb775-8" title="8"><span class="co">#&gt; &gt;=5</span></a></code></pre></div>
<p>Deuxième cas de figure : <code>x</code> est un vecteur et on souhaite recoder chacune de ses valeurs selon le même critère que ci-dessus. Dans ce cas on utilise <code>ifelse</code> ou <code>if_else</code>.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb776-1" title="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb776-2" title="2"></a>
<a class="sourceLine" id="cb776-3" title="3"><span class="kw">ifelse</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="st">&quot;&gt;=5&quot;</span>, <span class="st">&quot;&lt;5&quot;</span>)</a>
<a class="sourceLine" id="cb776-4" title="4"><span class="co">#&gt;  [1] &quot;&lt;5&quot;  &quot;&lt;5&quot;  &quot;&lt;5&quot;  &quot;&lt;5&quot;  &quot;&gt;=5&quot; &quot;&gt;=5&quot; &quot;&gt;=5&quot; &quot;&gt;=5&quot; &quot;&gt;=5&quot; &quot;&gt;=5&quot;</span></a></code></pre></div>
<p>Une erreur fréquente, notamment quand on est dans une fonction, est de passer à <code>if</code> une condition appliquée à un vecteur. Dans ce cas R a la bonne idée de mettre un message d’avertissement.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb777-1" title="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb777-2" title="2"></a>
<a class="sourceLine" id="cb777-3" title="3"><span class="cf">if</span> (x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb777-4" title="4">    <span class="kw">message</span>(<span class="st">&quot;&gt;=5&quot;</span>)</a>
<a class="sourceLine" id="cb777-5" title="5">}</a>
<a class="sourceLine" id="cb777-6" title="6"><span class="co">#&gt; Warning in if (x &gt;= 5) {: la condition a une longueur &gt; 1 et seul le premier</span></a>
<a class="sourceLine" id="cb777-7" title="7"><span class="co">#&gt; élément est utilisé</span></a></code></pre></div>
<div class="rmdimportant">
<p>
À retenir donc : quand on utilise l’instruction <code>if</code>, la condition qui lui est passée entre parenthèses ne doit renvoyer qu’une seule valeur <code>TRUE</code> ou <code>FALSE</code>.
</p>
</div>
</div>
</div>
<div id="contrôle-de-lexécution-et-gestion-des-erreurs" class="section level2">
<h2><span class="header-section-number">15.3</span> Contrôle de l’exécution et gestion des erreurs</h2>
<p>L’instruction <code>if</code> est souvent utilisée dans des fonctions pour valider les valeurs passées en arguments, ou plus généralement pour contrôler que l’exécution du code se déroule comme prévu.</p>
<div id="utilisation-de-return-pour-sortir-de-la-fonction" class="section level3">
<h3><span class="header-section-number">15.3.1</span> Utilisation de <code>return</code> pour sortir de la fonction</h3>
<p>Une première utilisation peut être d’utiliser un <code>return</code> pour interrompre l’exécution de la fonction et retourner un résultat. On a en effet vu section <a href="14-fonctions.html#resfunc">14.2.4</a> que dès que R rencontre un <code>return</code> dans une fonction, il interrompt immédiatement l’exécution de celle-ci.</p>
<p>La fonction suivante retourne la longueur du mot le plus long dans un vecteur de chaînes de caractères. On ajoute donc un test qui retourne <code>NA</code> dans le cas où le vecteur passé en argument serait d’un type différent.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb778-1" title="1">mot_le_plus_long &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb778-2" title="2">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.character</span>(x)) {</a>
<a class="sourceLine" id="cb778-3" title="3">        <span class="kw">return</span>(<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb778-4" title="4">    }</a>
<a class="sourceLine" id="cb778-5" title="5">    <span class="kw">max</span>(<span class="kw">nchar</span>(x))</a>
<a class="sourceLine" id="cb778-6" title="6">}</a>
<a class="sourceLine" id="cb778-7" title="7"></a>
<a class="sourceLine" id="cb778-8" title="8"><span class="kw">mot_le_plus_long</span>(<span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb778-9" title="9"><span class="co">#&gt; [1] 6</span></a>
<a class="sourceLine" id="cb778-10" title="10"><span class="kw">mot_le_plus_long</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb778-11" title="11"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
</div>
<div id="warning" class="section level3">
<h3><span class="header-section-number">15.3.2</span> <code>warning</code></h3>
<p>La fonction <code>warning</code> fonctionne comme <code>message</code> mais permet d’afficher un avertissement. Celui-ci est présenté différemment dans la console de manière à attirer l’attention sur un point particulier. Il indique également la fonction qui a déclenché l’avertissement ce qui peut être utile quand on exécute toute une série d’instructions d’un seul coup.</p>
<p>Ainsi, dans la fonction précédente, on peut ajouter un avertissement dans le cas où le vecteur passé en argument n’est pas de type <code>character</code>.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb779-1" title="1">mot_le_plus_long &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb779-2" title="2">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.character</span>(x)) {</a>
<a class="sourceLine" id="cb779-3" title="3">        <span class="kw">warning</span>(<span class="st">&quot;x n&#39;est pas de type character, le résultat vaut NA.&quot;</span>)</a>
<a class="sourceLine" id="cb779-4" title="4">        <span class="kw">return</span>(<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb779-5" title="5">    }</a>
<a class="sourceLine" id="cb779-6" title="6">    <span class="kw">max</span>(<span class="kw">nchar</span>(x))</a>
<a class="sourceLine" id="cb779-7" title="7">}</a>
<a class="sourceLine" id="cb779-8" title="8"></a>
<a class="sourceLine" id="cb779-9" title="9"><span class="kw">mot_le_plus_long</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb779-10" title="10"><span class="co">#&gt; Warning in mot_le_plus_long(1:5): x n&#39;est pas de type character, le résultat</span></a>
<a class="sourceLine" id="cb779-11" title="11"><span class="co">#&gt; vaut NA.</span></a>
<a class="sourceLine" id="cb779-12" title="12"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
</div>
<div id="stop-et-stopifnot" class="section level3">
<h3><span class="header-section-number">15.3.3</span> <code>stop</code> et <code>stopifnot</code></h3>
<p><code>stop</code> fonctionne comme <code>warning</code> mais déclenche une erreur qui interrompt totalement l’exécution du code. Quand R le rencontre dans une fonction, il sort immédiatement de la fonction, ne retourne aucun résultat, et il interrompt également toutes les autres instructions en attente d’exécution.</p>
<p>On peut ainsi considérer, toujours dans la fonction <code>mot_le_plus_long</code>, que le fait de ne pas fournir en argument un vecteur de type character est suffisamment “grave” pour interrompre l’exécution en cours et laisser la personne qui utilise la fonction régler le problème.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb780-1" title="1">mot_le_plus_long &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb780-2" title="2">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.character</span>(x)) {</a>
<a class="sourceLine" id="cb780-3" title="3">        <span class="kw">stop</span>(<span class="st">&quot;x doit être de type character.&quot;</span>)</a>
<a class="sourceLine" id="cb780-4" title="4">    }</a>
<a class="sourceLine" id="cb780-5" title="5">    <span class="kw">max</span>(<span class="kw">nchar</span>(x))</a>
<a class="sourceLine" id="cb780-6" title="6">}</a>
<a class="sourceLine" id="cb780-7" title="7"></a>
<a class="sourceLine" id="cb780-8" title="8"><span class="kw">mot_le_plus_long</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb780-9" title="9"><span class="co">#&gt; Error in mot_le_plus_long(1:5): x doit être de type character.</span></a>
<a class="sourceLine" id="cb780-10" title="10"><span class="kw">mot_le_plus_long</span>(<span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>))</a>
<a class="sourceLine" id="cb780-11" title="11"><span class="co">#&gt; [1] 6</span></a></code></pre></div>
<p>Dans ce cas on remarque que le deuxième appel <code>mot_le_plus_long(c("Pomme", "Citron"))</code> n’est pas exécuté : R a tout interrompu dès qu’il a rencontré l’instruction <code>stop()</code>.</p>
<div class="rmdnote">
<p>
Savoir si un “problème” doit être traité comme un avertissement ou comme une erreur relève du choix de la personne qui développe la fonction : chaque cas est particulier.
</p>
</div>
<p><code>stopifnot</code> est une syntaxe alternative un peu plus compacte qui combine test et message d’erreur. On lui passe en premier argument une condition, et en deuxième argument un message à afficher si la condition est fausse.</p>
<p>On peut donc réécrire notre fonction <code>mot_le_plus_long</code> ci-dessus de la manière suivante :</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb781-1" title="1">mot_le_plus_long &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb781-2" title="2">    <span class="kw">stopifnot</span>(<span class="kw">is.character</span>(x), <span class="st">&quot;x doit être de type character.&quot;</span>)</a>
<a class="sourceLine" id="cb781-3" title="3">    <span class="kw">max</span>(<span class="kw">nchar</span>(x))</a>
<a class="sourceLine" id="cb781-4" title="4">}</a>
<a class="sourceLine" id="cb781-5" title="5"></a>
<a class="sourceLine" id="cb781-6" title="6"><span class="kw">mot_le_plus_long</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb781-7" title="7"><span class="co">#&gt; Error in mot_le_plus_long(1:5): is.character(x) n&#39;est pas TRUE</span></a></code></pre></div>
</div>
<div id="tester-la-présence-dun-argument" class="section level3">
<h3><span class="header-section-number">15.3.4</span> Tester la présence d’un argument</h3>
<p>Il existe deux méthodes pour tester si l’argument d’une fonction a été défini lors de l’appel de cette fonction. La plus courante est de donner à cet argument une valeur par défaut, le plus souvent <code>NULL</code>, et de tester cette valeur.</p>
<p>Soit une fonction qui génère un graphique avec un argument <code>titre</code> qui permet de définir son titre. On peut mettre par défaut cet argument à <code>NULL</code> et ajouter un titre par défaut si la personne qui l’utilise n’en a pas fourni.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb782-1" title="1">histo &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">titre =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb782-2" title="2">    <span class="cf">if</span> (<span class="kw">is.null</span>(titre)) {</a>
<a class="sourceLine" id="cb782-3" title="3">        titre &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Moyenne : &quot;</span>, <span class="kw">mean</span>(x))</a>
<a class="sourceLine" id="cb782-4" title="4">    }</a>
<a class="sourceLine" id="cb782-5" title="5">    <span class="kw">hist</span>(x, <span class="dt">main =</span> titre)</a>
<a class="sourceLine" id="cb782-6" title="6">}</a>
<a class="sourceLine" id="cb782-7" title="7"></a>
<a class="sourceLine" id="cb782-8" title="8"><span class="kw">histo</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">8</span>, <span class="dv">4</span>))</a></code></pre></div>
<p><img src="introduction_au_tidyverse_files/figure-html/unnamed-chunk-877-1.svg" width="672" /></p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb783-1" title="1"><span class="kw">histo</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">8</span>, <span class="dv">4</span>), <span class="dt">titre =</span> <span class="st">&quot;Quel bel histogramme&quot;</span>)</a></code></pre></div>
<p><img src="introduction_au_tidyverse_files/figure-html/unnamed-chunk-877-2.svg" width="672" /></p>
<p>Quand on ne souhaite pas mettre de valeur par défaut, on peut tester l’absence de l’argument à l’aide de la fonction <code>missing()</code>.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb784-1" title="1">moyenne_arrondie &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb784-2" title="2">    <span class="cf">if</span> (<span class="kw">missing</span>(x)) <span class="kw">stop</span>(<span class="st">&quot;x est manquant&quot;</span>)</a>
<a class="sourceLine" id="cb784-3" title="3">    <span class="kw">round</span>(<span class="kw">mean</span>(x))</a>
<a class="sourceLine" id="cb784-4" title="4">}</a>
<a class="sourceLine" id="cb784-5" title="5"></a>
<a class="sourceLine" id="cb784-6" title="6"><span class="kw">moyenne_arrondie</span>()</a>
<a class="sourceLine" id="cb784-7" title="7"><span class="co">#&gt; Error in moyenne_arrondie(): x est manquant</span></a></code></pre></div>
<p>En dehors de certains cas particuliers l’utilisation de <code>missing()</code> est assez rare, car les arguments sans valeur par défaut sont le plus souvent des valeurs “obligatoires” qui génèrent de toutes manières une erreur quand elles ne sont pas définies.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb785-1" title="1">correlation_arrondie &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb785-2" title="2">    <span class="kw">round</span>(<span class="kw">cor</span>(x, y))</a>
<a class="sourceLine" id="cb785-3" title="3">}</a>
<a class="sourceLine" id="cb785-4" title="4"></a>
<a class="sourceLine" id="cb785-5" title="5"><span class="kw">correlation_arrondie</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb785-6" title="6"><span class="co">#&gt; Error in is.data.frame(y): l&#39;argument &quot;y&quot; est manquant, avec aucune valeur par défaut</span></a></code></pre></div>
</div>
</div>
<div id="for-et-while-répéter-des-instructions-dans-une-boucle" class="section level2">
<h2><span class="header-section-number">15.4</span> <code>for</code> et <code>while</code> : répéter des instructions dans une boucle</h2>
<p>Les boucles sont un type d’instructions qui permet de répéter du code plusieurs fois, soit en fonction d’une condition soit selon les éléments d’un vecteur<a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a>.</p>
<div id="for" class="section level3">
<h3><span class="header-section-number">15.4.1</span> <code>for</code></h3>
<p>Le premier type de boucle est défini par l’instruction <code>for</code>. Sa structure est la suivante :</p>
<p><img src="figures/structure_for.svg" /></p>
<p>Le principe est le suivant : on fournit à <code>for</code> entre parenthèses une expression du type <code>item in vecteur</code>, puis un bloc de code entre accolades. <code>for</code> va exécuter le bloc de codes pour chacune des valeurs de <code>vecteur</code>, et affectera tour à tour à <code>item</code> la valeur courante de <code>vecteur</code>.</p>
<p>Prenons tout de suite un exemple pour mieux comprendre.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb786-1" title="1"><span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb786-2" title="2">    <span class="kw">print</span>(item)</a>
<a class="sourceLine" id="cb786-3" title="3">}</a>
<a class="sourceLine" id="cb786-4" title="4"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb786-5" title="5"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb786-6" title="6"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb786-7" title="7"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb786-8" title="8"><span class="co">#&gt; [1] 5</span></a></code></pre></div>
<p>Ici notre vecteur “source” est constitué des entiers de 1 à 5. <code>for</code> va donc exécuter l’instruction <code>print(item)</code> 5 fois, en remplaçant la première fois <code>item</code> par 1, la seconde fois par 2, etc.</p>
<p>On peut itérer sur tout type d’objet, et le nom <code>item</code> peut être remplacé par ce que l’on souhaite :</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb787-1" title="1"><span class="cf">for</span> (prenom <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;Pierre-Edmond&quot;</span>, <span class="st">&quot;Faustine-Charlotte&quot;</span>)) {</a>
<a class="sourceLine" id="cb787-2" title="2">    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Bonjour&quot;</span>, prenom, <span class="st">&quot;!&quot;</span>))</a>
<a class="sourceLine" id="cb787-3" title="3">}</a>
<a class="sourceLine" id="cb787-4" title="4"><span class="co">#&gt; [1] &quot;Bonjour Pierre-Edmond !&quot;</span></a>
<a class="sourceLine" id="cb787-5" title="5"><span class="co">#&gt; [1] &quot;Bonjour Faustine-Charlotte !&quot;</span></a></code></pre></div>
<p>Exemple un peu plus complexe, la fonction suivante prend en entrée un data frame et un vecteur de noms de variables, et affiche le résultat de <code>summary</code> pour chacune d’entre elles.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb788-1" title="1">summaries &lt;-<span class="st"> </span><span class="cf">function</span>(d, vars) {</a>
<a class="sourceLine" id="cb788-2" title="2">    <span class="cf">for</span> (var <span class="cf">in</span> vars) {</a>
<a class="sourceLine" id="cb788-3" title="3">        <span class="kw">message</span>(<span class="st">&quot;--- &quot;</span>, var, <span class="st">&quot; ---&quot;</span>)</a>
<a class="sourceLine" id="cb788-4" title="4">        <span class="kw">print</span>(<span class="kw">summary</span>(d[, var]))</a>
<a class="sourceLine" id="cb788-5" title="5">    }</a>
<a class="sourceLine" id="cb788-6" title="6">}</a>
<a class="sourceLine" id="cb788-7" title="7"></a>
<a class="sourceLine" id="cb788-8" title="8"><span class="kw">summaries</span>(hdv2003, <span class="kw">c</span>(<span class="st">&quot;sexe&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;heures.tv&quot;</span>))</a>
<a class="sourceLine" id="cb788-9" title="9"><span class="co">#&gt; --- sexe ---</span></a>
<a class="sourceLine" id="cb788-10" title="10"><span class="co">#&gt; Homme Femme </span></a>
<a class="sourceLine" id="cb788-11" title="11"><span class="co">#&gt;   899  1101</span></a>
<a class="sourceLine" id="cb788-12" title="12"><span class="co">#&gt; --- age ---</span></a>
<a class="sourceLine" id="cb788-13" title="13"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb788-14" title="14"><span class="co">#&gt;   18.00   35.00   48.00   48.16   60.00   97.00</span></a>
<a class="sourceLine" id="cb788-15" title="15"><span class="co">#&gt; --- heures.tv ---</span></a>
<a class="sourceLine" id="cb788-16" title="16"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s </span></a>
<a class="sourceLine" id="cb788-17" title="17"><span class="co">#&gt;   0.000   1.000   2.000   2.247   3.000  12.000       5</span></a></code></pre></div>
<p>Un “pattern” relativement fréquent est de vouloir itérer sur les éléments d’un vecteur par leur position. Il est du coup assez naturel d’utiliser quelque chose comme <code>for (i in 1:length(x))</code>. Il est cependant préférable dans ces cas-là d’utiliser la fonction dédiée <code>seq_along(x)</code><a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a>.</p>
<p>Dans l’exemple suivant, la fonction <code>affiche_dimensions</code> prend en entrée une liste de data frames et affiche leur nombre de lignes et de colonnes.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb789-1" title="1">affiche_dimensions &lt;-<span class="st"> </span><span class="cf">function</span>(dfs) {</a>
<a class="sourceLine" id="cb789-2" title="2">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(dfs)) {</a>
<a class="sourceLine" id="cb789-3" title="3">        name &lt;-<span class="st"> </span><span class="kw">names</span>(dfs)[[i]]</a>
<a class="sourceLine" id="cb789-4" title="4">        df &lt;-<span class="st"> </span>dfs[[i]]</a>
<a class="sourceLine" id="cb789-5" title="5">        <span class="kw">message</span>(<span class="st">&quot;Dimensions de &quot;</span>, name, <span class="st">&quot; : &quot;</span>, <span class="kw">nrow</span>(df), <span class="st">&quot;x&quot;</span>, <span class="kw">ncol</span>(df))</a>
<a class="sourceLine" id="cb789-6" title="6">    }</a>
<a class="sourceLine" id="cb789-7" title="7">}</a>
<a class="sourceLine" id="cb789-8" title="8"></a>
<a class="sourceLine" id="cb789-9" title="9">l &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb789-10" title="10">    <span class="dt">hdv =</span> hdv2003,</a>
<a class="sourceLine" id="cb789-11" title="11">    <span class="dt">rp =</span> rp2012</a>
<a class="sourceLine" id="cb789-12" title="12">)</a>
<a class="sourceLine" id="cb789-13" title="13"><span class="kw">affiche_dimensions</span>(l)</a>
<a class="sourceLine" id="cb789-14" title="14"><span class="co">#&gt; Dimensions de hdv : 2000x24</span></a>
<a class="sourceLine" id="cb789-15" title="15"><span class="co">#&gt; Dimensions de rp : 5170x60</span></a></code></pre></div>
<p>À noter que quand on sort d’une boucle <code>for</code>, l’objet utilisé pour itérer sur les valeurs du vecteur existe toujours, et contient la dernière valeur qu’il a prise.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb790-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb790-2" title="2">    <span class="kw">print</span>(<span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb790-3" title="3">}</a>
<a class="sourceLine" id="cb790-4" title="4"><span class="co">#&gt; [1] &quot;a&quot;</span></a>
<a class="sourceLine" id="cb790-5" title="5"><span class="co">#&gt; [1] &quot;a&quot;</span></a>
<a class="sourceLine" id="cb790-6" title="6"><span class="co">#&gt; [1] &quot;a&quot;</span></a>
<a class="sourceLine" id="cb790-7" title="7"><span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb790-8" title="8"><span class="co">#&gt; [1] 3</span></a></code></pre></div>
</div>
<div id="while" class="section level3">
<h3><span class="header-section-number">15.4.2</span> <code>while</code></h3>
<p><code>while</code> prend en argument une condition et exécute le bloc de code qui suit tant que la condition est vraie :</p>
<p><img src="figures/structure_while.svg" /></p>
<p>Par exemple, la fonction suivante simule un tirage à pile ou face en tirant un nombre au hasard entre 0 et 1 à l’aide de la fonction <code>runif()</code> et en testant si cette valeur est inférieure à 0,5. La simulation de tirage s’exécute et affiche le résultat tant qu’on obtient “Pile” (et interrompt la boucle au premier “Face”) :</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb791-1" title="1">resultat &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb791-2" title="2"><span class="cf">while</span> (resultat <span class="op">!=</span><span class="st"> &quot;Face&quot;</span>) {</a>
<a class="sourceLine" id="cb791-3" title="3">    tirage &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb791-4" title="4">    <span class="cf">if</span> (tirage <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>) {</a>
<a class="sourceLine" id="cb791-5" title="5">        resultat &lt;-<span class="st"> &quot;Pile&quot;</span></a>
<a class="sourceLine" id="cb791-6" title="6">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb791-7" title="7">        resultat &lt;-<span class="st"> &quot;Face&quot;</span></a>
<a class="sourceLine" id="cb791-8" title="8">    }</a>
<a class="sourceLine" id="cb791-9" title="9">    <span class="kw">print</span>(resultat)</a>
<a class="sourceLine" id="cb791-10" title="10">}</a></code></pre></div>
<pre><code>[1] &quot;Pile&quot;
[1] &quot;Pile&quot;
[1] &quot;Face&quot;</code></pre>
</div>
<div id="break-et-next" class="section level3">
<h3><span class="header-section-number">15.4.3</span> <code>break</code> et <code>next</code></h3>
<p>Il peut arriver qu’on souhaite sortir d’une boucle avant d’avoir terminé toutes ses itérations, notamment dans le cas d’une boucle <code>for</code>. C’est ce que permet de faire l’instruction <code>break</code>, qui interrompt la boucle et continue à l’instruction suivante.</p>
<p>Par exemple, la fonction suivante compte le nombre de valeurs inférieure à un certain seuil au début d’un vecteur.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb793-1" title="1">nb_seuil &lt;-<span class="st"> </span><span class="cf">function</span>(x, seuil) {</a>
<a class="sourceLine" id="cb793-2" title="2">    nb_valeurs &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb793-3" title="3">    <span class="cf">for</span> (item <span class="cf">in</span> x) {</a>
<a class="sourceLine" id="cb793-4" title="4">        <span class="cf">if</span> (item <span class="op">&gt;</span><span class="st"> </span>seuil) <span class="cf">break</span></a>
<a class="sourceLine" id="cb793-5" title="5">        nb_valeurs &lt;-<span class="st"> </span>nb_valeurs <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb793-6" title="6">    }</a>
<a class="sourceLine" id="cb793-7" title="7">    nb_valeurs</a>
<a class="sourceLine" id="cb793-8" title="8">}</a>
<a class="sourceLine" id="cb793-9" title="9"></a>
<a class="sourceLine" id="cb793-10" title="10"><span class="kw">nb_seuil</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">25</span>, <span class="dv">4</span>, <span class="dv">110</span>, <span class="dv">41</span>), <span class="dt">seuil =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb793-11" title="11"><span class="co">#&gt; [1] 3</span></a></code></pre></div>
<p>L’instruction <code>next</code> a un comportement assez similaire mais plutôt que de sortir de la boucle, elle passe à l’itération suivante.</p>
<p>Dans l’exemple suivant, on réécrit la fonction <code>summaries</code> vue précédemment pour prendre en compte le fait qu’un nom de variable non existante puisse être passé en argument. Dans ce cas on passe directement à la variable suivante.</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb794-1" title="1">summaries &lt;-<span class="st"> </span><span class="cf">function</span>(d, vars) {</a>
<a class="sourceLine" id="cb794-2" title="2">    <span class="cf">for</span> (var <span class="cf">in</span> vars) {</a>
<a class="sourceLine" id="cb794-3" title="3">        <span class="cf">if</span> (<span class="op">!</span>(var <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(d))) {</a>
<a class="sourceLine" id="cb794-4" title="4">            <span class="cf">next</span></a>
<a class="sourceLine" id="cb794-5" title="5">        }</a>
<a class="sourceLine" id="cb794-6" title="6">        <span class="kw">message</span>(<span class="st">&quot;--- &quot;</span>, var, <span class="st">&quot; ---&quot;</span>)</a>
<a class="sourceLine" id="cb794-7" title="7">        <span class="kw">print</span>(<span class="kw">summary</span>(d[, var]))</a>
<a class="sourceLine" id="cb794-8" title="8">    }</a>
<a class="sourceLine" id="cb794-9" title="9">}</a>
<a class="sourceLine" id="cb794-10" title="10"></a>
<a class="sourceLine" id="cb794-11" title="11"><span class="kw">summaries</span>(hdv2003, <span class="kw">c</span>(<span class="st">&quot;sexe&quot;</span>, <span class="st">&quot;diplodocus&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;heures.tv&quot;</span>))</a>
<a class="sourceLine" id="cb794-12" title="12"><span class="co">#&gt; --- sexe ---</span></a>
<a class="sourceLine" id="cb794-13" title="13"><span class="co">#&gt; Homme Femme </span></a>
<a class="sourceLine" id="cb794-14" title="14"><span class="co">#&gt;   899  1101</span></a>
<a class="sourceLine" id="cb794-15" title="15"><span class="co">#&gt; --- age ---</span></a>
<a class="sourceLine" id="cb794-16" title="16"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb794-17" title="17"><span class="co">#&gt;   18.00   35.00   48.00   48.16   60.00   97.00</span></a>
<a class="sourceLine" id="cb794-18" title="18"><span class="co">#&gt; --- heures.tv ---</span></a>
<a class="sourceLine" id="cb794-19" title="19"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s </span></a>
<a class="sourceLine" id="cb794-20" title="20"><span class="co">#&gt;   0.000   1.000   2.000   2.247   3.000  12.000       5</span></a></code></pre></div>
</div>
<div id="no-boucles" class="section level3">
<h3><span class="header-section-number">15.4.4</span> Quand (ne pas) utiliser des boucles</h3>
<p>Le mécanisme des boucles, assez intuitif, peut rapidement être utilisé pour beaucoup d’opérations. Il y a cependant sous R des alternatives souvent plus rapides, qu’il est préférable de privilégier.</p>
<p>Avant tout, de nombreuses fonctions R sont “vectorisées” et s’appliquent directement à tous les éléments d’un vecteur. Dans le cas où une fonction vectorisée existe déjà, elle propose en général une syntaxe plus compacte et une exécution plus rapide.</p>
<p>Pour prendre un exemple caricatural, si on souhaite ajouter 10 à chaque élément d’un vecteur on évitera absolument de faire :</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb795-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {</a>
<a class="sourceLine" id="cb795-2" title="2">    x[i] &lt;-<span class="st"> </span>x[i] <span class="op">+</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb795-3" title="3">}</a></code></pre></div>
<p>Et on se contentera d’un beaucoup plus simple <code>x + 10</code>.</p>
<p>Autre exemple, la boucle suivante remplace les valeurs manquantes d’un vecteur par les valeurs correspondantes d’un deuxième vecteur.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb796-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">4</span>, <span class="dv">110</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb796-2" title="2">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb796-3" title="3"></a>
<a class="sourceLine" id="cb796-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {</a>
<a class="sourceLine" id="cb796-5" title="5">    <span class="cf">if</span> (<span class="kw">is.na</span>(x[i])) x[i] &lt;-<span class="st"> </span>y[i]</a>
<a class="sourceLine" id="cb796-6" title="6">}</a>
<a class="sourceLine" id="cb796-7" title="7"></a>
<a class="sourceLine" id="cb796-8" title="8"><span class="kw">print</span>(x)</a>
<a class="sourceLine" id="cb796-9" title="9"><span class="co">#&gt; [1]   1  30   4 110  60</span></a></code></pre></div>
<p>Cette boucle sera avantageusement remplacée par une utilisation plus compacte et plus rapide de l’opérateur <code>[]</code>.</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb797-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">4</span>, <span class="dv">110</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb797-2" title="2">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb797-3" title="3">x[<span class="kw">is.na</span>(x)] &lt;-<span class="st"> </span>y[<span class="kw">is.na</span>(x)]</a>
<a class="sourceLine" id="cb797-4" title="4">x</a>
<a class="sourceLine" id="cb797-5" title="5"><span class="co">#&gt; [1]   1  30   4 110  60</span></a></code></pre></div>
<p>En dehors des questions de performance, une boucle peut aussi être moins lisible que certaines alternatives. Soit la fonction suivante, qui prend en entrée un vecteur de mots et retourne le nombre total de voyelles qu’il contient.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb798-1" title="1"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb798-2" title="2">n_voyelles &lt;-<span class="st"> </span><span class="cf">function</span>(mots) {</a>
<a class="sourceLine" id="cb798-3" title="3">    nb &lt;-<span class="st"> </span><span class="kw">str_count</span>(mots, <span class="st">&quot;[aeiou]&quot;</span>)</a>
<a class="sourceLine" id="cb798-4" title="4">    <span class="kw">sum</span>(nb)</a>
<a class="sourceLine" id="cb798-5" title="5">}</a>
<a class="sourceLine" id="cb798-6" title="6"></a>
<a class="sourceLine" id="cb798-7" title="7"><span class="kw">n_voyelles</span>(<span class="kw">c</span>(<span class="st">&quot;le&quot;</span>, <span class="st">&quot;chat&quot;</span>, <span class="st">&quot;roupille&quot;</span>))</a>
<a class="sourceLine" id="cb798-8" title="8"><span class="co">#&gt; [1] 6</span></a></code></pre></div>
<p>Supposons qu’on souhaite appliquer cette fonction à une série de vecteurs de mots contenus dans une liste. On pourrait utiliser une boucle <code>for</code> parcourant cette liste, appliquant la fonction, et ajoutant le résultat à un vecteur numérique vide préalablement créé avec <code>numeric(0)</code>.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb799-1" title="1">phrases &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb799-2" title="2">    <span class="kw">c</span>(<span class="st">&quot;le&quot;</span>, <span class="st">&quot;chat&quot;</span>, <span class="st">&quot;roupille&quot;</span>),</a>
<a class="sourceLine" id="cb799-3" title="3">    <span class="kw">c</span>(<span class="st">&quot;l&#39;autre&quot;</span>, <span class="st">&quot;chat&quot;</span>, <span class="st">&quot;roupille&quot;</span>, <span class="st">&quot;aussi&quot;</span>)</a>
<a class="sourceLine" id="cb799-4" title="4">)</a>
<a class="sourceLine" id="cb799-5" title="5"></a>
<a class="sourceLine" id="cb799-6" title="6">res &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb799-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(phrases)) {</a>
<a class="sourceLine" id="cb799-8" title="8">    res[i] &lt;-<span class="st"> </span><span class="kw">n_voyelles</span>(phrases[[i]])</a>
<a class="sourceLine" id="cb799-9" title="9">}</a>
<a class="sourceLine" id="cb799-10" title="10">res</a>
<a class="sourceLine" id="cb799-11" title="11"><span class="co">#&gt; [1]  6 11</span></a></code></pre></div>
<p>On verra cependant dans la section <a href="17-purrr.html#purrr">17</a> que des fonctions permettent de faire ce genre de choses de manière beaucoup plus simple et plus lisible. Ici par exemple on obtiendrait le même résultat avec un simple :</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb800-1" title="1">phrases <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_int</span>(n_voyelles)</a>
<a class="sourceLine" id="cb800-2" title="2"><span class="co">#&gt; [1]  6 11</span></a></code></pre></div>
<p>Au final, entre les fonctions vectorisées existantes et les possibilités fournies par <code>purrr</code>, il est assez rare de devoir utiliser une boucle directement dans R. Pour autant, il ne faut pas non plus tomber dans l’excès inverse et considérer que tout usage de <code>for</code> ou <code>while</code> doit être évité : ces fonctions sont parfaitement justifiées dans de nombreux cas de figure, et si vous trouvez une solution qui fonctionne de manière efficace avec une boucle <code>for</code>, il n’est pas forcément utile de chercher à la remplacer à tout prix.</p>
</div>
</div>
<div id="ressources-7" class="section level2">
<h2><span class="header-section-number">15.5</span> Ressources</h2>
<p>L’ouvrage <em>R for Data Science</em> (en anglais), accessible en ligne, contient <a href="https://r4ds.had.co.nz/vectors.html">un chapitre sur les vecteurs atomiques et les listes</a>, <a href="https://r4ds.had.co.nz/tibbles.html#tibbles">un chapitre dédié aux <em>tibbles</em></a>, <a href="https://r4ds.had.co.nz/iteration.html#for-loops">un chapitre sur les boucles for</a>, et <a href="https://r4ds.had.co.nz/functions.html#conditional-execution">un chapitre sur les blocs if / else</a>.</p>
<p>Pour aller encore plus loin, l’ouvrage <em>Advanced R</em> (également en anglais) aborde de manière approfondie <a href="https://adv-r.hadley.nz/vectors-chap.html">les structures de données</a>, <a href="https://adv-r.hadley.nz/subsetting.html">les opérateurs de sélection <code>[]</code>, <code>[[]]</code> et <code>$</code></a>, et <a href="https://adv-r.hadley.nz/control-flow.html">les tests et les boucles</a>.</p>
<p>Sur le blog de <a href="https://thinkr.fr/">ThinkR</a>, <a href="https://thinkr.fr/comment-faire-des-boucles-en-r-ou-pas/">un article détaillé sur l’utilisation des boucles</a> et les alternatives possibles.</p>
<p>Sur le <a href="https://privefl.github.io/blog/">blog de Florian Privé</a>, un <a href="https://privefl.github.io/blog/why-loops-are-slow-in-r/">billet approfondi sur les raisons pour lesquelles les boucles peuvent être lentes</a> et sur les cas où il est préférable de ne pas les utiliser.</p>
</div>
<div id="exercices-8" class="section level2">
<h2><span class="header-section-number">15.6</span> Exercices</h2>
<div id="vecteurs-atomiques-1" class="section level3">
<h3><span class="header-section-number">15.6.1</span> Vecteurs atomiques</h3>
<p><strong>Exercice 1.1</strong></p>
<p>À l’aide de <code>seq()</code>, créer un vecteur <code>v</code> contenant tous les nombres pairs entre 10 et 20.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb801-1" title="1">v &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">2</span>)</a></code></pre></div>
</div>

<p>Sélectionner les 3 premières valeurs de <code>v</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb802-1" title="1">v[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb802-2" title="2"><span class="kw">head</span>(v, <span class="dv">3</span>)</a></code></pre></div>
</div>

<p>Sélectionner toutes les valeurs de <code>v</code> strictement inférieures à 5.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb803-1" title="1">v[v <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>]</a></code></pre></div>
</div>

<p>Sélectionner toutes les valeurs de <code>v</code> sauf la dernière.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb804-1" title="1">v[<span class="op">-</span><span class="kw">length</span>(v)]</a>
<a class="sourceLine" id="cb804-2" title="2"><span class="kw">head</span>(v, <span class="dv">-1</span>)</a></code></pre></div>
</div>

<p><strong>Exercice 1.2</strong></p>
<p>Soit le vecteur nommé <code>vn</code> suivant :</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb805-1" title="1">vn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">val1 =</span> <span class="dv">10</span>, <span class="dt">val2 =</span> <span class="dv">0</span>, <span class="dt">val3 =</span> <span class="dv">14</span>)</a></code></pre></div>
<p>Sélectionner les valeurs nommées “val1” et “val3”.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb806-1" title="1">vn[<span class="kw">c</span>(<span class="st">&quot;val1&quot;</span>, <span class="st">&quot;val3&quot;</span>)]</a></code></pre></div>
</div>

<p>Sélectionner toutes les valeurs sauf celle nommée “val3”.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb807-1" title="1">vn[<span class="kw">names</span>(vn) <span class="op">!=</span><span class="st"> &quot;val3&quot;</span>]</a></code></pre></div>
</div>

<p><em>Facultatif :</em> comparer les résultats des deux instructions suivantes.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb808-1" title="1">vn[<span class="st">&quot;val1&quot;</span>]</a>
<a class="sourceLine" id="cb808-2" title="2">vn[[<span class="st">&quot;val1&quot;</span>]]</a></code></pre></div>
<p><strong>Exercice 1.3</strong></p>
<p>Soit les vecteurs <code>x</code> et <code>y</code> suivants :</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb809-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb809-2" title="2">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>)</a></code></pre></div>
<p>À l’aide de l’opérateur <code>[]</code>, sélectionner uniquement les valeurs <code>NA</code> de <code>x</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb810-1" title="1">x[<span class="kw">is.na</span>(x)]</a></code></pre></div>
</div>

<p>De la même manière, sélectionner les valeurs de <code>y</code> correspondant aux valeurs <code>NA</code> de <code>x</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb811-1" title="1">y[<span class="kw">is.na</span>(x)]</a></code></pre></div>
</div>

<p>En utilisant les deux instructions précédentes et l’opérateur d’assignation <code>&lt;-</code>, remplacer les valeurs manquantes de <code>x</code> par les valeurs correspondantes de <code>y</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb812-1" title="1">x[<span class="kw">is.na</span>(x)] &lt;-<span class="st"> </span>y[<span class="kw">is.na</span>(x)]</a></code></pre></div>
</div>

</div>
<div id="listes-1" class="section level3">
<h3><span class="header-section-number">15.6.2</span> Listes</h3>
<p><strong>Exercice 2.1</strong></p>
<p>Créer la liste <code>l</code> ayant la structure suivante :</p>
<pre><code>#&gt; List of 3
#&gt;  $ : num 1
#&gt;  $ : chr &quot;oui&quot;
#&gt;  $ : int [1:3] 10 11 12</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb814-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="st">&quot;oui&quot;</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">12</span>)</a></code></pre></div>
</div>

<p>Donner les noms suivants aux éléments de la liste : <code>num</code>, <code>reponse</code> et <code>vec</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb815-1" title="1"><span class="kw">names</span>(l) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;num&quot;</span>, <span class="st">&quot;reponse&quot;</span>, <span class="st">&quot;vec&quot;</span>)</a></code></pre></div>
</div>

<p>Ajouter un élément nommé <code>chat</code> et ayant pour valeur “Ronron” à la fin de <code>l</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb816-1" title="1">l &lt;-<span class="st"> </span><span class="kw">c</span>(l, <span class="dt">chat =</span> <span class="st">&quot;Ronron&quot;</span>)</a></code></pre></div>
</div>

<p>Modifier l’élément <code>chat</code> pour lui donner la valeur “Ronpchi”.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb817-1" title="1">l<span class="op">$</span>chat &lt;-<span class="st"> &quot;Ronpchi&quot;</span></a></code></pre></div>
</div>

<p>Supprimer l’élément <code>vec</code> de <code>l</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb818-1" title="1">l<span class="op">$</span>vec &lt;-<span class="st"> </span><span class="ot">NULL</span></a></code></pre></div>
</div>

<p>Créer une liste <code>l2</code> avec un seul élément nommé <code>Incroyable élément</code> et comme valeur 42.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb819-1" title="1">l2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">`</span><span class="dt">Incroyable élément</span><span class="st">`</span> =<span class="st"> </span><span class="dv">42</span>)</a></code></pre></div>
</div>

<p>Créer une liste <code>l3</code> en concaténant <code>l</code> et <code>l2</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb820-1" title="1">l3 &lt;-<span class="st"> </span><span class="kw">c</span>(l, l2)</a></code></pre></div>
</div>

<p><strong>Exercice 2.2</strong></p>
<p>Créer une fonction nommée <code>extremes</code> qui prend en argument un vecteur et retourne une liste nommée comportant sa moyenne et sa médiane.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb821-1" title="1">extremes &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb821-2" title="2">    <span class="kw">list</span>(<span class="dt">min =</span> <span class="kw">min</span>(x), <span class="dt">max =</span> <span class="kw">max</span>(x))</a>
<a class="sourceLine" id="cb821-3" title="3">}</a></code></pre></div>
</div>

<p>Appliquer cette fonction à un vecteur de votre choix et utiliser le résultat pour calculer l’étendue (soit la différence entre la valeur maximale et la valeur minimale).</p>

<div class="solution-exo">
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb822-1" title="1">v &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb822-2" title="2">res &lt;-<span class="st"> </span><span class="kw">extremes</span>(v)</a>
<a class="sourceLine" id="cb822-3" title="3">res<span class="op">$</span>max <span class="op">-</span><span class="st"> </span>res<span class="op">$</span>min</a></code></pre></div>
</div>

<p><strong>Exercice 2.3</strong></p>
<p>Soit la liste suivante :</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb823-1" title="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">runif</span>(<span class="dv">5</span>), <span class="st">&quot;youpi&quot;</span>)</a></code></pre></div>
<p>Sélectionner la sous liste composée des éléments 1 et 3 de <code>l</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb824-1" title="1">l[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</a></code></pre></div>
</div>

<p>Sélectionner la sous-liste composée du premier élément de <code>l</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb825-1" title="1">l[<span class="dv">1</span>]</a></code></pre></div>
</div>

<p>Sélectionner le contenu du premier élément de <code>l</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb826-1" title="1">l[[<span class="dv">1</span>]]</a></code></pre></div>
</div>

<p>En enchaînant deux opérations de sélection, sélectionner le deuxième élément du premier élément de <code>l</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb827-1" title="1">l[[<span class="dv">1</span>]][<span class="dv">2</span>]</a></code></pre></div>
</div>

</div>
<div id="data-frame-et-tibble" class="section level3">
<h3><span class="header-section-number">15.6.3</span> <em>data frame</em> et <em>tibble</em></h3>
<p><strong>Exercice 3.1</strong></p>
<p>Construire le tableau <code>d_tib</code> suivant à l’aide de la fonction <em>tibble</em>.</p>
<pre><code>#&gt; # A tibble: 3 × 2
#&gt;   `var 1` `var 2`
#&gt;     &lt;int&gt; &lt;chr&gt;  
#&gt; 1       1 rouge  
#&gt; 2       2 vert   
#&gt; 3       3 rouge</code></pre>
<p>Le convertir en <em>data frame</em> en lui appliquant la fonction <code>data.frame()</code> et stocker le résultat dans un objet <code>d_df</code>. Que constatez-vous si vous comparez <code>d_tib</code> et <code>d_df</code> ?</p>

<div class="solution-exo">
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb829-1" title="1">d_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(d_tib)</a></code></pre></div>
</div>

<p>Sélectionner la colonne <code>var 1</code> de <code>d_tib</code> à l’aide des opérateurs <code>[[]]</code>, <code>$</code>, <code>[,]</code> et <code>[]</code>. Quelles différences constatez-vous ?</p>

<div class="solution-exo">
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb830-1" title="1">d_tib[[<span class="st">&quot;var 1&quot;</span>]]</a>
<a class="sourceLine" id="cb830-2" title="2">d_tib<span class="op">$</span><span class="st">`</span><span class="dt">var 1</span><span class="st">`</span></a>
<a class="sourceLine" id="cb830-3" title="3">d_tib[<span class="st">&quot;var 1&quot;</span>]</a>
<a class="sourceLine" id="cb830-4" title="4">d_tib[, <span class="st">&quot;var 1&quot;</span>]</a></code></pre></div>
</div>

<p>Comparer les résultats de <code>d_tib[, "var 1"]</code> et <code>d_df[, "var.1"]</code>.</p>
<p><strong>Exercice 3.2</strong></p>
<p>Créer le tableau <code>df</code> suivant :</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb831-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb831-2" title="2">    <span class="dt">fruit =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>),</a>
<a class="sourceLine" id="cb831-3" title="3">    <span class="dt">poids =</span> <span class="kw">c</span>(<span class="dv">154</span>, <span class="dv">167</span>, <span class="dv">92</span>),</a>
<a class="sourceLine" id="cb831-4" title="4">    <span class="dt">couleur =</span> <span class="kw">c</span>(<span class="st">&quot;vert&quot;</span>, <span class="st">&quot;vert&quot;</span>, <span class="st">&quot;jaune&quot;</span>)</a>
<a class="sourceLine" id="cb831-5" title="5">)</a></code></pre></div>
<p>À l’aide de l’opérateur <code>[,]</code>, sélectionner :</p>
<ul>
<li>les pommes et les colonnes <code>fruit</code> et <code>couleur</code></li>
<li>les deux dernières lignes</li>
<li>les lignes ayant un poids inférieur à 100 et la première colonne</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb832-1" title="1">df[df<span class="op">$</span>fruit <span class="op">==</span><span class="st"> &quot;Pomme&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;couleur&quot;</span>)]</a>
<a class="sourceLine" id="cb832-2" title="2">df[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, ]</a>
<a class="sourceLine" id="cb832-3" title="3">df[df<span class="op">$</span>poids <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">1</span>]</a></code></pre></div>
</div>

<p>Faire de même en utilisant les verbes de <code>dplyr</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb833-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb833-2" title="2"><span class="st">    </span><span class="kw">filter</span>(fruit <span class="op">==</span><span class="st"> &quot;Pomme&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb833-3" title="3"><span class="st">    </span><span class="kw">select</span>(fruit, couleur)</a>
<a class="sourceLine" id="cb833-4" title="4">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb833-5" title="5"><span class="st">    </span><span class="kw">slice</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb833-6" title="6">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb833-7" title="7"><span class="st">    </span><span class="kw">filter</span>(poids <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb833-8" title="8"><span class="st">    </span><span class="kw">select</span>(<span class="dv">1</span>)</a></code></pre></div>
</div>

<p><strong>Exercice 3.3</strong></p>
<p>Reprendre le tableau <code>df</code> de l’exercice précédent.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb834-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb834-2" title="2">    <span class="dt">fruit =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Citron&quot;</span>),</a>
<a class="sourceLine" id="cb834-3" title="3">    <span class="dt">poids =</span> <span class="kw">c</span>(<span class="dv">154</span>, <span class="dv">167</span>, <span class="dv">92</span>),</a>
<a class="sourceLine" id="cb834-4" title="4">    <span class="dt">couleur =</span> <span class="kw">c</span>(<span class="st">&quot;vert&quot;</span>, <span class="st">&quot;vert&quot;</span>, <span class="st">&quot;jaune&quot;</span>)</a>
<a class="sourceLine" id="cb834-5" title="5">)</a></code></pre></div>
<p>À l’aide de l’opérateur <code>[,]</code>, effectuer les opérations suivantes :</p>
<ul>
<li>Créer une nouvelle colonne <code>id</code> avec les valeurs 1, 2, 3</li>
<li>Remplacer la valeur “jaune” de la variable <code>couleur</code> par “jaune citron”</li>
<li>Créer une nouvelle colonne <code>poids_rec</code> qui vaut “léger” si <code>poids</code> est inférieur à 100, et “lourd” sinon</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb835-1" title="1">df[, <span class="st">&quot;id&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb835-2" title="2">df[df<span class="op">$</span>couleur <span class="op">==</span><span class="st"> &quot;jaune&quot;</span>, <span class="st">&quot;couleur&quot;</span>] &lt;-<span class="st"> &quot;jaune citron&quot;</span></a>
<a class="sourceLine" id="cb835-3" title="3">df[df<span class="op">$</span>poids <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;poids_rec&quot;</span>] &lt;-<span class="st"> &quot;léger&quot;</span></a>
<a class="sourceLine" id="cb835-4" title="4">df[df<span class="op">$</span>poids <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;poids_rec&quot;</span>] &lt;-<span class="st"> &quot;lourd&quot;</span></a>
<a class="sourceLine" id="cb835-5" title="5"><span class="co"># Ou bien :</span></a>
<a class="sourceLine" id="cb835-6" title="6">df[, <span class="st">&quot;poids_rec&quot;</span>] &lt;-<span class="st"> </span><span class="kw">if_else</span>(df<span class="op">$</span>poids <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;léger&quot;</span>, <span class="st">&quot;lourd&quot;</span>)</a></code></pre></div>
</div>

<p>Effectuer les mêmes opérations en utilisant les verbes de <code>dplyr</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb836-1" title="1">df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb836-2" title="2">df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb836-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb836-4" title="4">        <span class="dt">couleur =</span> <span class="kw">if_else</span>(couleur <span class="op">==</span><span class="st"> &quot;jaune&quot;</span>, <span class="st">&quot;jaune_citron&quot;</span>, couleur)</a>
<a class="sourceLine" id="cb836-5" title="5">    )</a>
<a class="sourceLine" id="cb836-6" title="6"><span class="co"># Ou bien :</span></a>
<a class="sourceLine" id="cb836-7" title="7"><span class="kw">library</span>(forcats)</a>
<a class="sourceLine" id="cb836-8" title="8">df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb836-9" title="9"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb836-10" title="10">        <span class="dt">couleur =</span> <span class="kw">fct_recode</span>(couleur, <span class="st">&quot;jaune_citron&quot;</span> =<span class="st"> &quot;jaune&quot;</span>)</a>
<a class="sourceLine" id="cb836-11" title="11">    )</a>
<a class="sourceLine" id="cb836-12" title="12">df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb836-13" title="13"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb836-14" title="14">        <span class="dt">poids_rec =</span> <span class="kw">if_else</span>(poids <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;léger&quot;</span>, <span class="st">&quot;lourd&quot;</span>)</a>
<a class="sourceLine" id="cb836-15" title="15">    )</a></code></pre></div>
</div>

</div>
<div id="if-et-else" class="section level3">
<h3><span class="header-section-number">15.6.4</span> <code>if</code> et <code>else</code></h3>
<p><strong>Exercice 4.1</strong></p>
<p>Écrire une fonction <code>pile_ou_face</code> qui ne prend aucun argument en entrée et qui effectue les actions suivantes :</p>
<ul>
<li>tire un nombre au hasard entre 0 et 1 avec <code>runif(1)</code></li>
<li>si ce nombre est inférieur à 0,5, retourne “pile”</li>
<li>sinon, retourne “face”</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb837-1" title="1">pile_ou_face &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb837-2" title="2">    alea &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb837-3" title="3">    <span class="cf">if</span> (alea <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>) {</a>
<a class="sourceLine" id="cb837-4" title="4">        result &lt;-<span class="st"> &quot;pile&quot;</span></a>
<a class="sourceLine" id="cb837-5" title="5">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb837-6" title="6">        result &lt;-<span class="st"> &quot;face&quot;</span></a>
<a class="sourceLine" id="cb837-7" title="7">    }</a>
<a class="sourceLine" id="cb837-8" title="8">    result</a>
<a class="sourceLine" id="cb837-9" title="9">}</a></code></pre></div>
</div>

<p><strong>Exercice 4.2</strong></p>
<p>Créer une fonction <code>moyenne_arrondie</code>, qui prend en argument un vecteur <code>x</code>, un argument <code>na.rm</code> avec une valeur par défaut à <code>TRUE</code>, et un argument facultatif <code>decimales</code>. La fonction doit effectuer les opérations suivantes :</p>
<ul>
<li>calcule la moyenne du vecteur en tenant compte de l’argument <code>na.rm</code> passé à la fonction</li>
<li>si <code>decimales</code> est défini, on arrondit la moyenne au nombre de décimales correspondant avec la fonction <code>round()</code></li>
<li>retourne la moyenne, arrondie ou non</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb838-1" title="1">moyenne_arrondie &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">decimales =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb838-2" title="2">    moyenne &lt;-<span class="st"> </span><span class="kw">mean</span>(x, <span class="dt">na.rm =</span> na.rm)</a>
<a class="sourceLine" id="cb838-3" title="3">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(decimales)) {</a>
<a class="sourceLine" id="cb838-4" title="4">        moyenne &lt;-<span class="st"> </span><span class="kw">round</span>(moyenne, decimales)</a>
<a class="sourceLine" id="cb838-5" title="5">    }</a>
<a class="sourceLine" id="cb838-6" title="6">    moyenne</a>
<a class="sourceLine" id="cb838-7" title="7">}</a></code></pre></div>
</div>

<p><strong>Exercice 4.3</strong></p>
<p>Écrire une fonction <code>avertissement</code> qui prend deux arguments <code>pluie</code> et <code>parapluie</code>, avec comme valeurs <code>FALSE</code> par défaut, et qui effectue les opérations suivantes :</p>
<ul>
<li>si <code>pluie</code> vaut <code>TRUE</code> et <code>parapluie</code> vaut <code>FALSE</code>, affiche “mouillé”</li>
<li>si <code>pluie</code> vaut <code>TRUE</code> et <code>parapluie</code> vaut <code>TRUE</code>, affiche “bien vu”</li>
<li>si <code>pluie</code> vaut <code>FALSE</code>, affiche “RAS”</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb839-1" title="1">avertissement &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">pluie =</span> <span class="ot">FALSE</span>, <span class="dt">parapluie =</span> <span class="ot">FALSE</span>) {</a>
<a class="sourceLine" id="cb839-2" title="2">    <span class="cf">if</span> (pluie <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span>parapluie) {</a>
<a class="sourceLine" id="cb839-3" title="3">        <span class="kw">message</span>(<span class="st">&quot;mouillé&quot;</span>)</a>
<a class="sourceLine" id="cb839-4" title="4">    }</a>
<a class="sourceLine" id="cb839-5" title="5">    <span class="cf">if</span> (pluie <span class="op">&amp;&amp;</span><span class="st"> </span>parapluie) {</a>
<a class="sourceLine" id="cb839-6" title="6">        <span class="kw">message</span>(<span class="st">&quot;bien vu&quot;</span>)</a>
<a class="sourceLine" id="cb839-7" title="7">    }</a>
<a class="sourceLine" id="cb839-8" title="8">    <span class="cf">if</span> (<span class="op">!</span>pluie) {</a>
<a class="sourceLine" id="cb839-9" title="9">        <span class="kw">message</span>(<span class="st">&quot;RAS&quot;</span>)</a>
<a class="sourceLine" id="cb839-10" title="10">    }</a>
<a class="sourceLine" id="cb839-11" title="11">}</a></code></pre></div>
</div>

<p><strong>Exercice 4.4</strong></p>
<p>Écrire une fonction <code>meteo</code> qui prend un argument nommé <code>temperature</code> et effectue les actions suivantes :</p>
<ul>
<li>si <code>temperature</code> est inférieur à 0, affiche le message “ça caille”</li>
<li>si <code>temperature</code> est compris entre 0 et 15, affiche le message “fais pas chaud”</li>
<li>si <code>temperature</code> est compris entre 15 et 30, affiche le message “on est pas mal”</li>
<li>si <code>temperature</code> est supérieur à 30, affiche le message “tous à Miribel”</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb840-1" title="1">meteo &lt;-<span class="st"> </span><span class="cf">function</span>(temperature) {</a>
<a class="sourceLine" id="cb840-2" title="2">    <span class="cf">if</span> (temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb840-3" title="3">        <span class="kw">message</span>(<span class="st">&quot;ça caille&quot;</span>)</a>
<a class="sourceLine" id="cb840-4" title="4">    } <span class="cf">else</span> <span class="cf">if</span> (temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>) {</a>
<a class="sourceLine" id="cb840-5" title="5">        <span class="kw">message</span>(<span class="st">&quot;fais pas chaud&quot;</span>)</a>
<a class="sourceLine" id="cb840-6" title="6">    } <span class="cf">else</span> <span class="cf">if</span> (temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {</a>
<a class="sourceLine" id="cb840-7" title="7">        <span class="kw">message</span>(<span class="st">&quot;on est pas mal&quot;</span>)</a>
<a class="sourceLine" id="cb840-8" title="8">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb840-9" title="9">        <span class="kw">message</span>(<span class="st">&quot;tous à Mriribel&quot;</span>)</a>
<a class="sourceLine" id="cb840-10" title="10">    }</a>
<a class="sourceLine" id="cb840-11" title="11">}</a>
<a class="sourceLine" id="cb840-12" title="12"><span class="co"># Ou bien</span></a>
<a class="sourceLine" id="cb840-13" title="13">meteo &lt;-<span class="st"> </span><span class="cf">function</span>(temperature) {</a>
<a class="sourceLine" id="cb840-14" title="14">    <span class="cf">if</span> (temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb840-15" title="15">        <span class="kw">message</span>(<span class="st">&quot;ça caille&quot;</span>)</a>
<a class="sourceLine" id="cb840-16" title="16">    } </a>
<a class="sourceLine" id="cb840-17" title="17">    <span class="cf">if</span> (temperature <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>) {</a>
<a class="sourceLine" id="cb840-18" title="18">        <span class="kw">message</span>(<span class="st">&quot;fais pas chaud&quot;</span>)</a>
<a class="sourceLine" id="cb840-19" title="19">    } </a>
<a class="sourceLine" id="cb840-20" title="20">    <span class="cf">if</span> (temperature <span class="op">&gt;=</span><span class="st"> </span><span class="dv">15</span> <span class="op">&amp;&amp;</span><span class="st"> </span>temperature <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {</a>
<a class="sourceLine" id="cb840-21" title="21">        <span class="kw">message</span>(<span class="st">&quot;on est pas mal&quot;</span>)</a>
<a class="sourceLine" id="cb840-22" title="22">    } </a>
<a class="sourceLine" id="cb840-23" title="23">    <span class="cf">if</span> (temperature <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>) {</a>
<a class="sourceLine" id="cb840-24" title="24">        <span class="kw">message</span>(<span class="st">&quot;tous à Mriribel&quot;</span>)</a>
<a class="sourceLine" id="cb840-25" title="25">    }</a>
<a class="sourceLine" id="cb840-26" title="26">}</a></code></pre></div>
</div>

</div>
<div id="contrôle-de-lexécution" class="section level3">
<h3><span class="header-section-number">15.6.5</span> Contrôle de l’exécution</h3>
<p><strong>Exercice 5.1</strong></p>
<p>Créer une fonction <code>etendue</code> qui renvoie la différence entre la plus grande et la plus petite valeur d’un vecteur.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb841-1" title="1">etendue &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb841-2" title="2">    <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</a>
<a class="sourceLine" id="cb841-3" title="3">}</a></code></pre></div>
</div>

<p>Modifier la fonction pour qu’elle retourne <code>NA</code> si le vecteur passé en argument n’est pas numérique.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb842-1" title="1">etendue &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb842-2" title="2">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(x)) {</a>
<a class="sourceLine" id="cb842-3" title="3">        <span class="kw">return</span>(<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb842-4" title="4">    }</a>
<a class="sourceLine" id="cb842-5" title="5">    <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</a>
<a class="sourceLine" id="cb842-6" title="6">}</a></code></pre></div>
</div>

<p>Modifier à nouveau la fonction pour qu’elle affiche un avertissement avant de renvoyer la valeur <code>NA</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb843-1" title="1">etendue &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb843-2" title="2">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(x)) {</a>
<a class="sourceLine" id="cb843-3" title="3">        <span class="kw">warning</span>(<span class="st">&quot;x doit être numérique&quot;</span>)</a>
<a class="sourceLine" id="cb843-4" title="4">        <span class="kw">return</span>(<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb843-5" title="5">    }</a>
<a class="sourceLine" id="cb843-6" title="6">    <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</a>
<a class="sourceLine" id="cb843-7" title="7">}</a></code></pre></div>
</div>

<p><strong>Exercice 5.2</strong></p>
<p>Créer une fonction <code>proportion</code> qui prend en argument un vecteur et retourne les valeurs de ce vecteur divisée par leur somme.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb844-1" title="1">proportion &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb844-2" title="2">    x <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb844-3" title="3">}</a></code></pre></div>
</div>

<p>Essayer d’exécuter <code>proportion(c(-2, 1, 1))</code>. Pourquoi obtient-on ce résultat ?</p>
<p>Modifier la fonction pour qu’elle retourne un message d’erreur si jamais la somme des éléments du vecteur vaut 0.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb845-1" title="1">proportion &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb845-2" title="2">    <span class="cf">if</span> (<span class="kw">sum</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb845-3" title="3">        <span class="kw">stop</span>(<span class="st">&quot;la somme des éléments de x vaut zéro&quot;</span>)</a>
<a class="sourceLine" id="cb845-4" title="4">    }</a>
<a class="sourceLine" id="cb845-5" title="5">    x <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb845-6" title="6">}</a></code></pre></div>
</div>

</div>
<div id="boucles" class="section level3">
<h3><span class="header-section-number">15.6.6</span> Boucles</h3>
<p><strong>Exercice 6.1</strong></p>
<p>Charger le jeu de données <code>hdv2003</code> de l’extension <code>questionr</code> avec :</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb846-1" title="1"><span class="kw">library</span>(questionr)</a>
<a class="sourceLine" id="cb846-2" title="2"><span class="kw">data</span>(hdv2003)</a></code></pre></div>
<p>À l’aide d’une boucle <code>for</code>, parcourir les noms des variables de <code>hdv2003</code>. Si la variable en question est numérique, faire l’histogramme de la variable avec la fonction <code>hist()</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb847-1" title="1"><span class="cf">for</span> (name <span class="cf">in</span> <span class="kw">names</span>(hdv2003)) {</a>
<a class="sourceLine" id="cb847-2" title="2">    variable &lt;-<span class="st"> </span>hdv2003[, name]</a>
<a class="sourceLine" id="cb847-3" title="3">    <span class="cf">if</span> (<span class="kw">is.numeric</span>(variable)) {</a>
<a class="sourceLine" id="cb847-4" title="4">        <span class="kw">hist</span>(variable)</a>
<a class="sourceLine" id="cb847-5" title="5">    }</a>
<a class="sourceLine" id="cb847-6" title="6">}</a></code></pre></div>
</div>

<p>Ajouter le nom de la variable comme titre du graphique en utilisant l’argument <code>main</code> de <code>hist()</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb848-1" title="1"><span class="cf">for</span> (name <span class="cf">in</span> <span class="kw">names</span>(hdv2003)) {</a>
<a class="sourceLine" id="cb848-2" title="2">    variable &lt;-<span class="st"> </span>hdv2003[, name]</a>
<a class="sourceLine" id="cb848-3" title="3">    <span class="cf">if</span> (<span class="kw">is.numeric</span>(variable)) {</a>
<a class="sourceLine" id="cb848-4" title="4">        <span class="kw">hist</span>(variable, <span class="dt">main =</span> name)</a>
<a class="sourceLine" id="cb848-5" title="5">    }</a>
<a class="sourceLine" id="cb848-6" title="6">}</a></code></pre></div>
</div>

<p><strong>Exercice 6.2</strong></p>
<p>La fonction <code>readline()</code> permet de lire une chaîne de caractère saisie au clavier de la manière suivante :</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb849-1" title="1">reponse &lt;-<span class="st"> </span><span class="kw">readline</span>(<span class="st">&quot;Quelle est votre réponse ?&quot;</span>)</a></code></pre></div>
<p>Écrire le code qui effectue les opérations suivantes :</p>
<ul>
<li>Afficher le message “Quel est le plus grand sociologue de tous les temps ?” et demander la réponse à l’utilisateur</li>
<li>Si la réponse saisie est “Tonton Michel”, afficher “Bingo !”</li>
<li>Sinon, afficher “Nope” et poser à nouveau la question</li>
</ul>

<div class="solution-exo">
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb850-1" title="1">reponse &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb850-2" title="2"><span class="cf">while</span> (reponse <span class="op">!=</span><span class="st"> &quot;Tonton Michel&quot;</span>) {</a>
<a class="sourceLine" id="cb850-3" title="3">    reponse &lt;-<span class="st"> </span><span class="kw">readline</span>(<span class="st">&quot;Quel est le plus grand sociologue de tous les temps ?&quot;</span>)</a>
<a class="sourceLine" id="cb850-4" title="4">    <span class="cf">if</span> (reponse <span class="op">==</span><span class="st"> &quot;Tonton Michel&quot;</span>) {</a>
<a class="sourceLine" id="cb850-5" title="5">        <span class="kw">message</span>(<span class="st">&quot;Bingo !&quot;</span>)</a>
<a class="sourceLine" id="cb850-6" title="6">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb850-7" title="7">        <span class="kw">message</span>(<span class="st">&quot;Nope !&quot;</span>)</a>
<a class="sourceLine" id="cb850-8" title="8">    }</a>
<a class="sourceLine" id="cb850-9" title="9">}</a></code></pre></div>
</div>

<p><strong>Exercice 6.3</strong></p>
<p>À l’aide d’une boucle <code>for</code>, écrire une fonction <code>somme_positifs</code> qui prend en argument un vecteur et retourne la somme de tous les nombres positifs qu’il contient.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb851-1" title="1">somme_positifs &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb851-2" title="2">    somme &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb851-3" title="3">    <span class="cf">for</span> (item <span class="cf">in</span> x) {</a>
<a class="sourceLine" id="cb851-4" title="4">        <span class="cf">if</span> (item <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb851-5" title="5">            somme &lt;-<span class="st"> </span>somme <span class="op">+</span><span class="st"> </span>item</a>
<a class="sourceLine" id="cb851-6" title="6">        }</a>
<a class="sourceLine" id="cb851-7" title="7">    }</a>
<a class="sourceLine" id="cb851-8" title="8">    somme</a>
<a class="sourceLine" id="cb851-9" title="9">}</a></code></pre></div>
</div>

<p>Réécrire cette fonction pour qu’elle retourne le même résultat mais sans utiliser de boucle.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb852-1" title="1">somme_positifs &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb852-2" title="2">    <span class="kw">sum</span>(x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb852-3" title="3">}</a></code></pre></div>
</div>

<p><strong>Exercice 6.4</strong></p>
<p>En utilisant une boucle <code>for</code>, créer une fonction <code>somme_premiers_positifs</code> qui prend en argument un vecteur et retourne la somme de tous les nombres positifs qu’il contient en partant du début du vecteur et en s’arrêtant au premier élément négatif (on pourra recopier et modifier la première fonction <code>somme_positifs</code> de l’exercice précédent).</p>

<div class="solution-exo">
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb853-1" title="1">somme_premiers_positifs &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb853-2" title="2">    somme &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb853-3" title="3">    <span class="cf">for</span> (item <span class="cf">in</span> x) {</a>
<a class="sourceLine" id="cb853-4" title="4">        <span class="cf">if</span> (item <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb853-5" title="5">            <span class="cf">break</span></a>
<a class="sourceLine" id="cb853-6" title="6">        }</a>
<a class="sourceLine" id="cb853-7" title="7">        somme &lt;-<span class="st"> </span>somme <span class="op">+</span><span class="st"> </span>item</a>
<a class="sourceLine" id="cb853-8" title="8">    }</a>
<a class="sourceLine" id="cb853-9" title="9">    somme</a>
<a class="sourceLine" id="cb853-10" title="10">}</a></code></pre></div>
</div>

<p><em>Facultatif :</em> réécrire la fonction pour qu’elle retourne le même résultat sans utiliser de boucle <code>for</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb854-1" title="1">somme_premiers_positifs &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb854-2" title="2">    negatifs &lt;-<span class="st"> </span><span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb854-3" title="3">    <span class="cf">if</span> (<span class="kw">length</span>(negatifs) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb854-4" title="4">        <span class="kw">return</span>(<span class="kw">sum</span>(x))</a>
<a class="sourceLine" id="cb854-5" title="5">    }</a>
<a class="sourceLine" id="cb854-6" title="6">    premier_negatif &lt;-<span class="st"> </span><span class="kw">min</span>(negatifs)</a>
<a class="sourceLine" id="cb854-7" title="7">    <span class="kw">sum</span>(<span class="kw">head</span>(x, premier_negatif <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb854-8" title="8">}</a></code></pre></div>
</div>

<p><strong>Exercice 6.5</strong></p>
<p>Soit la fonction <code>pile_ou_face</code> suivante, qui simule un jet de pièce :</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb855-1" title="1">pile_ou_face &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb855-2" title="2">    alea &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb855-3" title="3">    <span class="cf">if</span> (alea <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>) {</a>
<a class="sourceLine" id="cb855-4" title="4">        result &lt;-<span class="st"> &quot;pile&quot;</span></a>
<a class="sourceLine" id="cb855-5" title="5">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb855-6" title="6">        result &lt;-<span class="st"> &quot;face&quot;</span></a>
<a class="sourceLine" id="cb855-7" title="7">    }</a>
<a class="sourceLine" id="cb855-8" title="8">    result</a>
<a class="sourceLine" id="cb855-9" title="9">}</a></code></pre></div>
<p>Modifier cette fonction en utilisant une boucle <code>for</code> pour qu’elle accepte un argument <code>n</code> et retourne un vecteur comprenant le résultat de <code>n</code> tirages.</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb856-1" title="1"><span class="kw">pile_ou_face</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb856-2" title="2"><span class="co">#&gt; [1] &quot;face&quot; &quot;pile&quot; &quot;face&quot; &quot;face&quot;</span></a></code></pre></div>

<div class="solution-exo">
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb857-1" title="1">pile_ou_face &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb857-2" title="2">    tirages &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb857-3" title="3">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(n)) {</a>
<a class="sourceLine" id="cb857-4" title="4">        alea &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb857-5" title="5">        <span class="cf">if</span> (alea <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>) {</a>
<a class="sourceLine" id="cb857-6" title="6">            tirages &lt;-<span class="st"> </span><span class="kw">c</span>(tirages, <span class="st">&quot;pile&quot;</span>)</a>
<a class="sourceLine" id="cb857-7" title="7">        } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb857-8" title="8">            tirages &lt;-<span class="st"> </span><span class="kw">c</span>(tirages, <span class="st">&quot;face&quot;</span>)</a>
<a class="sourceLine" id="cb857-9" title="9">        }</a>
<a class="sourceLine" id="cb857-10" title="10">    }</a>
<a class="sourceLine" id="cb857-11" title="11">    tirages</a>
<a class="sourceLine" id="cb857-12" title="12">}</a></code></pre></div>
</div>

<p>Réécrire la fonction pour qu’elle retourne le même résultat sans utiliser de boucle <code>for</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb858-1" title="1">pile_ou_face &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb858-2" title="2">    alea &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb858-3" title="3">    result &lt;-<span class="st"> </span><span class="kw">if_else</span>(alea <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="st">&quot;pile&quot;</span>, <span class="st">&quot;face&quot;</span>)</a>
<a class="sourceLine" id="cb858-4" title="4">    result</a>
<a class="sourceLine" id="cb858-5" title="5">}</a>
<a class="sourceLine" id="cb858-6" title="6"><span class="co"># Ou bien, encore plus simple</span></a>
<a class="sourceLine" id="cb858-7" title="7">pile_ou_face &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb858-8" title="8">    <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;pile&quot;</span>, <span class="st">&quot;face&quot;</span>), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb858-9" title="9">}</a></code></pre></div>
</div>


</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="28">
<li id="fn28"><p>Il en existe d’autres, comme <code>complex</code> ou <code>raw</code>, mais qui sont moins fréquemment utilisés.<a href="15-programmer.html#fnref28" class="footnote-back">↩</a></p></li>
<li id="fn29"><p>Pour rappel, la fonction <code>runif()</code> renvoit des nombres aléatoires suivant une loi uniforme, par défaut compris entre 0 et 1.<a href="15-programmer.html#fnref29" class="footnote-back">↩</a></p></li>
<li id="fn30"><p>Si on veut ajouter un élément <code>NULL</code> à une liste, il faut utiliser les crochets simples avec la syntaxe <code>l["foo"] &lt;- list(NULL)</code>.<a href="15-programmer.html#fnref30" class="footnote-back">↩</a></p></li>
<li id="fn31"><p>Attention, comme pour les listes, à ne pas utiliser <code>[[]]</code> avec un argument de longueur supérieur à 1, car cela mène soit à des erreurs soit à des résultats contre-intuitifs.<a href="15-programmer.html#fnref31" class="footnote-back">↩</a></p></li>
<li id="fn32"><p>En complément, on verra également dans la section <a href="17-purrr.html#purrr">17</a> d’autres fonctions tirées de l’extension <code>purrr</code> qui permettent d’appliquer une fonction en itérant sur les éléments de plusieurs objets.<a href="15-programmer.html#fnref32" class="footnote-back">↩</a></p></li>
<li id="fn33"><p>L’intérêt de <code>seq_along(x)</code> est notamment qu’elle n’essaie pas d’exécuter le bloc de code si jamais <code>x</code> est de longueur nulle. <em>Cf.</em> des explications supplémentaires dans <a href="https://adv-r.hadley.nz/control-flow.html#common-pitfalls">Advanced R</a><a href="15-programmer.html#fnref33" class="footnote-back">↩</a></p></li>
</ol>
</div>
<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="14-fonctions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="16-dplyr-avance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/juba/tidyverse/blob/master/15-programmer.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["introduction_au_tidyverse.epub", "introduction_au_tidyverse.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

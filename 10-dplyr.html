<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Partie 10 Manipuler les données avec dplyr | Introduction à R et au tidyverse</title>
  <meta name="description" content="Une introduction à R et aux extensions du tidyverse" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Partie 10 Manipuler les données avec dplyr | Introduction à R et au tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Une introduction à R et aux extensions du tidyverse" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Partie 10 Manipuler les données avec dplyr | Introduction à R et au tidyverse" />
  
  <meta name="twitter:description" content="Une introduction à R et aux extensions du tidyverse" />
  

<meta name="author" content="Julien Barnier" />


<meta name="date" content="2021-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="09-recodages.html"/>
<link rel="next" href="11-stringr.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Introduction à R et au <em>tidyverse</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>À propos de ce document</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="01-presentation.html"><a href="01-presentation.html"><i class="fa fa-check"></i><b>1</b> Présentation</a><ul>
<li class="chapter" data-level="1.1" data-path="01-presentation.html"><a href="01-presentation.html#à-propos-de-r"><i class="fa fa-check"></i><b>1.1</b> À propos de R</a></li>
<li class="chapter" data-level="1.2" data-path="01-presentation.html"><a href="01-presentation.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> À propos de RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="01-presentation.html"><a href="01-presentation.html#à-propos-du-tidyverse"><i class="fa fa-check"></i><b>1.3</b> À propos du <em>tidyverse</em></a></li>
<li class="chapter" data-level="1.4" data-path="01-presentation.html"><a href="01-presentation.html#structure-du-document"><i class="fa fa-check"></i><b>1.4</b> Structure du document</a></li>
<li class="chapter" data-level="1.5" data-path="01-presentation.html"><a href="01-presentation.html#prérequis"><i class="fa fa-check"></i><b>1.5</b> Prérequis</a></li>
</ul></li>
<li class="part"><span><b>I Introduction à R</b></span></li>
<li class="chapter" data-level="2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html"><i class="fa fa-check"></i><b>2</b> Prise en main</a><ul>
<li class="chapter" data-level="2.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#la-console"><i class="fa fa-check"></i><b>2.1</b> La console</a><ul>
<li class="chapter" data-level="2.1.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#linvite-de-commandes"><i class="fa fa-check"></i><b>2.1.1</b> L’invite de commandes</a></li>
<li class="chapter" data-level="2.1.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#précisions-concernant-la-saisie-des-commandes"><i class="fa fa-check"></i><b>2.1.2</b> Précisions concernant la saisie des commandes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#objets"><i class="fa fa-check"></i><b>2.2</b> Objets</a><ul>
<li class="chapter" data-level="2.2.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#objets-simples"><i class="fa fa-check"></i><b>2.2.1</b> Objets simples</a></li>
<li class="chapter" data-level="2.2.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#introvecteurs"><i class="fa fa-check"></i><b>2.2.2</b> Vecteurs</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#fonctions"><i class="fa fa-check"></i><b>2.3</b> Fonctions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#principe"><i class="fa fa-check"></i><b>2.3.1</b> Principe</a></li>
<li class="chapter" data-level="2.3.2" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#arguments"><i class="fa fa-check"></i><b>2.3.2</b> Arguments</a></li>
<li class="chapter" data-level="2.3.3" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#aide-sur-une-fonction"><i class="fa fa-check"></i><b>2.3.3</b> Aide sur une fonction</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#regrouper-ses-commandes-dans-des-scripts"><i class="fa fa-check"></i><b>2.4</b> Regrouper ses commandes dans des scripts</a><ul>
<li class="chapter" data-level="2.4.1" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#commentaires"><i class="fa fa-check"></i><b>2.4.1</b> Commentaires</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#packages"><i class="fa fa-check"></i><b>2.5</b> Installer et charger des extensions (<em>packages</em>)</a></li>
<li class="chapter" data-level="2.6" data-path="02-prise_en_main.html"><a href="02-prise_en_main.html#exercices"><i class="fa fa-check"></i><b>2.6</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-premier_travail.html"><a href="03-premier_travail.html"><i class="fa fa-check"></i><b>3</b> Premier travail avec des données</a><ul>
<li class="chapter" data-level="3.1" data-path="03-premier_travail.html"><a href="03-premier_travail.html#jeu-de-données-dexemple"><i class="fa fa-check"></i><b>3.1</b> Jeu de données d’exemple</a></li>
<li class="chapter" data-level="3.2" data-path="03-premier_travail.html"><a href="03-premier_travail.html#tableau-de-données-data-frame"><i class="fa fa-check"></i><b>3.2</b> Tableau de données (<em>data frame</em>)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="03-premier_travail.html"><a href="03-premier_travail.html#structure-du-tableau"><i class="fa fa-check"></i><b>3.2.1</b> Structure du tableau</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-premier_travail.html"><a href="03-premier_travail.html#accéder-aux-variables-dun-tableau"><i class="fa fa-check"></i><b>3.2.2</b> Accéder aux variables d’un tableau</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-premier_travail.html"><a href="03-premier_travail.html#créer-une-nouvelle-variable"><i class="fa fa-check"></i><b>3.2.3</b> Créer une nouvelle variable</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="03-premier_travail.html"><a href="03-premier_travail.html#analyse-univariée"><i class="fa fa-check"></i><b>3.3</b> Analyse univariée</a><ul>
<li class="chapter" data-level="3.3.1" data-path="03-premier_travail.html"><a href="03-premier_travail.html#analyser-une-variable-quantitative"><i class="fa fa-check"></i><b>3.3.1</b> Analyser une variable quantitative</a></li>
<li class="chapter" data-level="3.3.2" data-path="03-premier_travail.html"><a href="03-premier_travail.html#analyser-une-variable-qualitative"><i class="fa fa-check"></i><b>3.3.2</b> Analyser une variable qualitative</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="03-premier_travail.html"><a href="03-premier_travail.html#exercices-1"><i class="fa fa-check"></i><b>3.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-bivarie.html"><a href="04-bivarie.html"><i class="fa fa-check"></i><b>4</b> Analyse bivariée</a><ul>
<li class="chapter" data-level="4.1" data-path="04-bivarie.html"><a href="04-bivarie.html#croisement-de-deux-variables-qualitatives"><i class="fa fa-check"></i><b>4.1</b> Croisement de deux variables qualitatives</a><ul>
<li class="chapter" data-level="4.1.1" data-path="04-bivarie.html"><a href="04-bivarie.html#tableaux-croisés"><i class="fa fa-check"></i><b>4.1.1</b> Tableaux croisés</a></li>
<li class="chapter" data-level="4.1.2" data-path="04-bivarie.html"><a href="04-bivarie.html#test-du-χ²"><i class="fa fa-check"></i><b>4.1.2</b> Test du χ²</a></li>
<li class="chapter" data-level="4.1.3" data-path="04-bivarie.html"><a href="04-bivarie.html#représentation-graphique-1"><i class="fa fa-check"></i><b>4.1.3</b> Représentation graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="04-bivarie.html"><a href="04-bivarie.html#croisement-dune-variable-quantitative-et-dune-variable-qualitative"><i class="fa fa-check"></i><b>4.2</b> Croisement d’une variable quantitative et d’une variable qualitative</a><ul>
<li class="chapter" data-level="4.2.1" data-path="04-bivarie.html"><a href="04-bivarie.html#représentation-graphique-2"><i class="fa fa-check"></i><b>4.2.1</b> Représentation graphique</a></li>
<li class="chapter" data-level="4.2.2" data-path="04-bivarie.html"><a href="04-bivarie.html#tapply"><i class="fa fa-check"></i><b>4.2.2</b> Calculs d’indicateurs</a></li>
<li class="chapter" data-level="4.2.3" data-path="04-bivarie.html"><a href="04-bivarie.html#tests-statistiques"><i class="fa fa-check"></i><b>4.2.3</b> Tests statistiques</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="04-bivarie.html"><a href="04-bivarie.html#croisement-de-deux-variables-quantitatives"><i class="fa fa-check"></i><b>4.3</b> Croisement de deux variables quantitatives</a><ul>
<li class="chapter" data-level="4.3.1" data-path="04-bivarie.html"><a href="04-bivarie.html#représentation-graphique-3"><i class="fa fa-check"></i><b>4.3.1</b> Représentation graphique</a></li>
<li class="chapter" data-level="4.3.2" data-path="04-bivarie.html"><a href="04-bivarie.html#calcul-dindicateurs"><i class="fa fa-check"></i><b>4.3.2</b> Calcul d’indicateurs</a></li>
<li class="chapter" data-level="4.3.3" data-path="04-bivarie.html"><a href="04-bivarie.html#régression-linéaire"><i class="fa fa-check"></i><b>4.3.3</b> Régression linéaire</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="04-bivarie.html"><a href="04-bivarie.html#exercices-2"><i class="fa fa-check"></i><b>4.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-organiser.html"><a href="05-organiser.html"><i class="fa fa-check"></i><b>5</b> Organiser ses scripts</a><ul>
<li class="chapter" data-level="5.1" data-path="05-organiser.html"><a href="05-organiser.html#projets"><i class="fa fa-check"></i><b>5.1</b> Les projets dans RStudio</a></li>
<li class="chapter" data-level="5.2" data-path="05-organiser.html"><a href="05-organiser.html#créer-des-sections-dans-un-script"><i class="fa fa-check"></i><b>5.2</b> Créer des sections dans un script</a></li>
<li class="chapter" data-level="5.3" data-path="05-organiser.html"><a href="05-organiser.html#répartir-son-travail-entre-plusieurs-scripts"><i class="fa fa-check"></i><b>5.3</b> Répartir son travail entre plusieurs scripts</a></li>
<li class="chapter" data-level="5.4" data-path="05-organiser.html"><a href="05-organiser.html#désactiver-la-sauvegarde-de-lespace-de-travail"><i class="fa fa-check"></i><b>5.4</b> Désactiver la sauvegarde de l’espace de travail</a></li>
</ul></li>
<li class="part"><span><b>II Introduction au tidyverse</b></span></li>
<li class="chapter" data-level="6" data-path="06-tidyverse.html"><a href="06-tidyverse.html"><i class="fa fa-check"></i><b>6</b> Le tidyverse</a><ul>
<li class="chapter" data-level="6.1" data-path="06-tidyverse.html"><a href="06-tidyverse.html#extensions"><i class="fa fa-check"></i><b>6.1</b> Extensions</a></li>
<li class="chapter" data-level="6.2" data-path="06-tidyverse.html"><a href="06-tidyverse.html#installation"><i class="fa fa-check"></i><b>6.2</b> Installation</a></li>
<li class="chapter" data-level="6.3" data-path="06-tidyverse.html"><a href="06-tidyverse.html#tidydata"><i class="fa fa-check"></i><b>6.3</b> tidy data</a></li>
<li class="chapter" data-level="6.4" data-path="06-tidyverse.html"><a href="06-tidyverse.html#tibbles"><i class="fa fa-check"></i><b>6.4</b> tibbles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-import.html"><a href="07-import.html"><i class="fa fa-check"></i><b>7</b> Importer et exporter des données</a><ul>
<li class="chapter" data-level="7.1" data-path="07-import.html"><a href="07-import.html#import-de-fichiers-textes"><i class="fa fa-check"></i><b>7.1</b> Import de fichiers textes</a><ul>
<li class="chapter" data-level="7.1.1" data-path="07-import.html"><a href="07-import.html#interface-interactive-dimport-de-fichiers"><i class="fa fa-check"></i><b>7.1.1</b> Interface interactive d’import de fichiers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="07-import.html"><a href="07-import.html#import-depuis-un-fichier-excel"><i class="fa fa-check"></i><b>7.2</b> Import depuis un fichier Excel</a></li>
<li class="chapter" data-level="7.3" data-path="07-import.html"><a href="07-import.html#import-de-fichiers-sas-spss-et-stata"><i class="fa fa-check"></i><b>7.3</b> Import de fichiers SAS, SPSS et Stata</a></li>
<li class="chapter" data-level="7.4" data-path="07-import.html"><a href="07-import.html#import-de-fichiers-dbase"><i class="fa fa-check"></i><b>7.4</b> Import de fichiers dBase</a></li>
<li class="chapter" data-level="7.5" data-path="07-import.html"><a href="07-import.html#connexion-à-des-bases-de-données"><i class="fa fa-check"></i><b>7.5</b> Connexion à des bases de données</a><ul>
<li class="chapter" data-level="7.5.1" data-path="07-import.html"><a href="07-import.html#interfaçage-via-lextension-dbi"><i class="fa fa-check"></i><b>7.5.1</b> Interfaçage via l’extension <code>DBI</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="07-import.html"><a href="07-import.html#utilisation-de-dplyr-et-dbplyr"><i class="fa fa-check"></i><b>7.5.2</b> Utilisation de <code>dplyr</code> et <code>dbplyr</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="07-import.html"><a href="07-import.html#ressources"><i class="fa fa-check"></i><b>7.5.3</b> Ressources</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="07-import.html"><a href="07-import.html#export-de-données"><i class="fa fa-check"></i><b>7.6</b> Export de données</a><ul>
<li class="chapter" data-level="7.6.1" data-path="07-import.html"><a href="07-import.html#export-de-tableaux-de-données"><i class="fa fa-check"></i><b>7.6.1</b> Export de tableaux de données</a></li>
<li class="chapter" data-level="7.6.2" data-path="07-import.html"><a href="07-import.html#sauvegarder-des-objets"><i class="fa fa-check"></i><b>7.6.2</b> Sauvegarder des objets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-ggplot2.html"><a href="08-ggplot2.html"><i class="fa fa-check"></i><b>8</b> Visualiser avec <code>ggplot2</code></a><ul>
<li class="chapter" data-level="8.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#préparation"><i class="fa fa-check"></i><b>8.1</b> Préparation</a></li>
<li class="chapter" data-level="8.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#initialisation"><i class="fa fa-check"></i><b>8.2</b> Initialisation</a></li>
<li class="chapter" data-level="8.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#exemples-de-geom"><i class="fa fa-check"></i><b>8.3</b> Exemples de <code>geom</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_boxplot"><i class="fa fa-check"></i><b>8.3.1</b> <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="8.3.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_violin"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_violin</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_bar"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_bar</code></a></li>
<li class="chapter" data-level="8.3.4" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_text"><i class="fa fa-check"></i><b>8.3.4</b> <code>geom_text</code></a></li>
<li class="chapter" data-level="8.3.5" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_label"><i class="fa fa-check"></i><b>8.3.5</b> <code>geom_label</code></a></li>
<li class="chapter" data-level="8.3.6" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_density"><i class="fa fa-check"></i><b>8.3.6</b> <code>geom_density</code></a></li>
<li class="chapter" data-level="8.3.7" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_line"><i class="fa fa-check"></i><b>8.3.7</b> <code>geom_line</code></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="08-ggplot2.html"><a href="08-ggplot2.html#mappages"><i class="fa fa-check"></i><b>8.4</b> Mappages</a><ul>
<li class="chapter" data-level="8.4.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#exemples-de-mappages"><i class="fa fa-check"></i><b>8.4.1</b> Exemples de mappages</a></li>
<li class="chapter" data-level="8.4.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#aes-or-not-aes"><i class="fa fa-check"></i><b>8.4.2</b> <code>aes()</code> or not <code>aes()</code> ?</a></li>
<li class="chapter" data-level="8.4.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#geom_bar-et-position"><i class="fa fa-check"></i><b>8.4.3</b> <code>geom_bar</code> et <code>position</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="08-ggplot2.html"><a href="08-ggplot2.html#représentation-de-plusieurs-geom"><i class="fa fa-check"></i><b>8.5</b> Représentation de plusieurs <code>geom</code></a><ul>
<li class="chapter" data-level="8.5.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#plusieurs-sources-de-données"><i class="fa fa-check"></i><b>8.5.1</b> Plusieurs sources de données</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="08-ggplot2.html"><a href="08-ggplot2.html#faceting"><i class="fa fa-check"></i><b>8.6</b> Faceting</a></li>
<li class="chapter" data-level="8.7" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scales"><i class="fa fa-check"></i><b>8.7</b> Scales</a><ul>
<li class="chapter" data-level="8.7.1" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scale_size"><i class="fa fa-check"></i><b>8.7.1</b> <code>scale_size</code></a></li>
<li class="chapter" data-level="8.7.2" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scale_x-scale_y"><i class="fa fa-check"></i><b>8.7.2</b> <code>scale_x</code>, <code>scale_y</code></a></li>
<li class="chapter" data-level="8.7.3" data-path="08-ggplot2.html"><a href="08-ggplot2.html#scalecolor"><i class="fa fa-check"></i><b>8.7.3</b> <code>scale_color</code>, <code>scale_fill</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="08-ggplot2.html"><a href="08-ggplot2.html#thèmes"><i class="fa fa-check"></i><b>8.8</b> Thèmes</a></li>
<li class="chapter" data-level="8.9" data-path="08-ggplot2.html"><a href="08-ggplot2.html#ladd-in-esquisse"><i class="fa fa-check"></i><b>8.9</b> L’add-in <code>esquisse</code></a></li>
<li class="chapter" data-level="8.10" data-path="08-ggplot2.html"><a href="08-ggplot2.html#ressources-1"><i class="fa fa-check"></i><b>8.10</b> Ressources</a></li>
<li class="chapter" data-level="8.11" data-path="08-ggplot2.html"><a href="08-ggplot2.html#exercices-3"><i class="fa fa-check"></i><b>8.11</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-recodages.html"><a href="09-recodages.html"><i class="fa fa-check"></i><b>9</b> Recoder des variables</a><ul>
<li class="chapter" data-level="9.1" data-path="09-recodages.html"><a href="09-recodages.html#vecteurs"><i class="fa fa-check"></i><b>9.1</b> Rappel sur les variables et les vecteurs</a></li>
<li class="chapter" data-level="9.2" data-path="09-recodages.html"><a href="09-recodages.html#tests"><i class="fa fa-check"></i><b>9.2</b> Tests et comparaison</a></li>
<li class="chapter" data-level="9.3" data-path="09-recodages.html"><a href="09-recodages.html#recoder-une-variable-qualitative"><i class="fa fa-check"></i><b>9.3</b> Recoder une variable qualitative</a><ul>
<li class="chapter" data-level="9.3.1" data-path="09-recodages.html"><a href="09-recodages.html#facteurs"><i class="fa fa-check"></i><b>9.3.1</b> Facteurs et <code>forcats</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="09-recodages.html"><a href="09-recodages.html#recode"><i class="fa fa-check"></i><b>9.3.2</b> Modifier les modalités d’une variable qualitative</a></li>
<li class="chapter" data-level="9.3.3" data-path="09-recodages.html"><a href="09-recodages.html#ordonner-les-modalités-dune-variable-qualitative"><i class="fa fa-check"></i><b>9.3.3</b> Ordonner les modalités d’une variable qualitative</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="09-recodages.html"><a href="09-recodages.html#combiner-plusieurs-variables"><i class="fa fa-check"></i><b>9.4</b> Combiner plusieurs variables</a><ul>
<li class="chapter" data-level="9.4.1" data-path="09-recodages.html"><a href="09-recodages.html#if-else"><i class="fa fa-check"></i><b>9.4.1</b> <code>if_else</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="09-recodages.html"><a href="09-recodages.html#case_when"><i class="fa fa-check"></i><b>9.4.2</b> <code>case_when</code></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="09-recodages.html"><a href="09-recodages.html#découper-une-variable-numérique-en-classes"><i class="fa fa-check"></i><b>9.5</b> Découper une variable numérique en classes</a><ul>
<li class="chapter" data-level="9.5.1" data-path="09-recodages.html"><a href="09-recodages.html#interface-graphique"><i class="fa fa-check"></i><b>9.5.1</b> Interface graphique</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="09-recodages.html"><a href="09-recodages.html#exercices-4"><i class="fa fa-check"></i><b>9.6</b> Exercices</a><ul>
<li class="chapter" data-level="9.6.1" data-path="09-recodages.html"><a href="09-recodages.html#préparation-1"><i class="fa fa-check"></i><b>9.6.1</b> Préparation</a></li>
<li class="chapter" data-level="9.6.2" data-path="09-recodages.html"><a href="09-recodages.html#vecteurs-et-tests"><i class="fa fa-check"></i><b>9.6.2</b> Vecteurs et tests</a></li>
<li class="chapter" data-level="9.6.3" data-path="09-recodages.html"><a href="09-recodages.html#recodages-de-variable-qualitative"><i class="fa fa-check"></i><b>9.6.3</b> Recodages de variable qualitative</a></li>
<li class="chapter" data-level="9.6.4" data-path="09-recodages.html"><a href="09-recodages.html#combiner-plusieurs-variables-1"><i class="fa fa-check"></i><b>9.6.4</b> Combiner plusieurs variables</a></li>
<li class="chapter" data-level="9.6.5" data-path="09-recodages.html"><a href="09-recodages.html#découper-une-variable-numérique"><i class="fa fa-check"></i><b>9.6.5</b> Découper une variable numérique</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-dplyr.html"><a href="10-dplyr.html"><i class="fa fa-check"></i><b>10</b> Manipuler les données avec <code>dplyr</code></a><ul>
<li class="chapter" data-level="10.1" data-path="10-dplyr.html"><a href="10-dplyr.html#préparation-2"><i class="fa fa-check"></i><b>10.1</b> Préparation</a></li>
<li class="chapter" data-level="10.2" data-path="10-dplyr.html"><a href="10-dplyr.html#les-verbes-de-dplyr"><i class="fa fa-check"></i><b>10.2</b> Les verbes de <code>dplyr</code></a><ul>
<li class="chapter" data-level="10.2.1" data-path="10-dplyr.html"><a href="10-dplyr.html#slice"><i class="fa fa-check"></i><b>10.2.1</b> <code>slice</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="10-dplyr.html"><a href="10-dplyr.html#filter"><i class="fa fa-check"></i><b>10.2.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="10-dplyr.html"><a href="10-dplyr.html#select-rename"><i class="fa fa-check"></i><b>10.2.3</b> <code>select</code> et <code>rename</code></a></li>
<li class="chapter" data-level="10.2.4" data-path="10-dplyr.html"><a href="10-dplyr.html#arrange"><i class="fa fa-check"></i><b>10.2.4</b> <code>arrange</code></a></li>
<li class="chapter" data-level="10.2.5" data-path="10-dplyr.html"><a href="10-dplyr.html#mutate"><i class="fa fa-check"></i><b>10.2.5</b> <code>mutate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-dplyr.html"><a href="10-dplyr.html#pipe"><i class="fa fa-check"></i><b>10.3</b> Enchaîner les opérations avec le <em>pipe</em></a></li>
<li class="chapter" data-level="10.4" data-path="10-dplyr.html"><a href="10-dplyr.html#opérations-groupées"><i class="fa fa-check"></i><b>10.4</b> Opérations groupées</a><ul>
<li class="chapter" data-level="10.4.1" data-path="10-dplyr.html"><a href="10-dplyr.html#group_by"><i class="fa fa-check"></i><b>10.4.1</b> <code>group_by</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="10-dplyr.html"><a href="10-dplyr.html#summarise-et-count"><i class="fa fa-check"></i><b>10.4.2</b> <code>summarise</code> et <code>count</code></a></li>
<li class="chapter" data-level="10.4.3" data-path="10-dplyr.html"><a href="10-dplyr.html#grouper-selon-plusieurs-variables"><i class="fa fa-check"></i><b>10.4.3</b> Grouper selon plusieurs variables</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="10-dplyr.html"><a href="10-dplyr.html#autres-fonctions-utiles"><i class="fa fa-check"></i><b>10.5</b> Autres fonctions utiles</a><ul>
<li class="chapter" data-level="10.5.1" data-path="10-dplyr.html"><a href="10-dplyr.html#slice_sample"><i class="fa fa-check"></i><b>10.5.1</b> <code>slice_sample</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="10-dplyr.html"><a href="10-dplyr.html#slice_head-slice_tail-slice_min-slice_max"><i class="fa fa-check"></i><b>10.5.2</b> <code>slice_head</code>, <code>slice_tail</code>, <code>slice_min</code>, <code>slice_max</code></a></li>
<li class="chapter" data-level="10.5.3" data-path="10-dplyr.html"><a href="10-dplyr.html#lead-et-lag"><i class="fa fa-check"></i><b>10.5.3</b> <code>lead</code> et <code>lag</code></a></li>
<li class="chapter" data-level="10.5.4" data-path="10-dplyr.html"><a href="10-dplyr.html#distinct-et-n_distinct"><i class="fa fa-check"></i><b>10.5.4</b> <code>distinct</code> et <code>n_distinct</code></a></li>
<li class="chapter" data-level="10.5.5" data-path="10-dplyr.html"><a href="10-dplyr.html#relocate"><i class="fa fa-check"></i><b>10.5.5</b> <code>relocate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="10-dplyr.html"><a href="10-dplyr.html#tables-multiples"><i class="fa fa-check"></i><b>10.6</b> Tables multiples</a><ul>
<li class="chapter" data-level="10.6.1" data-path="10-dplyr.html"><a href="10-dplyr.html#concaténation-bind_rows-et-bind_cols"><i class="fa fa-check"></i><b>10.6.1</b> Concaténation : <code>bind_rows</code> et <code>bind_cols</code></a></li>
<li class="chapter" data-level="10.6.2" data-path="10-dplyr.html"><a href="10-dplyr.html#jointures"><i class="fa fa-check"></i><b>10.6.2</b> Jointures</a></li>
<li class="chapter" data-level="10.6.3" data-path="10-dplyr.html"><a href="10-dplyr.html#types-de-jointures"><i class="fa fa-check"></i><b>10.6.3</b> Types de jointures</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="10-dplyr.html"><a href="10-dplyr.html#ressources-2"><i class="fa fa-check"></i><b>10.7</b> Ressources</a></li>
<li class="chapter" data-level="10.8" data-path="10-dplyr.html"><a href="10-dplyr.html#exercices-5"><i class="fa fa-check"></i><b>10.8</b> Exercices</a><ul>
<li class="chapter" data-level="10.8.1" data-path="10-dplyr.html"><a href="10-dplyr.html#les-verbes-de-base-de-dplyr"><i class="fa fa-check"></i><b>10.8.1</b> Les verbes de base de <code>dplyr</code></a></li>
<li class="chapter" data-level="10.8.2" data-path="10-dplyr.html"><a href="10-dplyr.html#enchaîner-des-opérations"><i class="fa fa-check"></i><b>10.8.2</b> Enchaîner des opérations</a></li>
<li class="chapter" data-level="10.8.3" data-path="10-dplyr.html"><a href="10-dplyr.html#group_by-et-summarise"><i class="fa fa-check"></i><b>10.8.3</b> <code>group_by</code> et <code>summarise</code></a></li>
<li class="chapter" data-level="10.8.4" data-path="10-dplyr.html"><a href="10-dplyr.html#jointures-1"><i class="fa fa-check"></i><b>10.8.4</b> Jointures</a></li>
<li class="chapter" data-level="10.8.5" data-path="10-dplyr.html"><a href="10-dplyr.html#bonus"><i class="fa fa-check"></i><b>10.8.5</b> Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-stringr.html"><a href="11-stringr.html"><i class="fa fa-check"></i><b>11</b> Manipuler du texte avec <code>stringr</code></a><ul>
<li class="chapter" data-level="11.1" data-path="11-stringr.html"><a href="11-stringr.html#expressions-régulières"><i class="fa fa-check"></i><b>11.1</b> Expressions régulières</a></li>
<li class="chapter" data-level="11.2" data-path="11-stringr.html"><a href="11-stringr.html#concat"><i class="fa fa-check"></i><b>11.2</b> Concaténer des chaînes</a></li>
<li class="chapter" data-level="11.3" data-path="11-stringr.html"><a href="11-stringr.html#convertir-en-majuscules-minuscules"><i class="fa fa-check"></i><b>11.3</b> Convertir en majuscules / minuscules</a></li>
<li class="chapter" data-level="11.4" data-path="11-stringr.html"><a href="11-stringr.html#découper-des-chaînes"><i class="fa fa-check"></i><b>11.4</b> Découper des chaînes</a></li>
<li class="chapter" data-level="11.5" data-path="11-stringr.html"><a href="11-stringr.html#extraire-des-sous-chaînes-par-position"><i class="fa fa-check"></i><b>11.5</b> Extraire des sous-chaînes par position</a></li>
<li class="chapter" data-level="11.6" data-path="11-stringr.html"><a href="11-stringr.html#str-detect"><i class="fa fa-check"></i><b>11.6</b> Détecter des motifs</a></li>
<li class="chapter" data-level="11.7" data-path="11-stringr.html"><a href="11-stringr.html#extraire-des-motifs"><i class="fa fa-check"></i><b>11.7</b> Extraire des motifs</a></li>
<li class="chapter" data-level="11.8" data-path="11-stringr.html"><a href="11-stringr.html#remplacer-des-motifs"><i class="fa fa-check"></i><b>11.8</b> Remplacer des motifs</a></li>
<li class="chapter" data-level="11.9" data-path="11-stringr.html"><a href="11-stringr.html#modificateurs"><i class="fa fa-check"></i><b>11.9</b> Modificateurs de motifs</a></li>
<li class="chapter" data-level="11.10" data-path="11-stringr.html"><a href="11-stringr.html#ressources-3"><i class="fa fa-check"></i><b>11.10</b> Ressources</a></li>
<li class="chapter" data-level="11.11" data-path="11-stringr.html"><a href="11-stringr.html#exercices-6"><i class="fa fa-check"></i><b>11.11</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-tidyr.html"><a href="12-tidyr.html"><i class="fa fa-check"></i><b>12</b> Mettre en ordre avec <code>tidyr</code></a><ul>
<li class="chapter" data-level="12.1" data-path="12-tidyr.html"><a href="12-tidyr.html#tidy-data"><i class="fa fa-check"></i><b>12.1</b> Tidy data</a></li>
<li class="chapter" data-level="12.2" data-path="12-tidyr.html"><a href="12-tidyr.html#trois-règles-pour-des-données-bien-rangées"><i class="fa fa-check"></i><b>12.2</b> Trois règles pour des données bien rangées</a></li>
<li class="chapter" data-level="12.3" data-path="12-tidyr.html"><a href="12-tidyr.html#les-verbes-de-tidyr"><i class="fa fa-check"></i><b>12.3</b> Les verbes de <code>tidyr</code></a><ul>
<li class="chapter" data-level="12.3.1" data-path="12-tidyr.html"><a href="12-tidyr.html#pivot_longer-transformer-des-colonnes-en-lignes"><i class="fa fa-check"></i><b>12.3.1</b> <code>pivot_longer</code> : transformer des colonnes en lignes</a></li>
<li class="chapter" data-level="12.3.2" data-path="12-tidyr.html"><a href="12-tidyr.html#pivot_wider-transformer-des-lignes-en-colonnes"><i class="fa fa-check"></i><b>12.3.2</b> <code>pivot_wider</code> : transformer des lignes en colonnes</a></li>
<li class="chapter" data-level="12.3.3" data-path="12-tidyr.html"><a href="12-tidyr.html#separate"><i class="fa fa-check"></i><b>12.3.3</b> <code>separate</code> : séparer une colonne en plusieurs colonnes</a></li>
<li class="chapter" data-level="12.3.4" data-path="12-tidyr.html"><a href="12-tidyr.html#separate-rows"><i class="fa fa-check"></i><b>12.3.4</b> <code>separate_rows</code> : séparer une colonne en plusieurs lignes</a></li>
<li class="chapter" data-level="12.3.5" data-path="12-tidyr.html"><a href="12-tidyr.html#unite-regrouper-plusieurs-colonnes-en-une-seule"><i class="fa fa-check"></i><b>12.3.5</b> <code>unite</code> : regrouper plusieurs colonnes en une seule</a></li>
<li class="chapter" data-level="12.3.6" data-path="12-tidyr.html"><a href="12-tidyr.html#extract"><i class="fa fa-check"></i><b>12.3.6</b> <code>extract</code> : créer de nouvelles colonnes à partir d’une colonne de texte</a></li>
<li class="chapter" data-level="12.3.7" data-path="12-tidyr.html"><a href="12-tidyr.html#complete-compléter-des-combinaisons-de-variables-manquantes"><i class="fa fa-check"></i><b>12.3.7</b> <code>complete</code> : compléter des combinaisons de variables manquantes</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="12-tidyr.html"><a href="12-tidyr.html#ressources-4"><i class="fa fa-check"></i><b>12.4</b> Ressources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html"><i class="fa fa-check"></i><b>13</b> Diffuser et publier avec <code>rmarkdown</code></a><ul>
<li class="chapter" data-level="13.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#créer-un-nouveau-document"><i class="fa fa-check"></i><b>13.1</b> Créer un nouveau document</a></li>
<li class="chapter" data-level="13.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#éléments-dun-document-r-markdown"><i class="fa fa-check"></i><b>13.2</b> Éléments d’un document R Markdown</a><ul>
<li class="chapter" data-level="13.2.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#en-tête-préambule"><i class="fa fa-check"></i><b>13.2.1</b> En-tête (préambule)</a></li>
<li class="chapter" data-level="13.2.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#texte-du-document"><i class="fa fa-check"></i><b>13.2.2</b> Texte du document</a></li>
<li class="chapter" data-level="13.2.3" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#blocs-de-code-r"><i class="fa fa-check"></i><b>13.2.3</b> Blocs de code R</a></li>
<li class="chapter" data-level="13.2.4" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#compiler-un-document-knit"><i class="fa fa-check"></i><b>13.2.4</b> Compiler un document (<em>Knit</em>)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#personnaliser-le-document-généré"><i class="fa fa-check"></i><b>13.3</b> Personnaliser le document généré</a></li>
<li class="chapter" data-level="13.4" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#options-des-blocs-de-code-r"><i class="fa fa-check"></i><b>13.4</b> Options des blocs de code R</a><ul>
<li class="chapter" data-level="13.4.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#nom-du-bloc"><i class="fa fa-check"></i><b>13.4.1</b> Nom du bloc</a></li>
<li class="chapter" data-level="13.4.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#options"><i class="fa fa-check"></i><b>13.4.2</b> Options</a></li>
<li class="chapter" data-level="13.4.3" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#modifier-les-options"><i class="fa fa-check"></i><b>13.4.3</b> Modifier les options</a></li>
<li class="chapter" data-level="13.4.4" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#options-globales"><i class="fa fa-check"></i><b>13.4.4</b> Options globales</a></li>
<li class="chapter" data-level="13.4.5" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#mise-en-cache-des-résultats"><i class="fa fa-check"></i><b>13.4.5</b> Mise en cache des résultats</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#rendu-des-tableaux"><i class="fa fa-check"></i><b>13.5</b> Rendu des tableaux</a><ul>
<li class="chapter" data-level="13.5.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#tableaux-croisés-1"><i class="fa fa-check"></i><b>13.5.1</b> Tableaux croisés</a></li>
<li class="chapter" data-level="13.5.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#tableaux-de-données-et-tris-à-plat"><i class="fa fa-check"></i><b>13.5.2</b> Tableaux de données et tris à plat</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#templates"><i class="fa fa-check"></i><b>13.6</b> Modèles de documents</a><ul>
<li class="chapter" data-level="13.6.1" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#slides"><i class="fa fa-check"></i><b>13.6.1</b> Slides</a></li>
<li class="chapter" data-level="13.6.2" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#templates-1"><i class="fa fa-check"></i><b>13.6.2</b> Templates</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="13-rmarkdown.html"><a href="13-rmarkdown.html#ressources-5"><i class="fa fa-check"></i><b>13.7</b> Ressources</a></li>
</ul></li>
<li class="part"><span><b>III Aller plus loin</b></span></li>
<li class="chapter" data-level="14" data-path="14-fonctions.html"><a href="14-fonctions.html"><i class="fa fa-check"></i><b>14</b> Écrire ses propres fonctions</a><ul>
<li class="chapter" data-level="14.1" data-path="14-fonctions.html"><a href="14-fonctions.html#introduction-et-exemples"><i class="fa fa-check"></i><b>14.1</b> Introduction et exemples</a><ul>
<li class="chapter" data-level="14.1.1" data-path="14-fonctions.html"><a href="14-fonctions.html#structure-dune-fonction"><i class="fa fa-check"></i><b>14.1.1</b> Structure d’une fonction</a></li>
<li class="chapter" data-level="14.1.2" data-path="14-fonctions.html"><a href="14-fonctions.html#exemple-de-fonction"><i class="fa fa-check"></i><b>14.1.2</b> Exemple de fonction</a></li>
<li class="chapter" data-level="14.1.3" data-path="14-fonctions.html"><a href="14-fonctions.html#effets-de-bord-et-affichage-de-messages"><i class="fa fa-check"></i><b>14.1.3</b> Effets de bord et affichage de messages</a></li>
<li class="chapter" data-level="14.1.4" data-path="14-fonctions.html"><a href="14-fonctions.html#utilité-des-fonctions"><i class="fa fa-check"></i><b>14.1.4</b> Utilité des fonctions</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="14-fonctions.html"><a href="14-fonctions.html#arguments-et-résultat-dune-fonction"><i class="fa fa-check"></i><b>14.2</b> Arguments et résultat d’une fonction</a><ul>
<li class="chapter" data-level="14.2.1" data-path="14-fonctions.html"><a href="14-fonctions.html#définition-des-arguments"><i class="fa fa-check"></i><b>14.2.1</b> Définition des arguments</a></li>
<li class="chapter" data-level="14.2.2" data-path="14-fonctions.html"><a href="14-fonctions.html#valeurs-par-défaut"><i class="fa fa-check"></i><b>14.2.2</b> Valeurs par défaut</a></li>
<li class="chapter" data-level="14.2.3" data-path="14-fonctions.html"><a href="14-fonctions.html#arg-oblig"><i class="fa fa-check"></i><b>14.2.3</b> Arguments obligatoires et arguments facultatifs</a></li>
<li class="chapter" data-level="14.2.4" data-path="14-fonctions.html"><a href="14-fonctions.html#largument-..."><i class="fa fa-check"></i><b>14.2.4</b> L’argument <code>...</code></a></li>
<li class="chapter" data-level="14.2.5" data-path="14-fonctions.html"><a href="14-fonctions.html#resfunc"><i class="fa fa-check"></i><b>14.2.5</b> Résultat d’une fonction</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14-fonctions.html"><a href="14-fonctions.html#portée-des-variables"><i class="fa fa-check"></i><b>14.3</b> Portée des variables</a><ul>
<li class="chapter" data-level="14.3.1" data-path="14-fonctions.html"><a href="14-fonctions.html#une-fonction-peut-accéder-à-un-objet-extérieur"><i class="fa fa-check"></i><b>14.3.1</b> Une fonction peut accéder à un objet extérieur</a></li>
<li class="chapter" data-level="14.3.2" data-path="14-fonctions.html"><a href="14-fonctions.html#les-arguments-et-les-objets-créés-dans-la-fonction-sont-prioritaires"><i class="fa fa-check"></i><b>14.3.2</b> Les arguments et les objets créés dans la fonction sont prioritaires</a></li>
<li class="chapter" data-level="14.3.3" data-path="14-fonctions.html"><a href="14-fonctions.html#un-objet-créé-dans-une-fonction-nexiste-que-dans-cette-fonction"><i class="fa fa-check"></i><b>14.3.3</b> Un objet créé dans une fonction n’existe que dans cette fonction</a></li>
<li class="chapter" data-level="14.3.4" data-path="14-fonctions.html"><a href="14-fonctions.html#on-ne-peut-pas-modifier-un-objet-global-dans-une-fonction"><i class="fa fa-check"></i><b>14.3.4</b> On ne peut pas modifier un objet global dans une fonction</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="14-fonctions.html"><a href="14-fonctions.html#les-fonctions-comme-objets"><i class="fa fa-check"></i><b>14.4</b> Les fonctions comme objets</a><ul>
<li class="chapter" data-level="14.4.1" data-path="14-fonctions.html"><a href="14-fonctions.html#passer-des-fonctions-comme-argument"><i class="fa fa-check"></i><b>14.4.1</b> Passer des fonctions comme argument</a></li>
<li class="chapter" data-level="14.4.2" data-path="14-fonctions.html"><a href="14-fonctions.html#fonctions-anonymes"><i class="fa fa-check"></i><b>14.4.2</b> Fonctions anonymes</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="14-fonctions.html"><a href="14-fonctions.html#ressources-6"><i class="fa fa-check"></i><b>14.5</b> Ressources</a></li>
<li class="chapter" data-level="14.6" data-path="14-fonctions.html"><a href="14-fonctions.html#exercices-7"><i class="fa fa-check"></i><b>14.6</b> Exercices</a><ul>
<li class="chapter" data-level="14.6.1" data-path="14-fonctions.html"><a href="14-fonctions.html#introduction-et-exemples-1"><i class="fa fa-check"></i><b>14.6.1</b> Introduction et exemples</a></li>
<li class="chapter" data-level="14.6.2" data-path="14-fonctions.html"><a href="14-fonctions.html#arguments-et-résultat"><i class="fa fa-check"></i><b>14.6.2</b> Arguments et résultat</a></li>
<li class="chapter" data-level="14.6.3" data-path="14-fonctions.html"><a href="14-fonctions.html#portée-des-variables-1"><i class="fa fa-check"></i><b>14.6.3</b> Portée des variables</a></li>
<li class="chapter" data-level="14.6.4" data-path="14-fonctions.html"><a href="14-fonctions.html#les-fonctions-comme-objets-1"><i class="fa fa-check"></i><b>14.6.4</b> Les fonctions comme objets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html"><i class="fa fa-check"></i><b>15</b> <code>dplyr</code> avancé</a><ul>
<li class="chapter" data-level="15.1" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#appliquer-ses-propres-fonctions"><i class="fa fa-check"></i><b>15.1</b> Appliquer ses propres fonctions</a><ul>
<li class="chapter" data-level="15.1.1" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#exemple-avec-mutate"><i class="fa fa-check"></i><b>15.1.1</b> Exemple avec <code>mutate</code></a></li>
<li class="chapter" data-level="15.1.2" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#exemple-avec-summarise"><i class="fa fa-check"></i><b>15.1.2</b> Exemple avec <code>summarise</code></a></li>
<li class="chapter" data-level="15.1.3" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#exemple-avec-rename_with"><i class="fa fa-check"></i><b>15.1.3</b> Exemple avec <code>rename_with</code></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#across"><i class="fa fa-check"></i><b>15.2</b> <code>across()</code> : appliquer des fonctions à plusieurs colonnes</a><ul>
<li class="chapter" data-level="15.2.1" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#appliquer-une-fonction-à-plusieurs-colonnes"><i class="fa fa-check"></i><b>15.2.1</b> Appliquer une fonction à plusieurs colonnes</a></li>
<li class="chapter" data-level="15.2.2" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#passer-des-arguments-supplémentaires-à-la-fonction-appliquée"><i class="fa fa-check"></i><b>15.2.2</b> Passer des arguments supplémentaires à la fonction appliquée</a></li>
<li class="chapter" data-level="15.2.3" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#noms-des-colonnes-créées-par-un-mutate"><i class="fa fa-check"></i><b>15.2.3</b> Noms des colonnes créées par un <code>mutate</code></a></li>
<li class="chapter" data-level="15.2.4" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#appliquer-plusieurs-fonctions-à-plusieurs-colonnes"><i class="fa fa-check"></i><b>15.2.4</b> Appliquer plusieurs fonctions à plusieurs colonnes</a></li>
<li class="chapter" data-level="15.2.5" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#renommer-plusieurs-colonnes-avec-une-fonction"><i class="fa fa-check"></i><b>15.2.5</b> Renommer plusieurs colonnes avec une fonction</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#syntaxes-abregees"><i class="fa fa-check"></i><b>15.3</b> Fonctions anonymes et syntaxes abrégées</a></li>
<li class="chapter" data-level="15.4" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#rowwise-et-c_across-appliquer-une-transformation-ligne-par-ligne"><i class="fa fa-check"></i><b>15.4</b> <code>rowwise()</code> et <code>c_across()</code> : appliquer une transformation ligne par ligne</a></li>
<li class="chapter" data-level="15.5" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#ressources-7"><i class="fa fa-check"></i><b>15.5</b> Ressources</a></li>
<li class="chapter" data-level="15.6" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#exercices-8"><i class="fa fa-check"></i><b>15.6</b> Exercices</a><ul>
<li class="chapter" data-level="15.6.1" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#appliquer-ses-propres-fonctions-1"><i class="fa fa-check"></i><b>15.6.1</b> Appliquer ses propres fonctions</a></li>
<li class="chapter" data-level="15.6.2" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#across-1"><i class="fa fa-check"></i><b>15.6.2</b> <code>across()</code></a></li>
<li class="chapter" data-level="15.6.3" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#fonctions-anonymes-et-notations-abrégées"><i class="fa fa-check"></i><b>15.6.3</b> Fonctions anonymes et notations abrégées</a></li>
<li class="chapter" data-level="15.6.4" data-path="15-dplyr-avance.html"><a href="15-dplyr-avance.html#rowwise-et-c_across"><i class="fa fa-check"></i><b>15.6.4</b> <code>rowwise()</code> et <code>c_across()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html"><i class="fa fa-check"></i><b>16</b> Structures de données</a><ul>
<li class="chapter" data-level="16.1" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#vecteurs-atomiques"><i class="fa fa-check"></i><b>16.1</b> Vecteurs atomiques</a><ul>
<li class="chapter" data-level="16.1.1" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#création-dun-vecteur"><i class="fa fa-check"></i><b>16.1.1</b> Création d’un vecteur</a></li>
<li class="chapter" data-level="16.1.2" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#vecteurs-nommés"><i class="fa fa-check"></i><b>16.1.2</b> Vecteurs nommés</a></li>
<li class="chapter" data-level="16.1.3" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#types-de-vecteurs"><i class="fa fa-check"></i><b>16.1.3</b> Types de vecteurs</a></li>
<li class="chapter" data-level="16.1.4" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#sélection-déléments"><i class="fa fa-check"></i><b>16.1.4</b> Sélection d’éléments</a></li>
<li class="chapter" data-level="16.1.5" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#modification"><i class="fa fa-check"></i><b>16.1.5</b> Modification</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#listes"><i class="fa fa-check"></i><b>16.2</b> Listes</a><ul>
<li class="chapter" data-level="16.2.1" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#création"><i class="fa fa-check"></i><b>16.2.1</b> Création</a></li>
<li class="chapter" data-level="16.2.2" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#ajout-déléments"><i class="fa fa-check"></i><b>16.2.2</b> Ajout d’éléments</a></li>
<li class="chapter" data-level="16.2.3" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#sélection-déléments-1"><i class="fa fa-check"></i><b>16.2.3</b> Sélection d’éléments</a></li>
<li class="chapter" data-level="16.2.4" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#modification-1"><i class="fa fa-check"></i><b>16.2.4</b> Modification</a></li>
<li class="chapter" data-level="16.2.5" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#utilisation"><i class="fa fa-check"></i><b>16.2.5</b> Utilisation</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#data-frame-tibbles"><i class="fa fa-check"></i><b>16.3</b> Tableaux de données (<em>data frame</em> et <em>tibble</em>)</a><ul>
<li class="chapter" data-level="16.3.1" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#création-1"><i class="fa fa-check"></i><b>16.3.1</b> Création</a></li>
<li class="chapter" data-level="16.3.2" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#noms-de-colonnes-et-de-lignes"><i class="fa fa-check"></i><b>16.3.2</b> Noms de colonnes et de lignes</a></li>
<li class="chapter" data-level="16.3.3" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#df-sel"><i class="fa fa-check"></i><b>16.3.3</b> Sélection de lignes et de colonnes</a></li>
<li class="chapter" data-level="16.3.4" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#modification-2"><i class="fa fa-check"></i><b>16.3.4</b> Modification</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#ressources-8"><i class="fa fa-check"></i><b>16.4</b> Ressources</a></li>
<li class="chapter" data-level="16.5" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#exercices-9"><i class="fa fa-check"></i><b>16.5</b> Exercices</a><ul>
<li class="chapter" data-level="16.5.1" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#vecteurs-atomiques-1"><i class="fa fa-check"></i><b>16.5.1</b> Vecteurs atomiques</a></li>
<li class="chapter" data-level="16.5.2" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#listes-1"><i class="fa fa-check"></i><b>16.5.2</b> Listes</a></li>
<li class="chapter" data-level="16.5.3" data-path="16-structures-donnees.html"><a href="16-structures-donnees.html#tableaux-de-données"><i class="fa fa-check"></i><b>16.5.3</b> Tableaux de données</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-if-boucles.html"><a href="17-if-boucles.html"><i class="fa fa-check"></i><b>17</b> Exécution conditionnelle et boucles</a><ul>
<li class="chapter" data-level="17.1" data-path="17-if-boucles.html"><a href="17-if-boucles.html#if-et-else-exécuter-du-code-sous-certaines-conditions"><i class="fa fa-check"></i><b>17.1</b> <code>if</code> et <code>else</code> : exécuter du code sous certaines conditions</a><ul>
<li class="chapter" data-level="17.1.1" data-path="17-if-boucles.html"><a href="17-if-boucles.html#if"><i class="fa fa-check"></i><b>17.1.1</b> <code>if</code></a></li>
<li class="chapter" data-level="17.1.2" data-path="17-if-boucles.html"><a href="17-if-boucles.html#if-else-1"><i class="fa fa-check"></i><b>17.1.2</b> <code>if</code> / <code>else</code></a></li>
<li class="chapter" data-level="17.1.3" data-path="17-if-boucles.html"><a href="17-if-boucles.html#if-else-if-else"><i class="fa fa-check"></i><b>17.1.3</b> “<code>if</code>” / “<code>else if</code>” / “<code>else</code>”</a></li>
<li class="chapter" data-level="17.1.4" data-path="17-if-boucles.html"><a href="17-if-boucles.html#construction-de-conditions-complexes"><i class="fa fa-check"></i><b>17.1.4</b> Construction de conditions complexes</a></li>
<li class="chapter" data-level="17.1.5" data-path="17-if-boucles.html"><a href="17-if-boucles.html#différence-entre-if-else-et-ifelse"><i class="fa fa-check"></i><b>17.1.5</b> Différence entre <code>if</code> / <code>else</code> et <code>ifelse</code></a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="17-if-boucles.html"><a href="17-if-boucles.html#contrôle-de-lexécution-et-gestion-des-erreurs"><i class="fa fa-check"></i><b>17.2</b> Contrôle de l’exécution et gestion des erreurs</a><ul>
<li class="chapter" data-level="17.2.1" data-path="17-if-boucles.html"><a href="17-if-boucles.html#utilisation-de-return-pour-sortir-de-la-fonction"><i class="fa fa-check"></i><b>17.2.1</b> Utilisation de <code>return</code> pour sortir de la fonction</a></li>
<li class="chapter" data-level="17.2.2" data-path="17-if-boucles.html"><a href="17-if-boucles.html#warning"><i class="fa fa-check"></i><b>17.2.2</b> <code>warning</code></a></li>
<li class="chapter" data-level="17.2.3" data-path="17-if-boucles.html"><a href="17-if-boucles.html#stop-et-stopifnot"><i class="fa fa-check"></i><b>17.2.3</b> <code>stop</code> et <code>stopifnot</code></a></li>
<li class="chapter" data-level="17.2.4" data-path="17-if-boucles.html"><a href="17-if-boucles.html#test-arg"><i class="fa fa-check"></i><b>17.2.4</b> Tester la présence d’un argument facultatif</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="17-if-boucles.html"><a href="17-if-boucles.html#for-et-while-répéter-des-instructions-dans-une-boucle"><i class="fa fa-check"></i><b>17.3</b> <code>for</code> et <code>while</code> : répéter des instructions dans une boucle</a><ul>
<li class="chapter" data-level="17.3.1" data-path="17-if-boucles.html"><a href="17-if-boucles.html#for"><i class="fa fa-check"></i><b>17.3.1</b> <code>for</code></a></li>
<li class="chapter" data-level="17.3.2" data-path="17-if-boucles.html"><a href="17-if-boucles.html#while"><i class="fa fa-check"></i><b>17.3.2</b> <code>while</code></a></li>
<li class="chapter" data-level="17.3.3" data-path="17-if-boucles.html"><a href="17-if-boucles.html#next-et-break"><i class="fa fa-check"></i><b>17.3.3</b> <code>next</code> et <code>break</code></a></li>
<li class="chapter" data-level="17.3.4" data-path="17-if-boucles.html"><a href="17-if-boucles.html#no-boucles"><i class="fa fa-check"></i><b>17.3.4</b> Quand (ne pas) utiliser des boucles</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="17-if-boucles.html"><a href="17-if-boucles.html#ressources-boucles"><i class="fa fa-check"></i><b>17.4</b> Ressources</a></li>
<li class="chapter" data-level="17.5" data-path="17-if-boucles.html"><a href="17-if-boucles.html#exercices-10"><i class="fa fa-check"></i><b>17.5</b> Exercices</a><ul>
<li class="chapter" data-level="17.5.1" data-path="17-if-boucles.html"><a href="17-if-boucles.html#if-et-else"><i class="fa fa-check"></i><b>17.5.1</b> <code>if</code> et <code>else</code></a></li>
<li class="chapter" data-level="17.5.2" data-path="17-if-boucles.html"><a href="17-if-boucles.html#contrôle-de-lexécution"><i class="fa fa-check"></i><b>17.5.2</b> Contrôle de l’exécution</a></li>
<li class="chapter" data-level="17.5.3" data-path="17-if-boucles.html"><a href="17-if-boucles.html#boucles"><i class="fa fa-check"></i><b>17.5.3</b> Boucles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="18-purrr.html"><a href="18-purrr.html"><i class="fa fa-check"></i><b>18</b> Itérer avec <code>purrr</code></a><ul>
<li class="chapter" data-level="18.1" data-path="18-purrr.html"><a href="18-purrr.html#exemple-dapplication"><i class="fa fa-check"></i><b>18.1</b> Exemple d’application</a></li>
<li class="chapter" data-level="18.2" data-path="18-purrr.html"><a href="18-purrr.html#map-et-ses-variantes"><i class="fa fa-check"></i><b>18.2</b> <code>map</code> et ses variantes</a><ul>
<li class="chapter" data-level="18.2.1" data-path="18-purrr.html"><a href="18-purrr.html#modes-dappel-de-map"><i class="fa fa-check"></i><b>18.2.1</b> Modes d’appel de <code>map</code></a></li>
<li class="chapter" data-level="18.2.2" data-path="18-purrr.html"><a href="18-purrr.html#variantes-de-map"><i class="fa fa-check"></i><b>18.2.2</b> Variantes de <code>map</code></a></li>
<li class="chapter" data-level="18.2.3" data-path="18-purrr.html"><a href="18-purrr.html#map_dfr-et-map_dfc"><i class="fa fa-check"></i><b>18.2.3</b> <code>map_dfr()</code> et <code>map_dfc()</code></a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="18-purrr.html"><a href="18-purrr.html#itérer-sur-les-colonnes-dun-tableau-de-données"><i class="fa fa-check"></i><b>18.3</b> Itérer sur les colonnes d’un tableau de données</a></li>
<li class="chapter" data-level="18.4" data-path="18-purrr.html"><a href="18-purrr.html#modify"><i class="fa fa-check"></i><b>18.4</b> <code>modify</code></a></li>
<li class="chapter" data-level="18.5" data-path="18-purrr.html"><a href="18-purrr.html#imap"><i class="fa fa-check"></i><b>18.5</b> <code>imap</code></a></li>
<li class="chapter" data-level="18.6" data-path="18-purrr.html"><a href="18-purrr.html#walk"><i class="fa fa-check"></i><b>18.6</b> <code>walk</code></a></li>
<li class="chapter" data-level="18.7" data-path="18-purrr.html"><a href="18-purrr.html#map2-et-pmap-itérer-sur-plusieurs-vecteurs-en-parallèle"><i class="fa fa-check"></i><b>18.7</b> <code>map2</code> et <code>pmap</code> : itérer sur plusieurs vecteurs en parallèle</a></li>
<li class="chapter" data-level="18.8" data-path="18-purrr.html"><a href="18-purrr.html#répéter-une-opération"><i class="fa fa-check"></i><b>18.8</b> Répéter une opération</a></li>
<li class="chapter" data-level="18.9" data-path="18-purrr.html"><a href="18-purrr.html#quand-ne-pas-utiliser-map"><i class="fa fa-check"></i><b>18.9</b> Quand (ne pas) utiliser <code>map</code></a></li>
<li class="chapter" data-level="18.10" data-path="18-purrr.html"><a href="18-purrr.html#purrr-vs-apply"><i class="fa fa-check"></i><b>18.10</b> <code>purrr</code> vs <code>*apply</code></a></li>
<li class="chapter" data-level="18.11" data-path="18-purrr.html"><a href="18-purrr.html#ressources-9"><i class="fa fa-check"></i><b>18.11</b> Ressources</a></li>
<li class="chapter" data-level="18.12" data-path="18-purrr.html"><a href="18-purrr.html#exercices-11"><i class="fa fa-check"></i><b>18.12</b> Exercices</a><ul>
<li class="chapter" data-level="18.12.1" data-path="18-purrr.html"><a href="18-purrr.html#map-et-ses-variantes-1"><i class="fa fa-check"></i><b>18.12.1</b> <code>map</code> et ses variantes</a></li>
<li class="chapter" data-level="18.12.2" data-path="18-purrr.html"><a href="18-purrr.html#modify-et-itération-sur-les-colonnes-dun-tableau"><i class="fa fa-check"></i><b>18.12.2</b> <code>modify</code> et itération sur les colonnes d’un tableau</a></li>
<li class="chapter" data-level="18.12.3" data-path="18-purrr.html"><a href="18-purrr.html#imap-et-walk"><i class="fa fa-check"></i><b>18.12.3</b> <code>imap</code> et <code>walk</code></a></li>
<li class="chapter" data-level="18.12.4" data-path="18-purrr.html"><a href="18-purrr.html#map2-et-pmap"><i class="fa fa-check"></i><b>18.12.4</b> <code>map2</code> et <code>pmap</code></a></li>
<li class="chapter" data-level="18.12.5" data-path="18-purrr.html"><a href="18-purrr.html#répéter-une-opération-1"><i class="fa fa-check"></i><b>18.12.5</b> Répéter une opération</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html"><i class="fa fa-check"></i><b>19</b> Programmer avec le <em>tidyverse</em></a><ul>
<li class="chapter" data-level="19.1" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#spécificités-du-tidyverse"><i class="fa fa-check"></i><b>19.1</b> Spécificités du <em>tidyverse</em></a><ul>
<li class="chapter" data-level="19.1.1" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#data-masking"><i class="fa fa-check"></i><b>19.1.1</b> <em>data masking</em></a></li>
<li class="chapter" data-level="19.1.2" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#tidy-selection"><i class="fa fa-check"></i><b>19.1.2</b> <em>tidy selection</em></a></li>
<li class="chapter" data-level="19.1.3" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#utilisation-dans-des-fonctions"><i class="fa fa-check"></i><b>19.1.3</b> Utilisation dans des fonctions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#programmer-avec-dplyr-et-tidyr"><i class="fa fa-check"></i><b>19.2</b> Programmer avec <code>dplyr</code> et <code>tidyr</code></a><ul>
<li class="chapter" data-level="19.2.1" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#utiliser-une-colonne-passée-en-argument"><i class="fa fa-check"></i><b>19.2.1</b> Utiliser une colonne passée en argument</a></li>
<li class="chapter" data-level="19.2.2" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#utiliser-une-sélection-de-colonnes-passée-en-argument"><i class="fa fa-check"></i><b>19.2.2</b> Utiliser une sélection de colonnes passée en argument</a></li>
<li class="chapter" data-level="19.2.3" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#nommer-de-nouvelles-colonnes-à-partir-dun-argument"><i class="fa fa-check"></i><b>19.2.3</b> Nommer de nouvelles colonnes à partir d’un argument</a></li>
<li class="chapter" data-level="19.2.4" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#désambiguïser-data-et-env"><i class="fa fa-check"></i><b>19.2.4</b> Désambiguïser data et env</a></li>
<li class="chapter" data-level="19.2.5" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#quand-les-arguments-sont-des-chaînes-de-caractères"><i class="fa fa-check"></i><b>19.2.5</b> Quand les arguments sont des chaînes de caractères</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#programmer-avec-ggplot2"><i class="fa fa-check"></i><b>19.3</b> Programmer avec <code>ggplot2</code></a><ul>
<li class="chapter" data-level="19.3.1" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#sélection-de-colonnes-avec-aes"><i class="fa fa-check"></i><b>19.3.1</b> Sélection de colonnes avec <code>aes()</code></a></li>
<li class="chapter" data-level="19.3.2" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#faceting-1"><i class="fa fa-check"></i><b>19.3.2</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#aide-mémoire"><i class="fa fa-check"></i><b>19.4</b> Aide-mémoire</a></li>
<li class="chapter" data-level="19.5" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#ressources-10"><i class="fa fa-check"></i><b>19.5</b> Ressources</a></li>
<li class="chapter" data-level="19.6" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#exercices-12"><i class="fa fa-check"></i><b>19.6</b> Exercices</a><ul>
<li class="chapter" data-level="19.6.1" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#dplyr-et-tidyr"><i class="fa fa-check"></i><b>19.6.1</b> <code>dplyr</code> et <code>tidyr</code></a></li>
<li class="chapter" data-level="19.6.2" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#noms-de-colonnes-en-chaînes-de-caractères"><i class="fa fa-check"></i><b>19.6.2</b> Noms de colonnes en chaînes de caractères</a></li>
<li class="chapter" data-level="19.6.3" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#ambiguïté-data-env"><i class="fa fa-check"></i><b>19.6.3</b> Ambiguïté <code>data</code> / <code>env</code></a></li>
<li class="chapter" data-level="19.6.4" data-path="19-programmer-tidyverse.html"><a href="19-programmer-tidyverse.html#ggplot2-1"><i class="fa fa-check"></i><b>19.6.4</b> <code>ggplot2</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html"><i class="fa fa-check"></i><b>20</b> Débuggage et performance</a><ul>
<li class="chapter" data-level="20.1" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#débugguer-une-fonction"><i class="fa fa-check"></i><b>20.1</b> Débugguer une fonction</a><ul>
<li class="chapter" data-level="20.1.1" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#print"><i class="fa fa-check"></i><b>20.1.1</b> print()</a></li>
<li class="chapter" data-level="20.1.2" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#localiser-une-erreur"><i class="fa fa-check"></i><b>20.1.2</b> Localiser une erreur</a></li>
<li class="chapter" data-level="20.1.3" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#browser"><i class="fa fa-check"></i><b>20.1.3</b> browser()</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#benchmarking-mesurer-et-comparer-les-temps-dexécution"><i class="fa fa-check"></i><b>20.2</b> benchmarking : mesurer et comparer les temps d’exécution</a></li>
<li class="chapter" data-level="20.3" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#quelques-conseils-doptimisation"><i class="fa fa-check"></i><b>20.3</b> Quelques conseils d’optimisation</a><ul>
<li class="chapter" data-level="20.3.1" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#privilégier-les-fonctions-vectorisées"><i class="fa fa-check"></i><b>20.3.1</b> Privilégier les fonctions vectorisées</a></li>
<li class="chapter" data-level="20.3.2" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#mettre-le-minimum-dopérations-dans-les-boucles"><i class="fa fa-check"></i><b>20.3.2</b> Mettre le minimum d’opérations dans les boucles</a></li>
<li class="chapter" data-level="20.3.3" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#choisir-un-format-de-fichier-adapté"><i class="fa fa-check"></i><b>20.3.3</b> Choisir un format de fichier adapté</a></li>
<li class="chapter" data-level="20.3.4" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#repérer-les-opérations-coûteuses-avec-du-profiling"><i class="fa fa-check"></i><b>20.3.4</b> Repérer les opérations coûteuses avec du <em>profiling</em></a></li>
<li class="chapter" data-level="20.3.5" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#mettre-en-cache-des-résultats-intermédiaires"><i class="fa fa-check"></i><b>20.3.5</b> Mettre en cache des résultats intermédiaires</a></li>
<li class="chapter" data-level="20.3.6" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#utiliser-dautres-extensions"><i class="fa fa-check"></i><b>20.3.6</b> Utiliser d’autres extensions</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="20-debuggage-performance.html"><a href="20-debuggage-performance.html#ressources-11"><i class="fa fa-check"></i><b>20.4</b> Ressources</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="21-targets.html"><a href="21-targets.html"><i class="fa fa-check"></i><b>21</b> Organiser un projet avec <code>targets</code></a><ul>
<li class="chapter" data-level="21.1" data-path="21-targets.html"><a href="21-targets.html#définition-du-pipeline"><i class="fa fa-check"></i><b>21.1</b> Définition du pipeline</a><ul>
<li class="chapter" data-level="21.1.1" data-path="21-targets.html"><a href="21-targets.html#projet-dexemple"><i class="fa fa-check"></i><b>21.1.1</b> Projet d’exemple</a></li>
<li class="chapter" data-level="21.1.2" data-path="21-targets.html"><a href="21-targets.html#targets.r"><i class="fa fa-check"></i><b>21.1.2</b> <code>_targets.R</code></a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="21-targets.html"><a href="21-targets.html#exécution-du-pipeline"><i class="fa fa-check"></i><b>21.2</b> Exécution du pipeline</a></li>
<li class="chapter" data-level="21.3" data-path="21-targets.html"><a href="21-targets.html#modification-du-pipeline"><i class="fa fa-check"></i><b>21.3</b> Modification du pipeline</a></li>
<li class="chapter" data-level="21.4" data-path="21-targets.html"><a href="21-targets.html#rmarkdown"><i class="fa fa-check"></i><b>21.4</b> RMarkdown</a></li>
<li class="chapter" data-level="21.5" data-path="21-targets.html"><a href="21-targets.html#gestion-des-données-en-cache"><i class="fa fa-check"></i><b>21.5</b> Gestion des données en cache</a></li>
<li class="chapter" data-level="21.6" data-path="21-targets.html"><a href="21-targets.html#avantages-et-limites"><i class="fa fa-check"></i><b>21.6</b> Avantages et limites</a><ul>
<li class="chapter" data-level="21.6.1" data-path="21-targets.html"><a href="21-targets.html#avantages"><i class="fa fa-check"></i><b>21.6.1</b> Avantages</a></li>
<li class="chapter" data-level="21.6.2" data-path="21-targets.html"><a href="21-targets.html#interactivité-et-développement-du-pipeline"><i class="fa fa-check"></i><b>21.6.2</b> Interactivité et développement du pipeline</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="21-targets.html"><a href="21-targets.html#ressources-12"><i class="fa fa-check"></i><b>21.7</b> Ressources</a></li>
</ul></li>
<li class="appendix"><span><b>Annexes</b></span></li>
<li class="chapter" data-level="A" data-path="22-ressources.html"><a href="22-ressources.html"><i class="fa fa-check"></i><b>A</b> Ressources</a><ul>
<li class="chapter" data-level="A.1" data-path="22-ressources.html"><a href="22-ressources.html#aide"><i class="fa fa-check"></i><b>A.1</b> Aide</a><ul>
<li class="chapter" data-level="A.1.1" data-path="22-ressources.html"><a href="22-ressources.html#aide-de-r-et-rstudio"><i class="fa fa-check"></i><b>A.1.1</b> Aide de R et RStudio</a></li>
<li class="chapter" data-level="A.1.2" data-path="22-ressources.html"><a href="22-ressources.html#aide-en-ligne"><i class="fa fa-check"></i><b>A.1.2</b> Aide en ligne</a></li>
<li class="chapter" data-level="A.1.3" data-path="22-ressources.html"><a href="22-ressources.html#antisèches"><i class="fa fa-check"></i><b>A.1.3</b> Antisèches</a></li>
<li class="chapter" data-level="A.1.4" data-path="22-ressources.html"><a href="22-ressources.html#où-poser-des-questions"><i class="fa fa-check"></i><b>A.1.4</b> Où poser des questions</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="22-ressources.html"><a href="22-ressources.html#ouvrages-blogs-moocs"><i class="fa fa-check"></i><b>A.2</b> Ouvrages, blogs, MOOCs…</a><ul>
<li class="chapter" data-level="A.2.1" data-path="22-ressources.html"><a href="22-ressources.html#francophones"><i class="fa fa-check"></i><b>A.2.1</b> Francophones</a></li>
<li class="chapter" data-level="A.2.2" data-path="22-ressources.html"><a href="22-ressources.html#anglophones"><i class="fa fa-check"></i><b>A.2.2</b> Anglophones</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="22-ressources.html"><a href="22-ressources.html#extensions-1"><i class="fa fa-check"></i><b>A.3</b> Extensions</a><ul>
<li class="chapter" data-level="A.3.1" data-path="22-ressources.html"><a href="22-ressources.html#où-trouver-des-extensions-intéressantes"><i class="fa fa-check"></i><b>A.3.1</b> Où trouver des extensions intéressantes ?</a></li>
<li class="chapter" data-level="A.3.2" data-path="22-ressources.html"><a href="22-ressources.html#lextension-questionr"><i class="fa fa-check"></i><b>A.3.2</b> L’extension <code>questionr</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction à R et au tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dplyr" class="section level1">
<h1><span class="header-section-number">Partie 10</span> Manipuler les données avec <code>dplyr</code></h1>
<p><code>dplyr</code> est une extension facilitant le traitement et la manipulation de données contenues dans une ou plusieurs tables. Elle propose une syntaxe claire et cohérente, sous formes de verbes, pour la plupart des opérations de ce type. Ses fonctions sont en général plus rapides que leur équivalent sous R de base, elles permettent donc de traiter efficacement des données de grande dimension.</p>
<p><code>dplyr</code> part du principe que les données sont organisées selon le modèle des <em>tidy data</em> (voir la section <a href="06-tidyverse.html#tidydata">6.3</a>). Les fonctions de l’extension peuvent s’appliquer à des tableaux de type <code>data.frame</code> ou <code>tibble</code>, et elles retournent systématiquement un <code>tibble</code> (voir la section <a href="06-tidyverse.html#tibbles">6.4</a>).</p>
<p>Le code présent dans ce document nécessite d’avoir installé la version 1.0 de <code>dplyr</code> (ou plus récente).</p>
<div id="préparation-2" class="section level2">
<h2><span class="header-section-number">10.1</span> Préparation</h2>
<p><code>dplyr</code> fait partie du coeur du <em>tidyverse</em>, elle est donc chargée automatiquement avec :</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="10-dplyr.html#cb340-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p>On peut également la charger individuellement avec :</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="10-dplyr.html#cb341-1"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<p>Dans ce qui suit on va utiliser le jeu de données <code>nycflights13</code>, contenu dans l’extension du même nom (qu’il faut donc avoir installé). Celui-ci correspond aux données de tous les vols au départ d’un des trois aéroports de New-York en 2013. Il a la particularité d’être réparti en trois tables :</p>
<ul>
<li><code>flights</code> contient des informations sur les vols : date, départ, destination, horaires, retard…</li>
<li><code>airports</code> contient des informations sur les aéroports</li>
<li><code>airlines</code> contient des données sur les compagnies aériennes</li>
</ul>
<p>On va charger les trois tables du jeu de données :</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="10-dplyr.html#cb342-1"></a><span class="kw">library</span>(nycflights13)</span>
<span id="cb342-2"><a href="10-dplyr.html#cb342-2"></a><span class="co">## Chargement des trois tables</span></span>
<span id="cb342-3"><a href="10-dplyr.html#cb342-3"></a><span class="kw">data</span>(flights)</span>
<span id="cb342-4"><a href="10-dplyr.html#cb342-4"></a><span class="kw">data</span>(airports)</span>
<span id="cb342-5"><a href="10-dplyr.html#cb342-5"></a><span class="kw">data</span>(airlines)</span></code></pre></div>
<p>Trois objets correspondant aux trois tables ont dû apparaître dans votre environnement.</p>
</div>
<div id="les-verbes-de-dplyr" class="section level2">
<h2><span class="header-section-number">10.2</span> Les verbes de <code>dplyr</code></h2>
<p>La manipulation de données avec <code>dplyr</code> se fait en utilisant un nombre réduit de verbes, qui correspondent chacun à une action différente appliquée à un tableau de données.</p>
<div id="slice" class="section level3">
<h3><span class="header-section-number">10.2.1</span> <code>slice</code></h3>
<p>Le verbe <code>slice</code> sélectionne des lignes du tableau selon leur position. On lui passe un chiffre ou un vecteur de chiffres.</p>
<p>Si on souhaite sélectionner la 345e ligne du tableau <code>airports</code> :</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="10-dplyr.html#cb343-1"></a><span class="kw">slice</span>(airports, <span class="dv">345</span>)</span>
<span id="cb343-2"><a href="10-dplyr.html#cb343-2"></a><span class="co">#&gt; # A tibble: 1 × 8</span></span>
<span id="cb343-3"><a href="10-dplyr.html#cb343-3"></a><span class="co">#&gt;   faa   name                lat   lon   alt    tz dst   tzone            </span></span>
<span id="cb343-4"><a href="10-dplyr.html#cb343-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;            </span></span>
<span id="cb343-5"><a href="10-dplyr.html#cb343-5"></a><span class="co">#&gt; 1 CYF   Chefornak Airport  60.1 -164.    40    -9 A     America/Anchorage</span></span></code></pre></div>
<p>Si on veut sélectionner les 5 premières lignes :</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="10-dplyr.html#cb344-1"></a><span class="kw">slice</span>(airports, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb344-2"><a href="10-dplyr.html#cb344-2"></a><span class="co">#&gt; # A tibble: 5 × 8</span></span>
<span id="cb344-3"><a href="10-dplyr.html#cb344-3"></a><span class="co">#&gt;   faa   name                            lat   lon   alt    tz dst   tzone       </span></span>
<span id="cb344-4"><a href="10-dplyr.html#cb344-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       </span></span>
<span id="cb344-5"><a href="10-dplyr.html#cb344-5"></a><span class="co">#&gt; 1 04G   Lansdowne Airport              41.1 -80.6  1044    -5 A     America/New…</span></span>
<span id="cb344-6"><a href="10-dplyr.html#cb344-6"></a><span class="co">#&gt; 2 06A   Moton Field Municipal Airport  32.5 -85.7   264    -6 A     America/Chi…</span></span>
<span id="cb344-7"><a href="10-dplyr.html#cb344-7"></a><span class="co">#&gt; 3 06C   Schaumburg Regional            42.0 -88.1   801    -6 A     America/Chi…</span></span>
<span id="cb344-8"><a href="10-dplyr.html#cb344-8"></a><span class="co">#&gt; 4 06N   Randall Airport                41.4 -74.4   523    -5 A     America/New…</span></span>
<span id="cb344-9"><a href="10-dplyr.html#cb344-9"></a><span class="co">#&gt; 5 09J   Jekyll Island Airport          31.1 -81.4    11    -5 A     America/New…</span></span></code></pre></div>
</div>
<div id="filter" class="section level3">
<h3><span class="header-section-number">10.2.2</span> <code>filter</code></h3>
<p><code>filter</code> sélectionne des lignes d’une table selon une condition. On lui passe en paramètre un test, et seules les lignes pour lesquelles ce test renvoie <code>TRUE</code> (vrai) sont conservées. Pour plus d’informations sur les tests et leur syntaxe, voir la section <a href="09-recodages.html#tests">9.2</a>.</p>
<p>Par exemple, si on veut sélectionner les vols du mois de janvier, on peut filtrer sur la variable <code>month</code> de la manière suivante :</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="10-dplyr.html#cb345-1"></a><span class="kw">filter</span>(flights, month <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb345-2"><a href="10-dplyr.html#cb345-2"></a><span class="co">#&gt; # A tibble: 27,004 × 19</span></span>
<span id="cb345-3"><a href="10-dplyr.html#cb345-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb345-4"><a href="10-dplyr.html#cb345-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb345-5"><a href="10-dplyr.html#cb345-5"></a><span class="co">#&gt;  1  2013     1     1      517            515         2      830            819</span></span>
<span id="cb345-6"><a href="10-dplyr.html#cb345-6"></a><span class="co">#&gt;  2  2013     1     1      533            529         4      850            830</span></span>
<span id="cb345-7"><a href="10-dplyr.html#cb345-7"></a><span class="co">#&gt;  3  2013     1     1      542            540         2      923            850</span></span>
<span id="cb345-8"><a href="10-dplyr.html#cb345-8"></a><span class="co">#&gt;  4  2013     1     1      544            545        -1     1004           1022</span></span>
<span id="cb345-9"><a href="10-dplyr.html#cb345-9"></a><span class="co">#&gt;  5  2013     1     1      554            600        -6      812            837</span></span>
<span id="cb345-10"><a href="10-dplyr.html#cb345-10"></a><span class="co">#&gt;  6  2013     1     1      554            558        -4      740            728</span></span>
<span id="cb345-11"><a href="10-dplyr.html#cb345-11"></a><span class="co">#&gt;  7  2013     1     1      555            600        -5      913            854</span></span>
<span id="cb345-12"><a href="10-dplyr.html#cb345-12"></a><span class="co">#&gt;  8  2013     1     1      557            600        -3      709            723</span></span>
<span id="cb345-13"><a href="10-dplyr.html#cb345-13"></a><span class="co">#&gt;  9  2013     1     1      557            600        -3      838            846</span></span>
<span id="cb345-14"><a href="10-dplyr.html#cb345-14"></a><span class="co">#&gt; 10  2013     1     1      558            600        -2      753            745</span></span>
<span id="cb345-15"><a href="10-dplyr.html#cb345-15"></a><span class="co">#&gt; # … with 26,994 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb345-16"><a href="10-dplyr.html#cb345-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb345-17"><a href="10-dplyr.html#cb345-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>Si on veut uniquement les vols avec un retard au départ (variable <code>dep_delay</code>) compris entre 10 et 15 minutes :</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="10-dplyr.html#cb346-1"></a><span class="kw">filter</span>(flights, dep_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>dep_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">15</span>)</span>
<span id="cb346-2"><a href="10-dplyr.html#cb346-2"></a><span class="co">#&gt; # A tibble: 14,919 × 19</span></span>
<span id="cb346-3"><a href="10-dplyr.html#cb346-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb346-4"><a href="10-dplyr.html#cb346-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb346-5"><a href="10-dplyr.html#cb346-5"></a><span class="co">#&gt;  1  2013     1     1      611            600        11      945            931</span></span>
<span id="cb346-6"><a href="10-dplyr.html#cb346-6"></a><span class="co">#&gt;  2  2013     1     1      623            610        13      920            915</span></span>
<span id="cb346-7"><a href="10-dplyr.html#cb346-7"></a><span class="co">#&gt;  3  2013     1     1      743            730        13     1107           1100</span></span>
<span id="cb346-8"><a href="10-dplyr.html#cb346-8"></a><span class="co">#&gt;  4  2013     1     1      743            730        13     1059           1056</span></span>
<span id="cb346-9"><a href="10-dplyr.html#cb346-9"></a><span class="co">#&gt;  5  2013     1     1      851            840        11     1215           1206</span></span>
<span id="cb346-10"><a href="10-dplyr.html#cb346-10"></a><span class="co">#&gt;  6  2013     1     1      912            900        12     1241           1220</span></span>
<span id="cb346-11"><a href="10-dplyr.html#cb346-11"></a><span class="co">#&gt;  7  2013     1     1      914            900        14     1058           1043</span></span>
<span id="cb346-12"><a href="10-dplyr.html#cb346-12"></a><span class="co">#&gt;  8  2013     1     1      920            905        15     1039           1025</span></span>
<span id="cb346-13"><a href="10-dplyr.html#cb346-13"></a><span class="co">#&gt;  9  2013     1     1     1011           1001        10     1133           1128</span></span>
<span id="cb346-14"><a href="10-dplyr.html#cb346-14"></a><span class="co">#&gt; 10  2013     1     1     1112           1100        12     1440           1438</span></span>
<span id="cb346-15"><a href="10-dplyr.html#cb346-15"></a><span class="co">#&gt; # … with 14,909 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb346-16"><a href="10-dplyr.html#cb346-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb346-17"><a href="10-dplyr.html#cb346-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>Si on passe plusieurs arguments à <code>filter</code>, celui-ci rajoute automatiquement une condition <em>et</em> entre les conditions. La commande précédente peut donc être écrite de la manière suivante, avec le même résultat :</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="10-dplyr.html#cb347-1"></a><span class="kw">filter</span>(flights, dep_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>, dep_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">15</span>)</span></code></pre></div>
<p>On peut également placer des fonctions dans les tests, qui nous permettent par exemple de sélectionner les vols avec la plus grande distance :</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="10-dplyr.html#cb348-1"></a><span class="kw">filter</span>(flights, distance <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(distance))</span>
<span id="cb348-2"><a href="10-dplyr.html#cb348-2"></a><span class="co">#&gt; # A tibble: 342 × 19</span></span>
<span id="cb348-3"><a href="10-dplyr.html#cb348-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb348-4"><a href="10-dplyr.html#cb348-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb348-5"><a href="10-dplyr.html#cb348-5"></a><span class="co">#&gt;  1  2013     1     1      857            900        -3     1516           1530</span></span>
<span id="cb348-6"><a href="10-dplyr.html#cb348-6"></a><span class="co">#&gt;  2  2013     1     2      909            900         9     1525           1530</span></span>
<span id="cb348-7"><a href="10-dplyr.html#cb348-7"></a><span class="co">#&gt;  3  2013     1     3      914            900        14     1504           1530</span></span>
<span id="cb348-8"><a href="10-dplyr.html#cb348-8"></a><span class="co">#&gt;  4  2013     1     4      900            900         0     1516           1530</span></span>
<span id="cb348-9"><a href="10-dplyr.html#cb348-9"></a><span class="co">#&gt;  5  2013     1     5      858            900        -2     1519           1530</span></span>
<span id="cb348-10"><a href="10-dplyr.html#cb348-10"></a><span class="co">#&gt;  6  2013     1     6     1019            900        79     1558           1530</span></span>
<span id="cb348-11"><a href="10-dplyr.html#cb348-11"></a><span class="co">#&gt;  7  2013     1     7     1042            900       102     1620           1530</span></span>
<span id="cb348-12"><a href="10-dplyr.html#cb348-12"></a><span class="co">#&gt;  8  2013     1     8      901            900         1     1504           1530</span></span>
<span id="cb348-13"><a href="10-dplyr.html#cb348-13"></a><span class="co">#&gt;  9  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb348-14"><a href="10-dplyr.html#cb348-14"></a><span class="co">#&gt; 10  2013     1    10      859            900        -1     1449           1530</span></span>
<span id="cb348-15"><a href="10-dplyr.html#cb348-15"></a><span class="co">#&gt; # … with 332 more rows, and 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,</span></span>
<span id="cb348-16"><a href="10-dplyr.html#cb348-16"></a><span class="co">#&gt; #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,</span></span>
<span id="cb348-17"><a href="10-dplyr.html#cb348-17"></a><span class="co">#&gt; #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
</div>
<div id="select-rename" class="section level3">
<h3><span class="header-section-number">10.2.3</span> <code>select</code> et <code>rename</code></h3>
<p><code>select</code> permet de sélectionner des colonnes d’un tableau de données. Ainsi, si on veut extraire les colonnes <code>lat</code> et <code>lon</code> du tableau airports :</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="10-dplyr.html#cb349-1"></a><span class="kw">select</span>(airports, lat, lon)</span>
<span id="cb349-2"><a href="10-dplyr.html#cb349-2"></a><span class="co">#&gt; # A tibble: 1,458 × 2</span></span>
<span id="cb349-3"><a href="10-dplyr.html#cb349-3"></a><span class="co">#&gt;      lat    lon</span></span>
<span id="cb349-4"><a href="10-dplyr.html#cb349-4"></a><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb349-5"><a href="10-dplyr.html#cb349-5"></a><span class="co">#&gt;  1  41.1  -80.6</span></span>
<span id="cb349-6"><a href="10-dplyr.html#cb349-6"></a><span class="co">#&gt;  2  32.5  -85.7</span></span>
<span id="cb349-7"><a href="10-dplyr.html#cb349-7"></a><span class="co">#&gt;  3  42.0  -88.1</span></span>
<span id="cb349-8"><a href="10-dplyr.html#cb349-8"></a><span class="co">#&gt;  4  41.4  -74.4</span></span>
<span id="cb349-9"><a href="10-dplyr.html#cb349-9"></a><span class="co">#&gt;  5  31.1  -81.4</span></span>
<span id="cb349-10"><a href="10-dplyr.html#cb349-10"></a><span class="co">#&gt;  6  36.4  -82.2</span></span>
<span id="cb349-11"><a href="10-dplyr.html#cb349-11"></a><span class="co">#&gt;  7  41.5  -84.5</span></span>
<span id="cb349-12"><a href="10-dplyr.html#cb349-12"></a><span class="co">#&gt;  8  42.9  -76.8</span></span>
<span id="cb349-13"><a href="10-dplyr.html#cb349-13"></a><span class="co">#&gt;  9  39.8  -76.6</span></span>
<span id="cb349-14"><a href="10-dplyr.html#cb349-14"></a><span class="co">#&gt; 10  48.1 -123. </span></span>
<span id="cb349-15"><a href="10-dplyr.html#cb349-15"></a><span class="co">#&gt; # … with 1,448 more rows</span></span></code></pre></div>
<p>Si on fait précéder le nom d’un <code>-</code>, la colonne est éliminée plutôt que sélectionnée :</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="10-dplyr.html#cb350-1"></a><span class="kw">select</span>(airports, <span class="op">-</span>lat, <span class="op">-</span>lon)</span>
<span id="cb350-2"><a href="10-dplyr.html#cb350-2"></a><span class="co">#&gt; # A tibble: 1,458 × 6</span></span>
<span id="cb350-3"><a href="10-dplyr.html#cb350-3"></a><span class="co">#&gt;    faa   name                             alt    tz dst   tzone              </span></span>
<span id="cb350-4"><a href="10-dplyr.html#cb350-4"></a><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              </span></span>
<span id="cb350-5"><a href="10-dplyr.html#cb350-5"></a><span class="co">#&gt;  1 04G   Lansdowne Airport               1044    -5 A     America/New_York   </span></span>
<span id="cb350-6"><a href="10-dplyr.html#cb350-6"></a><span class="co">#&gt;  2 06A   Moton Field Municipal Airport    264    -6 A     America/Chicago    </span></span>
<span id="cb350-7"><a href="10-dplyr.html#cb350-7"></a><span class="co">#&gt;  3 06C   Schaumburg Regional              801    -6 A     America/Chicago    </span></span>
<span id="cb350-8"><a href="10-dplyr.html#cb350-8"></a><span class="co">#&gt;  4 06N   Randall Airport                  523    -5 A     America/New_York   </span></span>
<span id="cb350-9"><a href="10-dplyr.html#cb350-9"></a><span class="co">#&gt;  5 09J   Jekyll Island Airport             11    -5 A     America/New_York   </span></span>
<span id="cb350-10"><a href="10-dplyr.html#cb350-10"></a><span class="co">#&gt;  6 0A9   Elizabethton Municipal Airport  1593    -5 A     America/New_York   </span></span>
<span id="cb350-11"><a href="10-dplyr.html#cb350-11"></a><span class="co">#&gt;  7 0G6   Williams County Airport          730    -5 A     America/New_York   </span></span>
<span id="cb350-12"><a href="10-dplyr.html#cb350-12"></a><span class="co">#&gt;  8 0G7   Finger Lakes Regional Airport    492    -5 A     America/New_York   </span></span>
<span id="cb350-13"><a href="10-dplyr.html#cb350-13"></a><span class="co">#&gt;  9 0P2   Shoestring Aviation Airfield    1000    -5 U     America/New_York   </span></span>
<span id="cb350-14"><a href="10-dplyr.html#cb350-14"></a><span class="co">#&gt; 10 0S9   Jefferson County Intl            108    -8 A     America/Los_Angeles</span></span>
<span id="cb350-15"><a href="10-dplyr.html#cb350-15"></a><span class="co">#&gt; # … with 1,448 more rows</span></span></code></pre></div>
<p><code>select</code> comprend toute une série de fonctions facilitant la sélection de colonnes multiples. Par exemple, <code>starts_with</code>, <code>ends_width</code>, <code>contains</code> ou <code>matches</code> permettent d’exprimer des conditions sur les noms de variables :</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="10-dplyr.html#cb351-1"></a><span class="kw">select</span>(flights, <span class="kw">starts_with</span>(<span class="st">&quot;dep_&quot;</span>))</span>
<span id="cb351-2"><a href="10-dplyr.html#cb351-2"></a><span class="co">#&gt; # A tibble: 336,776 × 2</span></span>
<span id="cb351-3"><a href="10-dplyr.html#cb351-3"></a><span class="co">#&gt;    dep_time dep_delay</span></span>
<span id="cb351-4"><a href="10-dplyr.html#cb351-4"></a><span class="co">#&gt;       &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb351-5"><a href="10-dplyr.html#cb351-5"></a><span class="co">#&gt;  1      517         2</span></span>
<span id="cb351-6"><a href="10-dplyr.html#cb351-6"></a><span class="co">#&gt;  2      533         4</span></span>
<span id="cb351-7"><a href="10-dplyr.html#cb351-7"></a><span class="co">#&gt;  3      542         2</span></span>
<span id="cb351-8"><a href="10-dplyr.html#cb351-8"></a><span class="co">#&gt;  4      544        -1</span></span>
<span id="cb351-9"><a href="10-dplyr.html#cb351-9"></a><span class="co">#&gt;  5      554        -6</span></span>
<span id="cb351-10"><a href="10-dplyr.html#cb351-10"></a><span class="co">#&gt;  6      554        -4</span></span>
<span id="cb351-11"><a href="10-dplyr.html#cb351-11"></a><span class="co">#&gt;  7      555        -5</span></span>
<span id="cb351-12"><a href="10-dplyr.html#cb351-12"></a><span class="co">#&gt;  8      557        -3</span></span>
<span id="cb351-13"><a href="10-dplyr.html#cb351-13"></a><span class="co">#&gt;  9      557        -3</span></span>
<span id="cb351-14"><a href="10-dplyr.html#cb351-14"></a><span class="co">#&gt; 10      558        -2</span></span>
<span id="cb351-15"><a href="10-dplyr.html#cb351-15"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>La syntaxe <code>colonne1:colonne2</code> permet de sélectionner toutes les colonnes situées entre <code>colonne1</code> et <code>colonne2</code> incluses<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> :</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="10-dplyr.html#cb352-1"></a><span class="kw">select</span>(flights, year<span class="op">:</span>day)</span>
<span id="cb352-2"><a href="10-dplyr.html#cb352-2"></a><span class="co">#&gt; # A tibble: 336,776 × 3</span></span>
<span id="cb352-3"><a href="10-dplyr.html#cb352-3"></a><span class="co">#&gt;     year month   day</span></span>
<span id="cb352-4"><a href="10-dplyr.html#cb352-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb352-5"><a href="10-dplyr.html#cb352-5"></a><span class="co">#&gt;  1  2013     1     1</span></span>
<span id="cb352-6"><a href="10-dplyr.html#cb352-6"></a><span class="co">#&gt;  2  2013     1     1</span></span>
<span id="cb352-7"><a href="10-dplyr.html#cb352-7"></a><span class="co">#&gt;  3  2013     1     1</span></span>
<span id="cb352-8"><a href="10-dplyr.html#cb352-8"></a><span class="co">#&gt;  4  2013     1     1</span></span>
<span id="cb352-9"><a href="10-dplyr.html#cb352-9"></a><span class="co">#&gt;  5  2013     1     1</span></span>
<span id="cb352-10"><a href="10-dplyr.html#cb352-10"></a><span class="co">#&gt;  6  2013     1     1</span></span>
<span id="cb352-11"><a href="10-dplyr.html#cb352-11"></a><span class="co">#&gt;  7  2013     1     1</span></span>
<span id="cb352-12"><a href="10-dplyr.html#cb352-12"></a><span class="co">#&gt;  8  2013     1     1</span></span>
<span id="cb352-13"><a href="10-dplyr.html#cb352-13"></a><span class="co">#&gt;  9  2013     1     1</span></span>
<span id="cb352-14"><a href="10-dplyr.html#cb352-14"></a><span class="co">#&gt; 10  2013     1     1</span></span>
<span id="cb352-15"><a href="10-dplyr.html#cb352-15"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>Une variante de <code>select</code> est <code>rename</code><a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>, qui permet de renommer des colonnes. On l’utilise en lui passant des paramètres de la forme <code>nouveau_nom = ancien_nom</code>. Ainsi, si on veut renommer les colonnes <code>lon</code> et <code>lat</code> de <code>airports</code> en <code>longitude</code> et <code>latitude</code> :</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="10-dplyr.html#cb353-1"></a><span class="kw">rename</span>(airports, <span class="dt">longitude =</span> lon, <span class="dt">latitude =</span> lat)</span>
<span id="cb353-2"><a href="10-dplyr.html#cb353-2"></a><span class="co">#&gt; # A tibble: 1,458 × 8</span></span>
<span id="cb353-3"><a href="10-dplyr.html#cb353-3"></a><span class="co">#&gt;    faa   name                 latitude longitude   alt    tz dst   tzone        </span></span>
<span id="cb353-4"><a href="10-dplyr.html#cb353-4"></a><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        </span></span>
<span id="cb353-5"><a href="10-dplyr.html#cb353-5"></a><span class="co">#&gt;  1 04G   Lansdowne Airport        41.1     -80.6  1044    -5 A     America/New_…</span></span>
<span id="cb353-6"><a href="10-dplyr.html#cb353-6"></a><span class="co">#&gt;  2 06A   Moton Field Municip…     32.5     -85.7   264    -6 A     America/Chic…</span></span>
<span id="cb353-7"><a href="10-dplyr.html#cb353-7"></a><span class="co">#&gt;  3 06C   Schaumburg Regional      42.0     -88.1   801    -6 A     America/Chic…</span></span>
<span id="cb353-8"><a href="10-dplyr.html#cb353-8"></a><span class="co">#&gt;  4 06N   Randall Airport          41.4     -74.4   523    -5 A     America/New_…</span></span>
<span id="cb353-9"><a href="10-dplyr.html#cb353-9"></a><span class="co">#&gt;  5 09J   Jekyll Island Airpo…     31.1     -81.4    11    -5 A     America/New_…</span></span>
<span id="cb353-10"><a href="10-dplyr.html#cb353-10"></a><span class="co">#&gt;  6 0A9   Elizabethton Munici…     36.4     -82.2  1593    -5 A     America/New_…</span></span>
<span id="cb353-11"><a href="10-dplyr.html#cb353-11"></a><span class="co">#&gt;  7 0G6   Williams County Air…     41.5     -84.5   730    -5 A     America/New_…</span></span>
<span id="cb353-12"><a href="10-dplyr.html#cb353-12"></a><span class="co">#&gt;  8 0G7   Finger Lakes Region…     42.9     -76.8   492    -5 A     America/New_…</span></span>
<span id="cb353-13"><a href="10-dplyr.html#cb353-13"></a><span class="co">#&gt;  9 0P2   Shoestring Aviation…     39.8     -76.6  1000    -5 U     America/New_…</span></span>
<span id="cb353-14"><a href="10-dplyr.html#cb353-14"></a><span class="co">#&gt; 10 0S9   Jefferson County In…     48.1    -123.    108    -8 A     America/Los_…</span></span>
<span id="cb353-15"><a href="10-dplyr.html#cb353-15"></a><span class="co">#&gt; # … with 1,448 more rows</span></span></code></pre></div>
<p>Si les noms de colonnes comportent des espaces ou des caractères spéciaux, on peut les entourer de guillemets (<code>"</code>) ou de quotes inverses (<code>`</code>) :</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="10-dplyr.html#cb354-1"></a>tmp &lt;-<span class="st"> </span><span class="kw">rename</span>(</span>
<span id="cb354-2"><a href="10-dplyr.html#cb354-2"></a>    flights,</span>
<span id="cb354-3"><a href="10-dplyr.html#cb354-3"></a>    <span class="st">&quot;retard départ&quot;</span> =<span class="st"> </span>dep_delay,</span>
<span id="cb354-4"><a href="10-dplyr.html#cb354-4"></a>    <span class="st">&quot;retard arrivée&quot;</span> =<span class="st"> </span>arr_delay</span>
<span id="cb354-5"><a href="10-dplyr.html#cb354-5"></a>)</span>
<span id="cb354-6"><a href="10-dplyr.html#cb354-6"></a><span class="kw">select</span>(tmp, <span class="st">`</span><span class="dt">retard départ</span><span class="st">`</span>, <span class="st">`</span><span class="dt">retard arrivée</span><span class="st">`</span>)</span>
<span id="cb354-7"><a href="10-dplyr.html#cb354-7"></a><span class="co">#&gt; # A tibble: 336,776 × 2</span></span>
<span id="cb354-8"><a href="10-dplyr.html#cb354-8"></a><span class="co">#&gt;    `retard départ` `retard arrivée`</span></span>
<span id="cb354-9"><a href="10-dplyr.html#cb354-9"></a><span class="co">#&gt;              &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb354-10"><a href="10-dplyr.html#cb354-10"></a><span class="co">#&gt;  1               2               11</span></span>
<span id="cb354-11"><a href="10-dplyr.html#cb354-11"></a><span class="co">#&gt;  2               4               20</span></span>
<span id="cb354-12"><a href="10-dplyr.html#cb354-12"></a><span class="co">#&gt;  3               2               33</span></span>
<span id="cb354-13"><a href="10-dplyr.html#cb354-13"></a><span class="co">#&gt;  4              -1              -18</span></span>
<span id="cb354-14"><a href="10-dplyr.html#cb354-14"></a><span class="co">#&gt;  5              -6              -25</span></span>
<span id="cb354-15"><a href="10-dplyr.html#cb354-15"></a><span class="co">#&gt;  6              -4               12</span></span>
<span id="cb354-16"><a href="10-dplyr.html#cb354-16"></a><span class="co">#&gt;  7              -5               19</span></span>
<span id="cb354-17"><a href="10-dplyr.html#cb354-17"></a><span class="co">#&gt;  8              -3              -14</span></span>
<span id="cb354-18"><a href="10-dplyr.html#cb354-18"></a><span class="co">#&gt;  9              -3               -8</span></span>
<span id="cb354-19"><a href="10-dplyr.html#cb354-19"></a><span class="co">#&gt; 10              -2                8</span></span>
<span id="cb354-20"><a href="10-dplyr.html#cb354-20"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
</div>
<div id="arrange" class="section level3">
<h3><span class="header-section-number">10.2.4</span> <code>arrange</code></h3>
<p><code>arrange</code> réordonne les lignes d’un tableau selon une ou plusieurs colonnes.</p>
<p>Ainsi, si on veut trier le tableau <code>flights</code> selon le retard au départ croissant :</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="10-dplyr.html#cb355-1"></a><span class="kw">arrange</span>(flights, dep_delay)</span>
<span id="cb355-2"><a href="10-dplyr.html#cb355-2"></a><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span id="cb355-3"><a href="10-dplyr.html#cb355-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb355-4"><a href="10-dplyr.html#cb355-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb355-5"><a href="10-dplyr.html#cb355-5"></a><span class="co">#&gt;  1  2013    12     7     2040           2123       -43       40           2352</span></span>
<span id="cb355-6"><a href="10-dplyr.html#cb355-6"></a><span class="co">#&gt;  2  2013     2     3     2022           2055       -33     2240           2338</span></span>
<span id="cb355-7"><a href="10-dplyr.html#cb355-7"></a><span class="co">#&gt;  3  2013    11    10     1408           1440       -32     1549           1559</span></span>
<span id="cb355-8"><a href="10-dplyr.html#cb355-8"></a><span class="co">#&gt;  4  2013     1    11     1900           1930       -30     2233           2243</span></span>
<span id="cb355-9"><a href="10-dplyr.html#cb355-9"></a><span class="co">#&gt;  5  2013     1    29     1703           1730       -27     1947           1957</span></span>
<span id="cb355-10"><a href="10-dplyr.html#cb355-10"></a><span class="co">#&gt;  6  2013     8     9      729            755       -26     1002            955</span></span>
<span id="cb355-11"><a href="10-dplyr.html#cb355-11"></a><span class="co">#&gt;  7  2013    10    23     1907           1932       -25     2143           2143</span></span>
<span id="cb355-12"><a href="10-dplyr.html#cb355-12"></a><span class="co">#&gt;  8  2013     3    30     2030           2055       -25     2213           2250</span></span>
<span id="cb355-13"><a href="10-dplyr.html#cb355-13"></a><span class="co">#&gt;  9  2013     3     2     1431           1455       -24     1601           1631</span></span>
<span id="cb355-14"><a href="10-dplyr.html#cb355-14"></a><span class="co">#&gt; 10  2013     5     5      934            958       -24     1225           1309</span></span>
<span id="cb355-15"><a href="10-dplyr.html#cb355-15"></a><span class="co">#&gt; # … with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb355-16"><a href="10-dplyr.html#cb355-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb355-17"><a href="10-dplyr.html#cb355-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>On peut trier selon plusieurs colonnes. Par exemple selon le mois, puis selon le retard au départ :</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="10-dplyr.html#cb356-1"></a><span class="kw">arrange</span>(flights, month, dep_delay)</span>
<span id="cb356-2"><a href="10-dplyr.html#cb356-2"></a><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span id="cb356-3"><a href="10-dplyr.html#cb356-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb356-4"><a href="10-dplyr.html#cb356-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb356-5"><a href="10-dplyr.html#cb356-5"></a><span class="co">#&gt;  1  2013     1    11     1900           1930       -30     2233           2243</span></span>
<span id="cb356-6"><a href="10-dplyr.html#cb356-6"></a><span class="co">#&gt;  2  2013     1    29     1703           1730       -27     1947           1957</span></span>
<span id="cb356-7"><a href="10-dplyr.html#cb356-7"></a><span class="co">#&gt;  3  2013     1    12     1354           1416       -22     1606           1650</span></span>
<span id="cb356-8"><a href="10-dplyr.html#cb356-8"></a><span class="co">#&gt;  4  2013     1    21     2137           2159       -22     2232           2316</span></span>
<span id="cb356-9"><a href="10-dplyr.html#cb356-9"></a><span class="co">#&gt;  5  2013     1    20      704            725       -21     1025           1035</span></span>
<span id="cb356-10"><a href="10-dplyr.html#cb356-10"></a><span class="co">#&gt;  6  2013     1    12     2050           2110       -20     2310           2355</span></span>
<span id="cb356-11"><a href="10-dplyr.html#cb356-11"></a><span class="co">#&gt;  7  2013     1    12     2134           2154       -20        4             50</span></span>
<span id="cb356-12"><a href="10-dplyr.html#cb356-12"></a><span class="co">#&gt;  8  2013     1    14     2050           2110       -20     2329           2355</span></span>
<span id="cb356-13"><a href="10-dplyr.html#cb356-13"></a><span class="co">#&gt;  9  2013     1     4     2140           2159       -19     2241           2316</span></span>
<span id="cb356-14"><a href="10-dplyr.html#cb356-14"></a><span class="co">#&gt; 10  2013     1    11     1947           2005       -18     2209           2230</span></span>
<span id="cb356-15"><a href="10-dplyr.html#cb356-15"></a><span class="co">#&gt; # … with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb356-16"><a href="10-dplyr.html#cb356-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb356-17"><a href="10-dplyr.html#cb356-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>Si on veut trier selon une colonne par ordre décroissant, on lui applique la fonction <code>desc()</code> :</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="10-dplyr.html#cb357-1"></a><span class="kw">arrange</span>(flights, <span class="kw">desc</span>(dep_delay))</span>
<span id="cb357-2"><a href="10-dplyr.html#cb357-2"></a><span class="co">#&gt; # A tibble: 336,776 × 19</span></span>
<span id="cb357-3"><a href="10-dplyr.html#cb357-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb357-4"><a href="10-dplyr.html#cb357-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb357-5"><a href="10-dplyr.html#cb357-5"></a><span class="co">#&gt;  1  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb357-6"><a href="10-dplyr.html#cb357-6"></a><span class="co">#&gt;  2  2013     6    15     1432           1935      1137     1607           2120</span></span>
<span id="cb357-7"><a href="10-dplyr.html#cb357-7"></a><span class="co">#&gt;  3  2013     1    10     1121           1635      1126     1239           1810</span></span>
<span id="cb357-8"><a href="10-dplyr.html#cb357-8"></a><span class="co">#&gt;  4  2013     9    20     1139           1845      1014     1457           2210</span></span>
<span id="cb357-9"><a href="10-dplyr.html#cb357-9"></a><span class="co">#&gt;  5  2013     7    22      845           1600      1005     1044           1815</span></span>
<span id="cb357-10"><a href="10-dplyr.html#cb357-10"></a><span class="co">#&gt;  6  2013     4    10     1100           1900       960     1342           2211</span></span>
<span id="cb357-11"><a href="10-dplyr.html#cb357-11"></a><span class="co">#&gt;  7  2013     3    17     2321            810       911      135           1020</span></span>
<span id="cb357-12"><a href="10-dplyr.html#cb357-12"></a><span class="co">#&gt;  8  2013     6    27      959           1900       899     1236           2226</span></span>
<span id="cb357-13"><a href="10-dplyr.html#cb357-13"></a><span class="co">#&gt;  9  2013     7    22     2257            759       898      121           1026</span></span>
<span id="cb357-14"><a href="10-dplyr.html#cb357-14"></a><span class="co">#&gt; 10  2013    12     5      756           1700       896     1058           2020</span></span>
<span id="cb357-15"><a href="10-dplyr.html#cb357-15"></a><span class="co">#&gt; # … with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb357-16"><a href="10-dplyr.html#cb357-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb357-17"><a href="10-dplyr.html#cb357-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>Combiné avec <code>slice</code>, <code>arrange</code> permet par exemple de sélectionner les trois vols ayant eu le plus de retard :</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="10-dplyr.html#cb358-1"></a>tmp &lt;-<span class="st"> </span><span class="kw">arrange</span>(flights, <span class="kw">desc</span>(dep_delay))</span>
<span id="cb358-2"><a href="10-dplyr.html#cb358-2"></a><span class="kw">slice</span>(tmp, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb358-3"><a href="10-dplyr.html#cb358-3"></a><span class="co">#&gt; # A tibble: 3 × 19</span></span>
<span id="cb358-4"><a href="10-dplyr.html#cb358-4"></a><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb358-5"><a href="10-dplyr.html#cb358-5"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb358-6"><a href="10-dplyr.html#cb358-6"></a><span class="co">#&gt; 1  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb358-7"><a href="10-dplyr.html#cb358-7"></a><span class="co">#&gt; 2  2013     6    15     1432           1935      1137     1607           2120</span></span>
<span id="cb358-8"><a href="10-dplyr.html#cb358-8"></a><span class="co">#&gt; 3  2013     1    10     1121           1635      1126     1239           1810</span></span>
<span id="cb358-9"><a href="10-dplyr.html#cb358-9"></a><span class="co">#&gt; # … with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,</span></span>
<span id="cb358-10"><a href="10-dplyr.html#cb358-10"></a><span class="co">#&gt; #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,</span></span>
<span id="cb358-11"><a href="10-dplyr.html#cb358-11"></a><span class="co">#&gt; #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
</div>
<div id="mutate" class="section level3">
<h3><span class="header-section-number">10.2.5</span> <code>mutate</code></h3>
<p><code>mutate</code> permet de créer de nouvelles colonnes dans le tableau de données, en général à partir de variables existantes.</p>
<p>Par exemple, la table <code>flights</code> contient la durée du vol en minutes.. Si on veut créer une nouvelle variable <code>duree_h</code> avec cette durée en heures, on peut faire :</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="10-dplyr.html#cb359-1"></a>flights &lt;-<span class="st"> </span><span class="kw">mutate</span>(flights, <span class="dt">duree_h =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>)</span>
<span id="cb359-2"><a href="10-dplyr.html#cb359-2"></a></span>
<span id="cb359-3"><a href="10-dplyr.html#cb359-3"></a><span class="kw">select</span>(flights, air_time, duree_h)</span>
<span id="cb359-4"><a href="10-dplyr.html#cb359-4"></a><span class="co">#&gt; # A tibble: 336,776 × 2</span></span>
<span id="cb359-5"><a href="10-dplyr.html#cb359-5"></a><span class="co">#&gt;    air_time duree_h</span></span>
<span id="cb359-6"><a href="10-dplyr.html#cb359-6"></a><span class="co">#&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb359-7"><a href="10-dplyr.html#cb359-7"></a><span class="co">#&gt;  1      227   3.78 </span></span>
<span id="cb359-8"><a href="10-dplyr.html#cb359-8"></a><span class="co">#&gt;  2      227   3.78 </span></span>
<span id="cb359-9"><a href="10-dplyr.html#cb359-9"></a><span class="co">#&gt;  3      160   2.67 </span></span>
<span id="cb359-10"><a href="10-dplyr.html#cb359-10"></a><span class="co">#&gt;  4      183   3.05 </span></span>
<span id="cb359-11"><a href="10-dplyr.html#cb359-11"></a><span class="co">#&gt;  5      116   1.93 </span></span>
<span id="cb359-12"><a href="10-dplyr.html#cb359-12"></a><span class="co">#&gt;  6      150   2.5  </span></span>
<span id="cb359-13"><a href="10-dplyr.html#cb359-13"></a><span class="co">#&gt;  7      158   2.63 </span></span>
<span id="cb359-14"><a href="10-dplyr.html#cb359-14"></a><span class="co">#&gt;  8       53   0.883</span></span>
<span id="cb359-15"><a href="10-dplyr.html#cb359-15"></a><span class="co">#&gt;  9      140   2.33 </span></span>
<span id="cb359-16"><a href="10-dplyr.html#cb359-16"></a><span class="co">#&gt; 10      138   2.3  </span></span>
<span id="cb359-17"><a href="10-dplyr.html#cb359-17"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>On peut créer plusieurs nouvelles colonnes en une seule commande, et les expressions successives peuvent prendre en compte les résultats des calculs précédents. L’exemple suivant convertit d’abord la durée en heures dans une variable <code>duree_h</code> et la distance en kilomètres dans une variable <code>distance_km</code>, puis utilise ces nouvelles colonnes pour calculer la vitesse en km/h.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="10-dplyr.html#cb360-1"></a>flights &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb360-2"><a href="10-dplyr.html#cb360-2"></a>    flights,</span>
<span id="cb360-3"><a href="10-dplyr.html#cb360-3"></a>    <span class="dt">duree_h =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,</span>
<span id="cb360-4"><a href="10-dplyr.html#cb360-4"></a>    <span class="dt">distance_km =</span> distance <span class="op">/</span><span class="st"> </span><span class="fl">0.62137</span>,</span>
<span id="cb360-5"><a href="10-dplyr.html#cb360-5"></a>    <span class="dt">vitesse =</span> distance_km <span class="op">/</span><span class="st"> </span>duree_h</span>
<span id="cb360-6"><a href="10-dplyr.html#cb360-6"></a>)</span>
<span id="cb360-7"><a href="10-dplyr.html#cb360-7"></a></span>
<span id="cb360-8"><a href="10-dplyr.html#cb360-8"></a><span class="kw">select</span>(flights, air_time, duree_h, distance, distance_km, vitesse)</span>
<span id="cb360-9"><a href="10-dplyr.html#cb360-9"></a><span class="co">#&gt; # A tibble: 336,776 × 5</span></span>
<span id="cb360-10"><a href="10-dplyr.html#cb360-10"></a><span class="co">#&gt;    air_time duree_h distance distance_km vitesse</span></span>
<span id="cb360-11"><a href="10-dplyr.html#cb360-11"></a><span class="co">#&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb360-12"><a href="10-dplyr.html#cb360-12"></a><span class="co">#&gt;  1      227   3.78      1400       2253.    596.</span></span>
<span id="cb360-13"><a href="10-dplyr.html#cb360-13"></a><span class="co">#&gt;  2      227   3.78      1416       2279.    602.</span></span>
<span id="cb360-14"><a href="10-dplyr.html#cb360-14"></a><span class="co">#&gt;  3      160   2.67      1089       1753.    657.</span></span>
<span id="cb360-15"><a href="10-dplyr.html#cb360-15"></a><span class="co">#&gt;  4      183   3.05      1576       2536.    832.</span></span>
<span id="cb360-16"><a href="10-dplyr.html#cb360-16"></a><span class="co">#&gt;  5      116   1.93       762       1226.    634.</span></span>
<span id="cb360-17"><a href="10-dplyr.html#cb360-17"></a><span class="co">#&gt;  6      150   2.5        719       1157.    463.</span></span>
<span id="cb360-18"><a href="10-dplyr.html#cb360-18"></a><span class="co">#&gt;  7      158   2.63      1065       1714.    651.</span></span>
<span id="cb360-19"><a href="10-dplyr.html#cb360-19"></a><span class="co">#&gt;  8       53   0.883      229        369.    417.</span></span>
<span id="cb360-20"><a href="10-dplyr.html#cb360-20"></a><span class="co">#&gt;  9      140   2.33       944       1519.    651.</span></span>
<span id="cb360-21"><a href="10-dplyr.html#cb360-21"></a><span class="co">#&gt; 10      138   2.3        733       1180.    513.</span></span>
<span id="cb360-22"><a href="10-dplyr.html#cb360-22"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>À noter que <code>mutate</code> est évidemment parfaitement compatible avec les fonctions vues dans le chapitre <a href="09-recodages.html#vectorfactor">9</a> sur les recodages : <code>fct_recode</code>, <code>if_else</code>, <code>case_when</code>…</p>
<p>L’avantage d’utiliser <code>mutate</code> est double. D’abord il permet d’éviter d’avoir à saisir le nom du tableau de données dans les conditions d’un <code>if_else</code> ou d’un <code>case_when</code> :</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="10-dplyr.html#cb361-1"></a>flights &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb361-2"><a href="10-dplyr.html#cb361-2"></a>    flights,</span>
<span id="cb361-3"><a href="10-dplyr.html#cb361-3"></a>    <span class="dt">type_retard =</span> <span class="kw">case_when</span>(</span>
<span id="cb361-4"><a href="10-dplyr.html#cb361-4"></a>        dep_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Retard départ et arrivée&quot;</span>,</span>
<span id="cb361-5"><a href="10-dplyr.html#cb361-5"></a>        dep_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>arr_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Retard départ&quot;</span>,</span>
<span id="cb361-6"><a href="10-dplyr.html#cb361-6"></a>        dep_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Retard arrivée&quot;</span>,</span>
<span id="cb361-7"><a href="10-dplyr.html#cb361-7"></a>        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Aucun retard&quot;</span></span>
<span id="cb361-8"><a href="10-dplyr.html#cb361-8"></a>    )</span>
<span id="cb361-9"><a href="10-dplyr.html#cb361-9"></a>)</span></code></pre></div>
<p>Ensuite, il permet aussi d’intégrer ces recodages dans un <em>pipeline</em> de traitement de données, concept présenté dans la section suivante.</p>
</div>
</div>
<div id="pipe" class="section level2">
<h2><span class="header-section-number">10.3</span> Enchaîner les opérations avec le <em>pipe</em></h2>
<p>Quand on manipule un tableau de données, il est très fréquent d’enchaîner plusieurs opérations. On va par exemple extraire une sous-population avec <code>filter</code>, sélectionner des colonnes avec <code>select</code> puis trier selon une variable avec <code>arrange</code>, etc.</p>
<p>Quand on veut enchaîner des opérations, on peut le faire de différentes manières. La première est d’effectuer toutes les opérations en une fois en les “emboîtant” :</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="10-dplyr.html#cb362-1"></a><span class="kw">arrange</span>(<span class="kw">select</span>(<span class="kw">filter</span>(flights, dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>), dep_delay, arr_delay), dep_delay)</span></code></pre></div>
<p>Cette notation a plusieurs inconvénients :</p>
<ul>
<li>elle est peu lisible</li>
<li>les opérations apparaissent dans l’ordre inverse de leur réalisation. Ici on effectue d’abord le <code>filter</code>, puis le <code>select</code>, puis le <code>arrange</code>, alors qu’à la lecture du code c’est le <code>arrange</code> qui apparaît en premier.</li>
<li>Il est difficile de voir quel paramètre se rapporte à quelle fonction</li>
</ul>
<p>Une autre manière de faire est d’effectuer les opérations les unes après les autres, en stockant les résultats intermédiaires dans un objet temporaire :</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="10-dplyr.html#cb363-1"></a>tmp &lt;-<span class="st"> </span><span class="kw">filter</span>(flights, dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>)</span>
<span id="cb363-2"><a href="10-dplyr.html#cb363-2"></a>tmp &lt;-<span class="st"> </span><span class="kw">select</span>(tmp, dep_delay, arr_delay)</span>
<span id="cb363-3"><a href="10-dplyr.html#cb363-3"></a><span class="kw">arrange</span>(tmp, dep_delay)</span></code></pre></div>
<p>C’est nettement plus lisible, l’ordre des opérations est le bon, et les paramètres sont bien rattachés à leur fonction. Par contre, ça reste un peu “verbeux”, et on crée un objet temporaire <code>tmp</code> dont on n’a pas réellement besoin.</p>
<p>Pour simplifier et améliorer encore la lisibilité du code, on va utiliser un nouvel opérateur, baptisé <em>pipe</em><a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>. Le <em>pipe</em> se note <code>%&gt;%</code>, et son fonctionnement est le suivant : si j’exécute <code>expr %&gt;% f</code>, alors le résultat de l’expression <code>expr</code>, à gauche du <em>pipe</em>, sera passé comme premier argument à la fonction <code>f</code>, à droite du <em>pipe</em>, ce qui revient à exécuter <code>f(expr)</code>.</p>
<p>Ainsi les deux expressions suivantes sont rigoureusement équivalentes :</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="10-dplyr.html#cb364-1"></a><span class="kw">filter</span>(flights, dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="10-dplyr.html#cb365-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>)</span></code></pre></div>
<p>Ce qui est intéressant dans cette histoire, c’est qu’on va pouvoir enchaîner les <em>pipes</em>. Plutôt que d’écrire :</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="10-dplyr.html#cb366-1"></a><span class="kw">select</span>(<span class="kw">filter</span>(flights, dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>), dep_delay, arr_delay)</span></code></pre></div>
<p>On va pouvoir faire :</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="10-dplyr.html#cb367-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(dep_delay, arr_delay)</span></code></pre></div>
<p>À chaque fois, le résultat de ce qui se trouve à gauche du <em>pipe</em> est passé comme premier argument à ce qui se trouve à droite : on part de l’objet <code>flights</code>, qu’on passe comme premier argument à la fonction <code>filter</code>, puis on passe le résultat de ce <code>filter</code> comme premier argument du <code>select</code>.</p>
<p>Le résultat final est le même avec les deux syntaxes, mais avec le <em>pipe</em> l’ordre des opérations correspond à l’ordre naturel de leur exécution, et on n’a pas eu besoin de créer d’objet intermédiaire.</p>
<p>Si la liste des fonctions enchaînées est longue, on peut les répartir sur plusieurs lignes à condition que l’opérateur <code>%&gt;%</code> soit en fin de ligne :</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="10-dplyr.html#cb368-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb368-2"><a href="10-dplyr.html#cb368-2"></a><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb368-3"><a href="10-dplyr.html#cb368-3"></a><span class="st">  </span><span class="kw">select</span>(dep_delay, arr_delay) <span class="op">%&gt;%</span></span>
<span id="cb368-4"><a href="10-dplyr.html#cb368-4"></a><span class="st">  </span><span class="kw">arrange</span>(dep_delay)</span></code></pre></div>
<div class="rmdnote">
<p>
On appelle une suite d’instructions de ce type un <em>pipeline</em>.
</p>
</div>
<p>Évidemment, il est naturel de vouloir récupérer le résultat final d’un <em>pipeline</em> pour le stocker dans un objet. Par exemple, on peut stocker le résultat du <em>pipeline</em> ci-dessus dans un nouveau tableau <code>delay_la</code> de la manière suivante :</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="10-dplyr.html#cb369-1"></a>delay_la &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span></span>
<span id="cb369-2"><a href="10-dplyr.html#cb369-2"></a><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb369-3"><a href="10-dplyr.html#cb369-3"></a><span class="st">  </span><span class="kw">select</span>(dep_delay, arr_delay) <span class="op">%&gt;%</span></span>
<span id="cb369-4"><a href="10-dplyr.html#cb369-4"></a><span class="st">  </span><span class="kw">arrange</span>(dep_delay)</span></code></pre></div>
<p>Dans ce cas, <code>delay_la</code> contiendra le tableau final, obtenu après application des trois instructions <code>filter</code>, <code>select</code> et <code>arrange</code>.</p>
<p>Cette notation n’est pas forcément très intuitive au départ. Il faut bien comprendre que c’est le résultat final, une fois application de toutes les opérations du <em>pipeline</em>, qui est renvoyé et stocké dans l’objet en début de ligne.</p>
<p>Une manière de le comprendre peut être de voir que la notation suivante :</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="10-dplyr.html#cb370-1"></a>delay_la &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span></span>
<span id="cb370-2"><a href="10-dplyr.html#cb370-2"></a><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb370-3"><a href="10-dplyr.html#cb370-3"></a><span class="st">  </span><span class="kw">select</span>(dep_delay, arr_delay)</span></code></pre></div>
<p>est équivalente à :</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="10-dplyr.html#cb371-1"></a>delay_la &lt;-<span class="st"> </span>(flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(dep_delay, arr_delay))</span></code></pre></div>
<div class="rmdnote">
<p>
L’utilisation du <em>pipe</em> n’est pas obligatoire, mais elle rend les scripts plus lisibles et plus rapides à saisir. On l’utilisera donc dans ce qui suit.
</p>
</div>
<div class="rmdimportant">
<p>
Depuis la version 4.1, R propose un <em>pipe</em> “natif”, qui fonctionne partout, même si on n’utilise pas les extensions du <em>tidyverse</em>. Celui-ci est noté <code>|&gt;</code>.
</p>
<p>
Il s’utilise de la même manière que <code>%&gt;%</code> :
</p>
<p>
<code>flights |&gt; filter(dest == “LAX”)</code>
</p>
<p>
Ce <em>pipe</em> natif est à la fois un peu plus rapide et un peu moins souple. Par exemple, il est possible avec <code>%&gt;%</code> d’appeler une fonction sans mettre de parenthèses :
</p>
<p>
<code>df %&gt;% View</code>
</p>
<p>
Ce n’est pas possible d’omettre les parenthèses avec <code>|&gt;</code>, on doit obligatoirement faire :
</p>
<p>
<code>df |&gt; View()</code>
</p>
<p>
Dans la suite de ce document on privilégiera (pour l’instant) le <em>pipe</em> du <em>tidyverse</em> <code>%&gt;%</code>, pour des raisons de compatibilité avec des versions de R moins récentes.
</p>
</div>
</div>
<div id="opérations-groupées" class="section level2">
<h2><span class="header-section-number">10.4</span> Opérations groupées</h2>
<div id="group_by" class="section level3">
<h3><span class="header-section-number">10.4.1</span> <code>group_by</code></h3>
<p>Un élément très important de <code>dplyr</code> est la fonction <code>group_by</code>. Elle permet de définir des groupes de lignes à partir des valeurs d’une ou plusieurs colonnes. Par exemple, on peut grouper les vols selon leur mois :</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="10-dplyr.html#cb372-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(month)</span>
<span id="cb372-2"><a href="10-dplyr.html#cb372-2"></a><span class="co">#&gt; # A tibble: 336,776 × 22</span></span>
<span id="cb372-3"><a href="10-dplyr.html#cb372-3"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb372-4"><a href="10-dplyr.html#cb372-4"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb372-5"><a href="10-dplyr.html#cb372-5"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb372-6"><a href="10-dplyr.html#cb372-6"></a><span class="co">#&gt;  1  2013     1     1      517            515         2      830            819</span></span>
<span id="cb372-7"><a href="10-dplyr.html#cb372-7"></a><span class="co">#&gt;  2  2013     1     1      533            529         4      850            830</span></span>
<span id="cb372-8"><a href="10-dplyr.html#cb372-8"></a><span class="co">#&gt;  3  2013     1     1      542            540         2      923            850</span></span>
<span id="cb372-9"><a href="10-dplyr.html#cb372-9"></a><span class="co">#&gt;  4  2013     1     1      544            545        -1     1004           1022</span></span>
<span id="cb372-10"><a href="10-dplyr.html#cb372-10"></a><span class="co">#&gt;  5  2013     1     1      554            600        -6      812            837</span></span>
<span id="cb372-11"><a href="10-dplyr.html#cb372-11"></a><span class="co">#&gt;  6  2013     1     1      554            558        -4      740            728</span></span>
<span id="cb372-12"><a href="10-dplyr.html#cb372-12"></a><span class="co">#&gt;  7  2013     1     1      555            600        -5      913            854</span></span>
<span id="cb372-13"><a href="10-dplyr.html#cb372-13"></a><span class="co">#&gt;  8  2013     1     1      557            600        -3      709            723</span></span>
<span id="cb372-14"><a href="10-dplyr.html#cb372-14"></a><span class="co">#&gt;  9  2013     1     1      557            600        -3      838            846</span></span>
<span id="cb372-15"><a href="10-dplyr.html#cb372-15"></a><span class="co">#&gt; 10  2013     1     1      558            600        -2      753            745</span></span>
<span id="cb372-16"><a href="10-dplyr.html#cb372-16"></a><span class="co">#&gt; # … with 336,766 more rows, and 14 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb372-17"><a href="10-dplyr.html#cb372-17"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb372-18"><a href="10-dplyr.html#cb372-18"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,</span></span>
<span id="cb372-19"><a href="10-dplyr.html#cb372-19"></a><span class="co">#&gt; #   duree_h &lt;dbl&gt;, distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<p>Par défaut ceci ne fait rien de visible, à part l’apparition d’une mention <code>Groups</code> dans l’affichage du résultat. Mais à partir du moment où des groupes ont été définis, les verbes comme <code>slice</code>, <code>mutate</code> ou <code>summarise</code> vont en tenir compte lors de leurs opérations.</p>
<p>Par exemple, si on applique <code>slice</code> à un tableau préalablement groupé, il va sélectionner les lignes aux positions indiquées <em>pour chaque groupe</em>. Ainsi la commande suivante affiche le premier vol de chaque mois, selon leur ordre d’apparition dans le tableau :</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="10-dplyr.html#cb373-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>)</span>
<span id="cb373-2"><a href="10-dplyr.html#cb373-2"></a><span class="co">#&gt; # A tibble: 12 × 22</span></span>
<span id="cb373-3"><a href="10-dplyr.html#cb373-3"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb373-4"><a href="10-dplyr.html#cb373-4"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb373-5"><a href="10-dplyr.html#cb373-5"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb373-6"><a href="10-dplyr.html#cb373-6"></a><span class="co">#&gt;  1  2013     1     1      517            515         2      830            819</span></span>
<span id="cb373-7"><a href="10-dplyr.html#cb373-7"></a><span class="co">#&gt;  2  2013     2     1      456            500        -4      652            648</span></span>
<span id="cb373-8"><a href="10-dplyr.html#cb373-8"></a><span class="co">#&gt;  3  2013     3     1        4           2159       125      318             56</span></span>
<span id="cb373-9"><a href="10-dplyr.html#cb373-9"></a><span class="co">#&gt;  4  2013     4     1      454            500        -6      636            640</span></span>
<span id="cb373-10"><a href="10-dplyr.html#cb373-10"></a><span class="co">#&gt;  5  2013     5     1        9           1655       434      308           2020</span></span>
<span id="cb373-11"><a href="10-dplyr.html#cb373-11"></a><span class="co">#&gt;  6  2013     6     1        2           2359         3      341            350</span></span>
<span id="cb373-12"><a href="10-dplyr.html#cb373-12"></a><span class="co">#&gt;  7  2013     7     1        1           2029       212      236           2359</span></span>
<span id="cb373-13"><a href="10-dplyr.html#cb373-13"></a><span class="co">#&gt;  8  2013     8     1       12           2130       162      257             14</span></span>
<span id="cb373-14"><a href="10-dplyr.html#cb373-14"></a><span class="co">#&gt;  9  2013     9     1        9           2359        10      343            340</span></span>
<span id="cb373-15"><a href="10-dplyr.html#cb373-15"></a><span class="co">#&gt; 10  2013    10     1      447            500       -13      614            648</span></span>
<span id="cb373-16"><a href="10-dplyr.html#cb373-16"></a><span class="co">#&gt; 11  2013    11     1        5           2359         6      352            345</span></span>
<span id="cb373-17"><a href="10-dplyr.html#cb373-17"></a><span class="co">#&gt; 12  2013    12     1       13           2359        14      446            445</span></span>
<span id="cb373-18"><a href="10-dplyr.html#cb373-18"></a><span class="co">#&gt; # … with 14 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,</span></span>
<span id="cb373-19"><a href="10-dplyr.html#cb373-19"></a><span class="co">#&gt; #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,</span></span>
<span id="cb373-20"><a href="10-dplyr.html#cb373-20"></a><span class="co">#&gt; #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, duree_h &lt;dbl&gt;,</span></span>
<span id="cb373-21"><a href="10-dplyr.html#cb373-21"></a><span class="co">#&gt; #   distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<p>Idem pour <code>mutate</code> : les opérations appliquées lors du calcul des valeurs des nouvelles colonnes sont appliquées groupe de lignes par groupe de lignes. Dans l’exemple suivant, on ajoute une nouvelle colonne qui contient le retard moyen <em>pour chaque compagnie aérienne</em>. Cette valeur est donc différente d’une compagnie à une autre, mais identique pour tous les vols d’une même compagnie :</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="10-dplyr.html#cb374-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb374-2"><a href="10-dplyr.html#cb374-2"></a><span class="st">  </span><span class="kw">group_by</span>(carrier) <span class="op">%&gt;%</span></span>
<span id="cb374-3"><a href="10-dplyr.html#cb374-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mean_delay_carrier =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb374-4"><a href="10-dplyr.html#cb374-4"></a><span class="st">  </span><span class="kw">select</span>(dep_delay, month, mean_delay_carrier)</span>
<span id="cb374-5"><a href="10-dplyr.html#cb374-5"></a><span class="co">#&gt; Adding missing grouping variables: `carrier`</span></span>
<span id="cb374-6"><a href="10-dplyr.html#cb374-6"></a><span class="co">#&gt; # A tibble: 336,776 × 4</span></span>
<span id="cb374-7"><a href="10-dplyr.html#cb374-7"></a><span class="co">#&gt; # Groups:   carrier [16]</span></span>
<span id="cb374-8"><a href="10-dplyr.html#cb374-8"></a><span class="co">#&gt;    carrier dep_delay month mean_delay_carrier</span></span>
<span id="cb374-9"><a href="10-dplyr.html#cb374-9"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;              &lt;dbl&gt;</span></span>
<span id="cb374-10"><a href="10-dplyr.html#cb374-10"></a><span class="co">#&gt;  1 UA              2     1              12.1 </span></span>
<span id="cb374-11"><a href="10-dplyr.html#cb374-11"></a><span class="co">#&gt;  2 UA              4     1              12.1 </span></span>
<span id="cb374-12"><a href="10-dplyr.html#cb374-12"></a><span class="co">#&gt;  3 AA              2     1               8.59</span></span>
<span id="cb374-13"><a href="10-dplyr.html#cb374-13"></a><span class="co">#&gt;  4 B6             -1     1              13.0 </span></span>
<span id="cb374-14"><a href="10-dplyr.html#cb374-14"></a><span class="co">#&gt;  5 DL             -6     1               9.26</span></span>
<span id="cb374-15"><a href="10-dplyr.html#cb374-15"></a><span class="co">#&gt;  6 UA             -4     1              12.1 </span></span>
<span id="cb374-16"><a href="10-dplyr.html#cb374-16"></a><span class="co">#&gt;  7 B6             -5     1              13.0 </span></span>
<span id="cb374-17"><a href="10-dplyr.html#cb374-17"></a><span class="co">#&gt;  8 EV             -3     1              20.0 </span></span>
<span id="cb374-18"><a href="10-dplyr.html#cb374-18"></a><span class="co">#&gt;  9 B6             -3     1              13.0 </span></span>
<span id="cb374-19"><a href="10-dplyr.html#cb374-19"></a><span class="co">#&gt; 10 AA             -2     1               8.59</span></span>
<span id="cb374-20"><a href="10-dplyr.html#cb374-20"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>Ceci peut permettre, par exemple, de déterminer si un retard donné est supérieur ou inférieur au retard médian de la compagnie :</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="10-dplyr.html#cb375-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb375-2"><a href="10-dplyr.html#cb375-2"></a><span class="st">  </span><span class="kw">group_by</span>(carrier) <span class="op">%&gt;%</span></span>
<span id="cb375-3"><a href="10-dplyr.html#cb375-3"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb375-4"><a href="10-dplyr.html#cb375-4"></a>      <span class="dt">median_delay =</span> <span class="kw">median</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb375-5"><a href="10-dplyr.html#cb375-5"></a>      <span class="dt">delay_carrier =</span> <span class="kw">if_else</span>(</span>
<span id="cb375-6"><a href="10-dplyr.html#cb375-6"></a>          dep_delay <span class="op">&gt;</span><span class="st"> </span>median_delay,</span>
<span id="cb375-7"><a href="10-dplyr.html#cb375-7"></a>          <span class="st">&quot;Supérieur&quot;</span>, </span>
<span id="cb375-8"><a href="10-dplyr.html#cb375-8"></a>          <span class="st">&quot;Inférieur ou égal&quot;</span></span>
<span id="cb375-9"><a href="10-dplyr.html#cb375-9"></a>      )</span>
<span id="cb375-10"><a href="10-dplyr.html#cb375-10"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb375-11"><a href="10-dplyr.html#cb375-11"></a><span class="st">  </span><span class="kw">select</span>(dep_delay, month, median_delay, delay_carrier)</span>
<span id="cb375-12"><a href="10-dplyr.html#cb375-12"></a><span class="co">#&gt; Adding missing grouping variables: `carrier`</span></span>
<span id="cb375-13"><a href="10-dplyr.html#cb375-13"></a><span class="co">#&gt; # A tibble: 336,776 × 5</span></span>
<span id="cb375-14"><a href="10-dplyr.html#cb375-14"></a><span class="co">#&gt; # Groups:   carrier [16]</span></span>
<span id="cb375-15"><a href="10-dplyr.html#cb375-15"></a><span class="co">#&gt;    carrier dep_delay month median_delay delay_carrier    </span></span>
<span id="cb375-16"><a href="10-dplyr.html#cb375-16"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;        &lt;dbl&gt; &lt;chr&gt;            </span></span>
<span id="cb375-17"><a href="10-dplyr.html#cb375-17"></a><span class="co">#&gt;  1 UA              2     1            0 Supérieur        </span></span>
<span id="cb375-18"><a href="10-dplyr.html#cb375-18"></a><span class="co">#&gt;  2 UA              4     1            0 Supérieur        </span></span>
<span id="cb375-19"><a href="10-dplyr.html#cb375-19"></a><span class="co">#&gt;  3 AA              2     1           -3 Supérieur        </span></span>
<span id="cb375-20"><a href="10-dplyr.html#cb375-20"></a><span class="co">#&gt;  4 B6             -1     1           -1 Inférieur ou égal</span></span>
<span id="cb375-21"><a href="10-dplyr.html#cb375-21"></a><span class="co">#&gt;  5 DL             -6     1           -2 Inférieur ou égal</span></span>
<span id="cb375-22"><a href="10-dplyr.html#cb375-22"></a><span class="co">#&gt;  6 UA             -4     1            0 Inférieur ou égal</span></span>
<span id="cb375-23"><a href="10-dplyr.html#cb375-23"></a><span class="co">#&gt;  7 B6             -5     1           -1 Inférieur ou égal</span></span>
<span id="cb375-24"><a href="10-dplyr.html#cb375-24"></a><span class="co">#&gt;  8 EV             -3     1           -1 Inférieur ou égal</span></span>
<span id="cb375-25"><a href="10-dplyr.html#cb375-25"></a><span class="co">#&gt;  9 B6             -3     1           -1 Inférieur ou égal</span></span>
<span id="cb375-26"><a href="10-dplyr.html#cb375-26"></a><span class="co">#&gt; 10 AA             -2     1           -3 Supérieur        </span></span>
<span id="cb375-27"><a href="10-dplyr.html#cb375-27"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p><code>group_by</code> peut aussi être utile avec <code>filter</code>, par exemple pour sélectionner les vols avec le retard au départ le plus important <em>pour chaque mois</em> :</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="10-dplyr.html#cb376-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb376-2"><a href="10-dplyr.html#cb376-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb376-3"><a href="10-dplyr.html#cb376-3"></a><span class="st">  </span><span class="kw">filter</span>(dep_delay <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb376-4"><a href="10-dplyr.html#cb376-4"></a><span class="co">#&gt; # A tibble: 12 × 22</span></span>
<span id="cb376-5"><a href="10-dplyr.html#cb376-5"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb376-6"><a href="10-dplyr.html#cb376-6"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb376-7"><a href="10-dplyr.html#cb376-7"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb376-8"><a href="10-dplyr.html#cb376-8"></a><span class="co">#&gt;  1  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb376-9"><a href="10-dplyr.html#cb376-9"></a><span class="co">#&gt;  2  2013    10    14     2042            900       702     2255           1127</span></span>
<span id="cb376-10"><a href="10-dplyr.html#cb376-10"></a><span class="co">#&gt;  3  2013    11     3      603           1645       798      829           1913</span></span>
<span id="cb376-11"><a href="10-dplyr.html#cb376-11"></a><span class="co">#&gt;  4  2013    12     5      756           1700       896     1058           2020</span></span>
<span id="cb376-12"><a href="10-dplyr.html#cb376-12"></a><span class="co">#&gt;  5  2013     2    10     2243            830       853      100           1106</span></span>
<span id="cb376-13"><a href="10-dplyr.html#cb376-13"></a><span class="co">#&gt;  6  2013     3    17     2321            810       911      135           1020</span></span>
<span id="cb376-14"><a href="10-dplyr.html#cb376-14"></a><span class="co">#&gt;  7  2013     4    10     1100           1900       960     1342           2211</span></span>
<span id="cb376-15"><a href="10-dplyr.html#cb376-15"></a><span class="co">#&gt;  8  2013     5     3     1133           2055       878     1250           2215</span></span>
<span id="cb376-16"><a href="10-dplyr.html#cb376-16"></a><span class="co">#&gt;  9  2013     6    15     1432           1935      1137     1607           2120</span></span>
<span id="cb376-17"><a href="10-dplyr.html#cb376-17"></a><span class="co">#&gt; 10  2013     7    22      845           1600      1005     1044           1815</span></span>
<span id="cb376-18"><a href="10-dplyr.html#cb376-18"></a><span class="co">#&gt; 11  2013     8     8     2334           1454       520      120           1710</span></span>
<span id="cb376-19"><a href="10-dplyr.html#cb376-19"></a><span class="co">#&gt; 12  2013     9    20     1139           1845      1014     1457           2210</span></span>
<span id="cb376-20"><a href="10-dplyr.html#cb376-20"></a><span class="co">#&gt; # … with 14 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,</span></span>
<span id="cb376-21"><a href="10-dplyr.html#cb376-21"></a><span class="co">#&gt; #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,</span></span>
<span id="cb376-22"><a href="10-dplyr.html#cb376-22"></a><span class="co">#&gt; #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, duree_h &lt;dbl&gt;,</span></span>
<span id="cb376-23"><a href="10-dplyr.html#cb376-23"></a><span class="co">#&gt; #   distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<div class="rmdimportant">
<p>
<strong>Attention :</strong> la clause <code>group_by</code> marche pour les verbes déjà vus précédemment, <em>sauf</em> pour <code>arrange</code>, qui par défaut trie la table sans tenir compte des groupes. Pour obtenir un tri par groupe, il faut lui ajouter l’argument <code>.by_group = TRUE</code>.
</p>
</div>
<p>On peut voir la différence en comparant les deux résultats suivants :</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="10-dplyr.html#cb377-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb377-2"><a href="10-dplyr.html#cb377-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb377-3"><a href="10-dplyr.html#cb377-3"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(dep_delay))</span>
<span id="cb377-4"><a href="10-dplyr.html#cb377-4"></a><span class="co">#&gt; # A tibble: 336,776 × 22</span></span>
<span id="cb377-5"><a href="10-dplyr.html#cb377-5"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb377-6"><a href="10-dplyr.html#cb377-6"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb377-7"><a href="10-dplyr.html#cb377-7"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb377-8"><a href="10-dplyr.html#cb377-8"></a><span class="co">#&gt;  1  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb377-9"><a href="10-dplyr.html#cb377-9"></a><span class="co">#&gt;  2  2013     6    15     1432           1935      1137     1607           2120</span></span>
<span id="cb377-10"><a href="10-dplyr.html#cb377-10"></a><span class="co">#&gt;  3  2013     1    10     1121           1635      1126     1239           1810</span></span>
<span id="cb377-11"><a href="10-dplyr.html#cb377-11"></a><span class="co">#&gt;  4  2013     9    20     1139           1845      1014     1457           2210</span></span>
<span id="cb377-12"><a href="10-dplyr.html#cb377-12"></a><span class="co">#&gt;  5  2013     7    22      845           1600      1005     1044           1815</span></span>
<span id="cb377-13"><a href="10-dplyr.html#cb377-13"></a><span class="co">#&gt;  6  2013     4    10     1100           1900       960     1342           2211</span></span>
<span id="cb377-14"><a href="10-dplyr.html#cb377-14"></a><span class="co">#&gt;  7  2013     3    17     2321            810       911      135           1020</span></span>
<span id="cb377-15"><a href="10-dplyr.html#cb377-15"></a><span class="co">#&gt;  8  2013     6    27      959           1900       899     1236           2226</span></span>
<span id="cb377-16"><a href="10-dplyr.html#cb377-16"></a><span class="co">#&gt;  9  2013     7    22     2257            759       898      121           1026</span></span>
<span id="cb377-17"><a href="10-dplyr.html#cb377-17"></a><span class="co">#&gt; 10  2013    12     5      756           1700       896     1058           2020</span></span>
<span id="cb377-18"><a href="10-dplyr.html#cb377-18"></a><span class="co">#&gt; # … with 336,766 more rows, and 14 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb377-19"><a href="10-dplyr.html#cb377-19"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb377-20"><a href="10-dplyr.html#cb377-20"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,</span></span>
<span id="cb377-21"><a href="10-dplyr.html#cb377-21"></a><span class="co">#&gt; #   duree_h &lt;dbl&gt;, distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="10-dplyr.html#cb378-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb378-2"><a href="10-dplyr.html#cb378-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb378-3"><a href="10-dplyr.html#cb378-3"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(dep_delay), <span class="dt">.by_group =</span> <span class="ot">TRUE</span>)</span>
<span id="cb378-4"><a href="10-dplyr.html#cb378-4"></a><span class="co">#&gt; # A tibble: 336,776 × 22</span></span>
<span id="cb378-5"><a href="10-dplyr.html#cb378-5"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb378-6"><a href="10-dplyr.html#cb378-6"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb378-7"><a href="10-dplyr.html#cb378-7"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb378-8"><a href="10-dplyr.html#cb378-8"></a><span class="co">#&gt;  1  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb378-9"><a href="10-dplyr.html#cb378-9"></a><span class="co">#&gt;  2  2013     1    10     1121           1635      1126     1239           1810</span></span>
<span id="cb378-10"><a href="10-dplyr.html#cb378-10"></a><span class="co">#&gt;  3  2013     1     1      848           1835       853     1001           1950</span></span>
<span id="cb378-11"><a href="10-dplyr.html#cb378-11"></a><span class="co">#&gt;  4  2013     1    13     1809            810       599     2054           1042</span></span>
<span id="cb378-12"><a href="10-dplyr.html#cb378-12"></a><span class="co">#&gt;  5  2013     1    16     1622            800       502     1911           1054</span></span>
<span id="cb378-13"><a href="10-dplyr.html#cb378-13"></a><span class="co">#&gt;  6  2013     1    23     1551            753       478     1812           1006</span></span>
<span id="cb378-14"><a href="10-dplyr.html#cb378-14"></a><span class="co">#&gt;  7  2013     1    10     1525            900       385     1713           1039</span></span>
<span id="cb378-15"><a href="10-dplyr.html#cb378-15"></a><span class="co">#&gt;  8  2013     1     1     2343           1724       379      314           1938</span></span>
<span id="cb378-16"><a href="10-dplyr.html#cb378-16"></a><span class="co">#&gt;  9  2013     1     2     2131           1512       379     2340           1741</span></span>
<span id="cb378-17"><a href="10-dplyr.html#cb378-17"></a><span class="co">#&gt; 10  2013     1     7     2021           1415       366     2332           1724</span></span>
<span id="cb378-18"><a href="10-dplyr.html#cb378-18"></a><span class="co">#&gt; # … with 336,766 more rows, and 14 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb378-19"><a href="10-dplyr.html#cb378-19"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb378-20"><a href="10-dplyr.html#cb378-20"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,</span></span>
<span id="cb378-21"><a href="10-dplyr.html#cb378-21"></a><span class="co">#&gt; #   duree_h &lt;dbl&gt;, distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div id="summarise-et-count" class="section level3">
<h3><span class="header-section-number">10.4.2</span> <code>summarise</code> et <code>count</code></h3>
<p><code>summarise</code> permet d’agréger les lignes du tableau en effectuant une opération “résumée” sur une ou plusieurs colonnes. Par exemple, si on souhaite connaître les retards moyens au départ et à l’arrivée pour l’ensemble des vols du tableau <code>flights</code> :</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="10-dplyr.html#cb379-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb379-2"><a href="10-dplyr.html#cb379-2"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb379-3"><a href="10-dplyr.html#cb379-3"></a>      <span class="dt">retard_dep =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb379-4"><a href="10-dplyr.html#cb379-4"></a>      <span class="dt">retard_arr =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb379-5"><a href="10-dplyr.html#cb379-5"></a>  )</span>
<span id="cb379-6"><a href="10-dplyr.html#cb379-6"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb379-7"><a href="10-dplyr.html#cb379-7"></a><span class="co">#&gt;   retard_dep retard_arr</span></span>
<span id="cb379-8"><a href="10-dplyr.html#cb379-8"></a><span class="co">#&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb379-9"><a href="10-dplyr.html#cb379-9"></a><span class="co">#&gt; 1       12.6       6.90</span></span></code></pre></div>
<p>Cette fonction est en général utilisée avec <code>group_by</code>, puisqu’elle permet du coup d’agréger et résumer les lignes du tableau groupe par groupe. Si on souhaite calculer le délai maximum, le délai minimum et le délai moyen au départ pour chaque mois, on pourra faire :</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="10-dplyr.html#cb380-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb380-2"><a href="10-dplyr.html#cb380-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb380-3"><a href="10-dplyr.html#cb380-3"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb380-4"><a href="10-dplyr.html#cb380-4"></a>      <span class="dt">max_delay =</span> <span class="kw">max</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb380-5"><a href="10-dplyr.html#cb380-5"></a>      <span class="dt">min_delay =</span> <span class="kw">min</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb380-6"><a href="10-dplyr.html#cb380-6"></a>      <span class="dt">mean_delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb380-7"><a href="10-dplyr.html#cb380-7"></a>  )</span>
<span id="cb380-8"><a href="10-dplyr.html#cb380-8"></a><span class="co">#&gt; # A tibble: 12 × 4</span></span>
<span id="cb380-9"><a href="10-dplyr.html#cb380-9"></a><span class="co">#&gt;    month max_delay min_delay mean_delay</span></span>
<span id="cb380-10"><a href="10-dplyr.html#cb380-10"></a><span class="co">#&gt;    &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb380-11"><a href="10-dplyr.html#cb380-11"></a><span class="co">#&gt;  1     1      1301       -30      10.0 </span></span>
<span id="cb380-12"><a href="10-dplyr.html#cb380-12"></a><span class="co">#&gt;  2     2       853       -33      10.8 </span></span>
<span id="cb380-13"><a href="10-dplyr.html#cb380-13"></a><span class="co">#&gt;  3     3       911       -25      13.2 </span></span>
<span id="cb380-14"><a href="10-dplyr.html#cb380-14"></a><span class="co">#&gt;  4     4       960       -21      13.9 </span></span>
<span id="cb380-15"><a href="10-dplyr.html#cb380-15"></a><span class="co">#&gt;  5     5       878       -24      13.0 </span></span>
<span id="cb380-16"><a href="10-dplyr.html#cb380-16"></a><span class="co">#&gt;  6     6      1137       -21      20.8 </span></span>
<span id="cb380-17"><a href="10-dplyr.html#cb380-17"></a><span class="co">#&gt;  7     7      1005       -22      21.7 </span></span>
<span id="cb380-18"><a href="10-dplyr.html#cb380-18"></a><span class="co">#&gt;  8     8       520       -26      12.6 </span></span>
<span id="cb380-19"><a href="10-dplyr.html#cb380-19"></a><span class="co">#&gt;  9     9      1014       -24       6.72</span></span>
<span id="cb380-20"><a href="10-dplyr.html#cb380-20"></a><span class="co">#&gt; 10    10       702       -25       6.24</span></span>
<span id="cb380-21"><a href="10-dplyr.html#cb380-21"></a><span class="co">#&gt; 11    11       798       -32       5.44</span></span>
<span id="cb380-22"><a href="10-dplyr.html#cb380-22"></a><span class="co">#&gt; 12    12       896       -43      16.6</span></span></code></pre></div>
<p><code>summarise</code> dispose d’un opérateur spécial, <code>n()</code>, qui retourne le nombre de lignes du groupe. Ainsi si on veut le nombre de vols par destination, on peut utiliser :</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="10-dplyr.html#cb381-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb381-2"><a href="10-dplyr.html#cb381-2"></a><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span></span>
<span id="cb381-3"><a href="10-dplyr.html#cb381-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>())</span>
<span id="cb381-4"><a href="10-dplyr.html#cb381-4"></a><span class="co">#&gt; # A tibble: 105 × 2</span></span>
<span id="cb381-5"><a href="10-dplyr.html#cb381-5"></a><span class="co">#&gt;    dest     nb</span></span>
<span id="cb381-6"><a href="10-dplyr.html#cb381-6"></a><span class="co">#&gt;    &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb381-7"><a href="10-dplyr.html#cb381-7"></a><span class="co">#&gt;  1 ABQ     254</span></span>
<span id="cb381-8"><a href="10-dplyr.html#cb381-8"></a><span class="co">#&gt;  2 ACK     265</span></span>
<span id="cb381-9"><a href="10-dplyr.html#cb381-9"></a><span class="co">#&gt;  3 ALB     439</span></span>
<span id="cb381-10"><a href="10-dplyr.html#cb381-10"></a><span class="co">#&gt;  4 ANC       8</span></span>
<span id="cb381-11"><a href="10-dplyr.html#cb381-11"></a><span class="co">#&gt;  5 ATL   17215</span></span>
<span id="cb381-12"><a href="10-dplyr.html#cb381-12"></a><span class="co">#&gt;  6 AUS    2439</span></span>
<span id="cb381-13"><a href="10-dplyr.html#cb381-13"></a><span class="co">#&gt;  7 AVL     275</span></span>
<span id="cb381-14"><a href="10-dplyr.html#cb381-14"></a><span class="co">#&gt;  8 BDL     443</span></span>
<span id="cb381-15"><a href="10-dplyr.html#cb381-15"></a><span class="co">#&gt;  9 BGR     375</span></span>
<span id="cb381-16"><a href="10-dplyr.html#cb381-16"></a><span class="co">#&gt; 10 BHM     297</span></span>
<span id="cb381-17"><a href="10-dplyr.html#cb381-17"></a><span class="co">#&gt; # … with 95 more rows</span></span></code></pre></div>
<p><code>n()</code> peut aussi être utilisée avec <code>filter</code> et <code>mutate</code>.</p>
<p>À noter que quand on veut compter le nombre de lignes par groupe, on peut utiliser directement la fonction <code>count</code>. Ainsi le code suivant est identique au précédent :</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="10-dplyr.html#cb382-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb382-2"><a href="10-dplyr.html#cb382-2"></a><span class="st">  </span><span class="kw">count</span>(dest)</span>
<span id="cb382-3"><a href="10-dplyr.html#cb382-3"></a><span class="co">#&gt; # A tibble: 105 × 2</span></span>
<span id="cb382-4"><a href="10-dplyr.html#cb382-4"></a><span class="co">#&gt;    dest      n</span></span>
<span id="cb382-5"><a href="10-dplyr.html#cb382-5"></a><span class="co">#&gt;    &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb382-6"><a href="10-dplyr.html#cb382-6"></a><span class="co">#&gt;  1 ABQ     254</span></span>
<span id="cb382-7"><a href="10-dplyr.html#cb382-7"></a><span class="co">#&gt;  2 ACK     265</span></span>
<span id="cb382-8"><a href="10-dplyr.html#cb382-8"></a><span class="co">#&gt;  3 ALB     439</span></span>
<span id="cb382-9"><a href="10-dplyr.html#cb382-9"></a><span class="co">#&gt;  4 ANC       8</span></span>
<span id="cb382-10"><a href="10-dplyr.html#cb382-10"></a><span class="co">#&gt;  5 ATL   17215</span></span>
<span id="cb382-11"><a href="10-dplyr.html#cb382-11"></a><span class="co">#&gt;  6 AUS    2439</span></span>
<span id="cb382-12"><a href="10-dplyr.html#cb382-12"></a><span class="co">#&gt;  7 AVL     275</span></span>
<span id="cb382-13"><a href="10-dplyr.html#cb382-13"></a><span class="co">#&gt;  8 BDL     443</span></span>
<span id="cb382-14"><a href="10-dplyr.html#cb382-14"></a><span class="co">#&gt;  9 BGR     375</span></span>
<span id="cb382-15"><a href="10-dplyr.html#cb382-15"></a><span class="co">#&gt; 10 BHM     297</span></span>
<span id="cb382-16"><a href="10-dplyr.html#cb382-16"></a><span class="co">#&gt; # … with 95 more rows</span></span></code></pre></div>
<p>Lorsque la variable de groupage est un facteur et que certaines valeurs du facteur ne sont pas présentes dans le tableau, l’argument <code>.drop = FALSE</code> de <code>group_by</code> permet de conserver ces niveaux dans le résultat d’une opération groupée.</p>
<p>Par exemple, si on transforme la variable <code>origin</code> en facteur pour conserver la liste de ses modalités, et qu’on ne garde que les vols à destination de San Francisco (code <code>SFO</code>) :</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="10-dplyr.html#cb383-1"></a>ff &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span></span>
<span id="cb383-2"><a href="10-dplyr.html#cb383-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">origin =</span> <span class="kw">factor</span>(origin)) <span class="op">%&gt;%</span></span>
<span id="cb383-3"><a href="10-dplyr.html#cb383-3"></a><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;SFO&quot;</span>)</span></code></pre></div>
<p>Par défaut, si on compte le nombre de vols selon l’aéroport de départ, La Guardia n’apparaît pas car il ne compte aucun vol :</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="10-dplyr.html#cb384-1"></a>ff <span class="op">%&gt;%</span></span>
<span id="cb384-2"><a href="10-dplyr.html#cb384-2"></a><span class="st">  </span><span class="kw">group_by</span>(origin) <span class="op">%&gt;%</span></span>
<span id="cb384-3"><a href="10-dplyr.html#cb384-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</span>
<span id="cb384-4"><a href="10-dplyr.html#cb384-4"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb384-5"><a href="10-dplyr.html#cb384-5"></a><span class="co">#&gt;   origin     n</span></span>
<span id="cb384-6"><a href="10-dplyr.html#cb384-6"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;int&gt;</span></span>
<span id="cb384-7"><a href="10-dplyr.html#cb384-7"></a><span class="co">#&gt; 1 EWR     5127</span></span>
<span id="cb384-8"><a href="10-dplyr.html#cb384-8"></a><span class="co">#&gt; 2 JFK     8204</span></span></code></pre></div>
<p>Si on souhaite faire apparaître cette information dans la sortie du <code>summarise</code>, on peut ajouter l’argument <code>.drop = FALSE</code> au <code>group_by</code> :</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="10-dplyr.html#cb385-1"></a>ff <span class="op">%&gt;%</span></span>
<span id="cb385-2"><a href="10-dplyr.html#cb385-2"></a><span class="st">  </span><span class="kw">group_by</span>(origin, <span class="dt">.drop =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb385-3"><a href="10-dplyr.html#cb385-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</span>
<span id="cb385-4"><a href="10-dplyr.html#cb385-4"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb385-5"><a href="10-dplyr.html#cb385-5"></a><span class="co">#&gt;   origin     n</span></span>
<span id="cb385-6"><a href="10-dplyr.html#cb385-6"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;int&gt;</span></span>
<span id="cb385-7"><a href="10-dplyr.html#cb385-7"></a><span class="co">#&gt; 1 EWR     5127</span></span>
<span id="cb385-8"><a href="10-dplyr.html#cb385-8"></a><span class="co">#&gt; 2 JFK     8204</span></span>
<span id="cb385-9"><a href="10-dplyr.html#cb385-9"></a><span class="co">#&gt; 3 LGA        0</span></span></code></pre></div>
<p>Cet argument fonctionne aussi avec <code>count</code> :</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="10-dplyr.html#cb386-1"></a>ff <span class="op">%&gt;%</span></span>
<span id="cb386-2"><a href="10-dplyr.html#cb386-2"></a><span class="st">  </span><span class="kw">count</span>(origin, <span class="dt">.drop =</span> <span class="ot">FALSE</span>)</span>
<span id="cb386-3"><a href="10-dplyr.html#cb386-3"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb386-4"><a href="10-dplyr.html#cb386-4"></a><span class="co">#&gt;   origin     n</span></span>
<span id="cb386-5"><a href="10-dplyr.html#cb386-5"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;int&gt;</span></span>
<span id="cb386-6"><a href="10-dplyr.html#cb386-6"></a><span class="co">#&gt; 1 EWR     5127</span></span>
<span id="cb386-7"><a href="10-dplyr.html#cb386-7"></a><span class="co">#&gt; 2 JFK     8204</span></span>
<span id="cb386-8"><a href="10-dplyr.html#cb386-8"></a><span class="co">#&gt; 3 LGA        0</span></span></code></pre></div>
</div>
<div id="grouper-selon-plusieurs-variables" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Grouper selon plusieurs variables</h3>
<p>On peut grouper selon plusieurs variables à la fois, il suffit de les indiquer dans la clause du <code>group_by</code>. Le <em>pipeline</em> suivant le nombre de vols pour chaque mois et pour chaque destination, et trie le résultat par nombre de vols décroissant :</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="10-dplyr.html#cb387-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb387-2"><a href="10-dplyr.html#cb387-2"></a><span class="st">  </span><span class="kw">group_by</span>(month, dest) <span class="op">%&gt;%</span></span>
<span id="cb387-3"><a href="10-dplyr.html#cb387-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb387-4"><a href="10-dplyr.html#cb387-4"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(nb))</span>
<span id="cb387-5"><a href="10-dplyr.html#cb387-5"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;month&#39;. You can override using the `.groups` argument.</span></span>
<span id="cb387-6"><a href="10-dplyr.html#cb387-6"></a><span class="co">#&gt; # A tibble: 1,113 × 3</span></span>
<span id="cb387-7"><a href="10-dplyr.html#cb387-7"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb387-8"><a href="10-dplyr.html#cb387-8"></a><span class="co">#&gt;    month dest     nb</span></span>
<span id="cb387-9"><a href="10-dplyr.html#cb387-9"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb387-10"><a href="10-dplyr.html#cb387-10"></a><span class="co">#&gt;  1     8 ORD    1604</span></span>
<span id="cb387-11"><a href="10-dplyr.html#cb387-11"></a><span class="co">#&gt;  2    10 ORD    1604</span></span>
<span id="cb387-12"><a href="10-dplyr.html#cb387-12"></a><span class="co">#&gt;  3     5 ORD    1582</span></span>
<span id="cb387-13"><a href="10-dplyr.html#cb387-13"></a><span class="co">#&gt;  4     9 ORD    1582</span></span>
<span id="cb387-14"><a href="10-dplyr.html#cb387-14"></a><span class="co">#&gt;  5     7 ORD    1573</span></span>
<span id="cb387-15"><a href="10-dplyr.html#cb387-15"></a><span class="co">#&gt;  6     6 ORD    1547</span></span>
<span id="cb387-16"><a href="10-dplyr.html#cb387-16"></a><span class="co">#&gt;  7     7 ATL    1511</span></span>
<span id="cb387-17"><a href="10-dplyr.html#cb387-17"></a><span class="co">#&gt;  8     8 ATL    1507</span></span>
<span id="cb387-18"><a href="10-dplyr.html#cb387-18"></a><span class="co">#&gt;  9     8 LAX    1505</span></span>
<span id="cb387-19"><a href="10-dplyr.html#cb387-19"></a><span class="co">#&gt; 10     7 LAX    1500</span></span>
<span id="cb387-20"><a href="10-dplyr.html#cb387-20"></a><span class="co">#&gt; # … with 1,103 more rows</span></span></code></pre></div>
<p>On peut également utiliser <code>count</code> sur plusieurs variables. Les commandes suivantes comptent le nombre de vols pour chaque couple aéroport de départ / aéroport d’arrivée, et trie le résultat par nombre de vols décroissant. Ici la colonne qui contient le nombre de vols, créée par <code>count</code>, s’appelle <code>n</code> par défaut :</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="10-dplyr.html#cb388-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb388-2"><a href="10-dplyr.html#cb388-2"></a><span class="st">  </span><span class="kw">count</span>(origin, dest) <span class="op">%&gt;%</span></span>
<span id="cb388-3"><a href="10-dplyr.html#cb388-3"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))</span>
<span id="cb388-4"><a href="10-dplyr.html#cb388-4"></a><span class="co">#&gt; # A tibble: 224 × 3</span></span>
<span id="cb388-5"><a href="10-dplyr.html#cb388-5"></a><span class="co">#&gt;    origin dest      n</span></span>
<span id="cb388-6"><a href="10-dplyr.html#cb388-6"></a><span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb388-7"><a href="10-dplyr.html#cb388-7"></a><span class="co">#&gt;  1 JFK    LAX   11262</span></span>
<span id="cb388-8"><a href="10-dplyr.html#cb388-8"></a><span class="co">#&gt;  2 LGA    ATL   10263</span></span>
<span id="cb388-9"><a href="10-dplyr.html#cb388-9"></a><span class="co">#&gt;  3 LGA    ORD    8857</span></span>
<span id="cb388-10"><a href="10-dplyr.html#cb388-10"></a><span class="co">#&gt;  4 JFK    SFO    8204</span></span>
<span id="cb388-11"><a href="10-dplyr.html#cb388-11"></a><span class="co">#&gt;  5 LGA    CLT    6168</span></span>
<span id="cb388-12"><a href="10-dplyr.html#cb388-12"></a><span class="co">#&gt;  6 EWR    ORD    6100</span></span>
<span id="cb388-13"><a href="10-dplyr.html#cb388-13"></a><span class="co">#&gt;  7 JFK    BOS    5898</span></span>
<span id="cb388-14"><a href="10-dplyr.html#cb388-14"></a><span class="co">#&gt;  8 LGA    MIA    5781</span></span>
<span id="cb388-15"><a href="10-dplyr.html#cb388-15"></a><span class="co">#&gt;  9 JFK    MCO    5464</span></span>
<span id="cb388-16"><a href="10-dplyr.html#cb388-16"></a><span class="co">#&gt; 10 EWR    BOS    5327</span></span>
<span id="cb388-17"><a href="10-dplyr.html#cb388-17"></a><span class="co">#&gt; # … with 214 more rows</span></span></code></pre></div>
<p>On peut utiliser plusieurs opérations de groupage dans le même <em>pipeline</em>. Ainsi, si on souhaite déterminer le triplet compagnie aérienne / aéroport de départ / aéroport d’arrivée ayant le plus grand nombre de vols selon le mois de l’année, on devra procéder en deux étapes :</p>
<ul>
<li>d’abord grouper selon mois, compagnie, aéroports d’origine et d’arrivée pour calculer le nombre de vols</li>
<li>puis grouper uniquement selon le mois pour sélectionner la ligne avec la valeur maximale.</li>
</ul>
<p>Au final, on obtient le code suivant :</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="10-dplyr.html#cb389-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb389-2"><a href="10-dplyr.html#cb389-2"></a><span class="st">  </span><span class="kw">group_by</span>(month, carrier, origin, dest) <span class="op">%&gt;%</span></span>
<span id="cb389-3"><a href="10-dplyr.html#cb389-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb389-4"><a href="10-dplyr.html#cb389-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb389-5"><a href="10-dplyr.html#cb389-5"></a><span class="st">  </span><span class="kw">filter</span>(nb <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(nb))</span>
<span id="cb389-6"><a href="10-dplyr.html#cb389-6"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;month&#39;, &#39;carrier&#39;, &#39;origin&#39;. You can override using the `.groups` argument.</span></span>
<span id="cb389-7"><a href="10-dplyr.html#cb389-7"></a><span class="co">#&gt; # A tibble: 13 × 5</span></span>
<span id="cb389-8"><a href="10-dplyr.html#cb389-8"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb389-9"><a href="10-dplyr.html#cb389-9"></a><span class="co">#&gt;    month carrier origin dest     nb</span></span>
<span id="cb389-10"><a href="10-dplyr.html#cb389-10"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb389-11"><a href="10-dplyr.html#cb389-11"></a><span class="co">#&gt;  1     1 AA      LGA    DFW     437</span></span>
<span id="cb389-12"><a href="10-dplyr.html#cb389-12"></a><span class="co">#&gt;  2     1 DL      LGA    ATL     437</span></span>
<span id="cb389-13"><a href="10-dplyr.html#cb389-13"></a><span class="co">#&gt;  3     2 DL      LGA    ATL     402</span></span>
<span id="cb389-14"><a href="10-dplyr.html#cb389-14"></a><span class="co">#&gt;  4     3 DL      LGA    ATL     461</span></span>
<span id="cb389-15"><a href="10-dplyr.html#cb389-15"></a><span class="co">#&gt;  5     4 AA      LGA    ORD     501</span></span>
<span id="cb389-16"><a href="10-dplyr.html#cb389-16"></a><span class="co">#&gt;  6     5 AA      LGA    ORD     518</span></span>
<span id="cb389-17"><a href="10-dplyr.html#cb389-17"></a><span class="co">#&gt;  7     6 AA      LGA    ORD     520</span></span>
<span id="cb389-18"><a href="10-dplyr.html#cb389-18"></a><span class="co">#&gt;  8     7 AA      LGA    ORD     551</span></span>
<span id="cb389-19"><a href="10-dplyr.html#cb389-19"></a><span class="co">#&gt;  9     8 AA      LGA    ORD     545</span></span>
<span id="cb389-20"><a href="10-dplyr.html#cb389-20"></a><span class="co">#&gt; 10     9 AA      LGA    ORD     492</span></span>
<span id="cb389-21"><a href="10-dplyr.html#cb389-21"></a><span class="co">#&gt; 11    10 AA      LGA    ORD     516</span></span>
<span id="cb389-22"><a href="10-dplyr.html#cb389-22"></a><span class="co">#&gt; 12    11 DL      LGA    ATL     471</span></span>
<span id="cb389-23"><a href="10-dplyr.html#cb389-23"></a><span class="co">#&gt; 13    12 DL      LGA    ATL     489</span></span></code></pre></div>
<p>Lorsqu’on effectue un <code>group_by</code> suivi d’un <code>summarise</code>, le tableau résultat est automatiquement dégroupé <em>de la dernière variable de regroupement</em>. Ainsi le tableau généré par le code suivant est groupé par <code>month</code> et <code>origin</code> :</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="10-dplyr.html#cb390-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb390-2"><a href="10-dplyr.html#cb390-2"></a><span class="st">  </span><span class="kw">group_by</span>(month, origin, dest) <span class="op">%&gt;%</span></span>
<span id="cb390-3"><a href="10-dplyr.html#cb390-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>())</span>
<span id="cb390-4"><a href="10-dplyr.html#cb390-4"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;month&#39;, &#39;origin&#39;. You can override using the `.groups` argument.</span></span>
<span id="cb390-5"><a href="10-dplyr.html#cb390-5"></a><span class="co">#&gt; # A tibble: 2,313 × 4</span></span>
<span id="cb390-6"><a href="10-dplyr.html#cb390-6"></a><span class="co">#&gt; # Groups:   month, origin [36]</span></span>
<span id="cb390-7"><a href="10-dplyr.html#cb390-7"></a><span class="co">#&gt;    month origin dest     nb</span></span>
<span id="cb390-8"><a href="10-dplyr.html#cb390-8"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb390-9"><a href="10-dplyr.html#cb390-9"></a><span class="co">#&gt;  1     1 EWR    ALB      64</span></span>
<span id="cb390-10"><a href="10-dplyr.html#cb390-10"></a><span class="co">#&gt;  2     1 EWR    ATL     362</span></span>
<span id="cb390-11"><a href="10-dplyr.html#cb390-11"></a><span class="co">#&gt;  3     1 EWR    AUS      51</span></span>
<span id="cb390-12"><a href="10-dplyr.html#cb390-12"></a><span class="co">#&gt;  4     1 EWR    AVL       2</span></span>
<span id="cb390-13"><a href="10-dplyr.html#cb390-13"></a><span class="co">#&gt;  5     1 EWR    BDL      37</span></span>
<span id="cb390-14"><a href="10-dplyr.html#cb390-14"></a><span class="co">#&gt;  6     1 EWR    BNA     111</span></span>
<span id="cb390-15"><a href="10-dplyr.html#cb390-15"></a><span class="co">#&gt;  7     1 EWR    BOS     430</span></span>
<span id="cb390-16"><a href="10-dplyr.html#cb390-16"></a><span class="co">#&gt;  8     1 EWR    BQN      31</span></span>
<span id="cb390-17"><a href="10-dplyr.html#cb390-17"></a><span class="co">#&gt;  9     1 EWR    BTV     100</span></span>
<span id="cb390-18"><a href="10-dplyr.html#cb390-18"></a><span class="co">#&gt; 10     1 EWR    BUF     119</span></span>
<span id="cb390-19"><a href="10-dplyr.html#cb390-19"></a><span class="co">#&gt; # … with 2,303 more rows</span></span></code></pre></div>
<p>Cela peut permettre “d’enchaîner” les opérations groupées. Dans l’exemple suivant on calcule le pourcentage des trajets pour chaque destination par rapport à tous les trajets du mois :</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="10-dplyr.html#cb391-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb391-2"><a href="10-dplyr.html#cb391-2"></a><span class="st">  </span><span class="kw">group_by</span>(month, dest) <span class="op">%&gt;%</span></span>
<span id="cb391-3"><a href="10-dplyr.html#cb391-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb391-4"><a href="10-dplyr.html#cb391-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pourcentage =</span> nb <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(nb) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb391-5"><a href="10-dplyr.html#cb391-5"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;month&#39;. You can override using the `.groups` argument.</span></span>
<span id="cb391-6"><a href="10-dplyr.html#cb391-6"></a><span class="co">#&gt; # A tibble: 1,113 × 4</span></span>
<span id="cb391-7"><a href="10-dplyr.html#cb391-7"></a><span class="co">#&gt; # Groups:   month [12]</span></span>
<span id="cb391-8"><a href="10-dplyr.html#cb391-8"></a><span class="co">#&gt;    month dest     nb pourcentage</span></span>
<span id="cb391-9"><a href="10-dplyr.html#cb391-9"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;       &lt;dbl&gt;</span></span>
<span id="cb391-10"><a href="10-dplyr.html#cb391-10"></a><span class="co">#&gt;  1     1 ALB      64     0.237  </span></span>
<span id="cb391-11"><a href="10-dplyr.html#cb391-11"></a><span class="co">#&gt;  2     1 ATL    1396     5.17   </span></span>
<span id="cb391-12"><a href="10-dplyr.html#cb391-12"></a><span class="co">#&gt;  3     1 AUS     169     0.626  </span></span>
<span id="cb391-13"><a href="10-dplyr.html#cb391-13"></a><span class="co">#&gt;  4     1 AVL       2     0.00741</span></span>
<span id="cb391-14"><a href="10-dplyr.html#cb391-14"></a><span class="co">#&gt;  5     1 BDL      37     0.137  </span></span>
<span id="cb391-15"><a href="10-dplyr.html#cb391-15"></a><span class="co">#&gt;  6     1 BHM      25     0.0926 </span></span>
<span id="cb391-16"><a href="10-dplyr.html#cb391-16"></a><span class="co">#&gt;  7     1 BNA     399     1.48   </span></span>
<span id="cb391-17"><a href="10-dplyr.html#cb391-17"></a><span class="co">#&gt;  8     1 BOS    1245     4.61   </span></span>
<span id="cb391-18"><a href="10-dplyr.html#cb391-18"></a><span class="co">#&gt;  9     1 BQN      93     0.344  </span></span>
<span id="cb391-19"><a href="10-dplyr.html#cb391-19"></a><span class="co">#&gt; 10     1 BTV     223     0.826  </span></span>
<span id="cb391-20"><a href="10-dplyr.html#cb391-20"></a><span class="co">#&gt; # … with 1,103 more rows</span></span></code></pre></div>
<p>On peut à tout moment “dégrouper” un tableau à l’aide de <code>ungroup</code>. Ce serait par exemple nécessaire, dans l’exemple précédent, si on voulait calculer le pourcentage sur le nombre total de vols plutôt que sur le nombre de vols par mois :</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="10-dplyr.html#cb392-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb392-2"><a href="10-dplyr.html#cb392-2"></a><span class="st">  </span><span class="kw">group_by</span>(month, dest) <span class="op">%&gt;%</span></span>
<span id="cb392-3"><a href="10-dplyr.html#cb392-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb392-4"><a href="10-dplyr.html#cb392-4"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb392-5"><a href="10-dplyr.html#cb392-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pourcentage =</span> nb <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(nb) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb392-6"><a href="10-dplyr.html#cb392-6"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;month&#39;. You can override using the `.groups` argument.</span></span>
<span id="cb392-7"><a href="10-dplyr.html#cb392-7"></a><span class="co">#&gt; # A tibble: 1,113 × 4</span></span>
<span id="cb392-8"><a href="10-dplyr.html#cb392-8"></a><span class="co">#&gt;    month dest     nb pourcentage</span></span>
<span id="cb392-9"><a href="10-dplyr.html#cb392-9"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;       &lt;dbl&gt;</span></span>
<span id="cb392-10"><a href="10-dplyr.html#cb392-10"></a><span class="co">#&gt;  1     1 ALB      64    0.0190  </span></span>
<span id="cb392-11"><a href="10-dplyr.html#cb392-11"></a><span class="co">#&gt;  2     1 ATL    1396    0.415   </span></span>
<span id="cb392-12"><a href="10-dplyr.html#cb392-12"></a><span class="co">#&gt;  3     1 AUS     169    0.0502  </span></span>
<span id="cb392-13"><a href="10-dplyr.html#cb392-13"></a><span class="co">#&gt;  4     1 AVL       2    0.000594</span></span>
<span id="cb392-14"><a href="10-dplyr.html#cb392-14"></a><span class="co">#&gt;  5     1 BDL      37    0.0110  </span></span>
<span id="cb392-15"><a href="10-dplyr.html#cb392-15"></a><span class="co">#&gt;  6     1 BHM      25    0.00742 </span></span>
<span id="cb392-16"><a href="10-dplyr.html#cb392-16"></a><span class="co">#&gt;  7     1 BNA     399    0.118   </span></span>
<span id="cb392-17"><a href="10-dplyr.html#cb392-17"></a><span class="co">#&gt;  8     1 BOS    1245    0.370   </span></span>
<span id="cb392-18"><a href="10-dplyr.html#cb392-18"></a><span class="co">#&gt;  9     1 BQN      93    0.0276  </span></span>
<span id="cb392-19"><a href="10-dplyr.html#cb392-19"></a><span class="co">#&gt; 10     1 BTV     223    0.0662  </span></span>
<span id="cb392-20"><a href="10-dplyr.html#cb392-20"></a><span class="co">#&gt; # … with 1,103 more rows</span></span></code></pre></div>
<p>À noter que <code>count</code>, par contre, renvoie un tableau non groupé :</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="10-dplyr.html#cb393-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb393-2"><a href="10-dplyr.html#cb393-2"></a><span class="st">  </span><span class="kw">count</span>(month, dest)</span>
<span id="cb393-3"><a href="10-dplyr.html#cb393-3"></a><span class="co">#&gt; # A tibble: 1,113 × 3</span></span>
<span id="cb393-4"><a href="10-dplyr.html#cb393-4"></a><span class="co">#&gt;    month dest      n</span></span>
<span id="cb393-5"><a href="10-dplyr.html#cb393-5"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb393-6"><a href="10-dplyr.html#cb393-6"></a><span class="co">#&gt;  1     1 ALB      64</span></span>
<span id="cb393-7"><a href="10-dplyr.html#cb393-7"></a><span class="co">#&gt;  2     1 ATL    1396</span></span>
<span id="cb393-8"><a href="10-dplyr.html#cb393-8"></a><span class="co">#&gt;  3     1 AUS     169</span></span>
<span id="cb393-9"><a href="10-dplyr.html#cb393-9"></a><span class="co">#&gt;  4     1 AVL       2</span></span>
<span id="cb393-10"><a href="10-dplyr.html#cb393-10"></a><span class="co">#&gt;  5     1 BDL      37</span></span>
<span id="cb393-11"><a href="10-dplyr.html#cb393-11"></a><span class="co">#&gt;  6     1 BHM      25</span></span>
<span id="cb393-12"><a href="10-dplyr.html#cb393-12"></a><span class="co">#&gt;  7     1 BNA     399</span></span>
<span id="cb393-13"><a href="10-dplyr.html#cb393-13"></a><span class="co">#&gt;  8     1 BOS    1245</span></span>
<span id="cb393-14"><a href="10-dplyr.html#cb393-14"></a><span class="co">#&gt;  9     1 BQN      93</span></span>
<span id="cb393-15"><a href="10-dplyr.html#cb393-15"></a><span class="co">#&gt; 10     1 BTV     223</span></span>
<span id="cb393-16"><a href="10-dplyr.html#cb393-16"></a><span class="co">#&gt; # … with 1,103 more rows</span></span></code></pre></div>
</div>
</div>
<div id="autres-fonctions-utiles" class="section level2">
<h2><span class="header-section-number">10.5</span> Autres fonctions utiles</h2>
<p><code>dplyr</code> contient beaucoup d’autres fonctions utiles pour la manipulation de données.</p>
<div id="slice_sample" class="section level3">
<h3><span class="header-section-number">10.5.1</span> <code>slice_sample</code></h3>
<p>Ce verbe permet de sélectionner aléatoirement un nombre de lignes (avec l’argument <code>n</code>) ou une fraction des lignes (avec l’argument <code>prop</code>) d’un tableau.</p>
<p>Ainsi si on veut choisir 5 lignes au hasard dans le tableau <code>airports</code> :</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="10-dplyr.html#cb394-1"></a>airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_sample</span>(<span class="dt">n =</span> <span class="dv">5</span>)</span>
<span id="cb394-2"><a href="10-dplyr.html#cb394-2"></a><span class="co">#&gt; # A tibble: 5 × 8</span></span>
<span id="cb394-3"><a href="10-dplyr.html#cb394-3"></a><span class="co">#&gt;   faa   name                        lat    lon   alt    tz dst   tzone          </span></span>
<span id="cb394-4"><a href="10-dplyr.html#cb394-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          </span></span>
<span id="cb394-5"><a href="10-dplyr.html#cb394-5"></a><span class="co">#&gt; 1 TMB   Kendall Tamiami Executive  25.6  -80.4     8    -5 A     America/New_Yo…</span></span>
<span id="cb394-6"><a href="10-dplyr.html#cb394-6"></a><span class="co">#&gt; 2 HIO   Portland Hillsboro         45.5 -123.    204    -8 A     America/Los_An…</span></span>
<span id="cb394-7"><a href="10-dplyr.html#cb394-7"></a><span class="co">#&gt; 3 1G4   Grand Canyon West Airport  35.9 -114.   4813    -7 A     America/Phoenix</span></span>
<span id="cb394-8"><a href="10-dplyr.html#cb394-8"></a><span class="co">#&gt; 4 NTD   Point Mugu Nas             34.1 -119.     13    -8 A     America/Los_An…</span></span>
<span id="cb394-9"><a href="10-dplyr.html#cb394-9"></a><span class="co">#&gt; 5 CMH   Port Columbus Intl         40.0  -82.9   815    -5 A     America/New_Yo…</span></span></code></pre></div>
<p>Si on veut tirer au hasard 10% des lignes de <code>flights</code> :</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="10-dplyr.html#cb395-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_sample</span>(<span class="dt">prop =</span> <span class="fl">0.1</span>)</span>
<span id="cb395-2"><a href="10-dplyr.html#cb395-2"></a><span class="co">#&gt; # A tibble: 33,677 × 22</span></span>
<span id="cb395-3"><a href="10-dplyr.html#cb395-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb395-4"><a href="10-dplyr.html#cb395-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb395-5"><a href="10-dplyr.html#cb395-5"></a><span class="co">#&gt;  1  2013     6    18        3           2359         4      339            345</span></span>
<span id="cb395-6"><a href="10-dplyr.html#cb395-6"></a><span class="co">#&gt;  2  2013     3    21     1744           1736         8     2027           2029</span></span>
<span id="cb395-7"><a href="10-dplyr.html#cb395-7"></a><span class="co">#&gt;  3  2013    12    14     1005           1006        -1     1152           1125</span></span>
<span id="cb395-8"><a href="10-dplyr.html#cb395-8"></a><span class="co">#&gt;  4  2013     1    28      656            700        -4     1017           1015</span></span>
<span id="cb395-9"><a href="10-dplyr.html#cb395-9"></a><span class="co">#&gt;  5  2013     5     1     1658           1700        -2     2031           2102</span></span>
<span id="cb395-10"><a href="10-dplyr.html#cb395-10"></a><span class="co">#&gt;  6  2013     1    29     1324           1325        -1     1747           1810</span></span>
<span id="cb395-11"><a href="10-dplyr.html#cb395-11"></a><span class="co">#&gt;  7  2013    12    14      703            700         3     1017           1025</span></span>
<span id="cb395-12"><a href="10-dplyr.html#cb395-12"></a><span class="co">#&gt;  8  2013     4    29     1830           1835        -5     2021           2042</span></span>
<span id="cb395-13"><a href="10-dplyr.html#cb395-13"></a><span class="co">#&gt;  9  2013     2    17      832            840        -8     1001           1030</span></span>
<span id="cb395-14"><a href="10-dplyr.html#cb395-14"></a><span class="co">#&gt; 10  2013     6    24       NA           1855        NA       NA           2050</span></span>
<span id="cb395-15"><a href="10-dplyr.html#cb395-15"></a><span class="co">#&gt; # … with 33,667 more rows, and 14 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb395-16"><a href="10-dplyr.html#cb395-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb395-17"><a href="10-dplyr.html#cb395-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,</span></span>
<span id="cb395-18"><a href="10-dplyr.html#cb395-18"></a><span class="co">#&gt; #   duree_h &lt;dbl&gt;, distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<p>Ces fonctions sont utiles notamment pour faire de “l’échantillonnage” en tirant au hasard un certain nombre d’observations du tableau.</p>
</div>
<div id="slice_head-slice_tail-slice_min-slice_max" class="section level3">
<h3><span class="header-section-number">10.5.2</span> <code>slice_head</code>, <code>slice_tail</code>, <code>slice_min</code>, <code>slice_max</code></h3>
<p><code>slice_head</code> et <code>slice_tail</code> permettent de sélectionner les premières ou dernière lignes d’un tableau. On peut indiquer le nombre (avec <code>n</code>) ou la proportion (avec <code>prop</code>) de lignes qu’on souhaite.</p>
<p>Ainsi si on veut afficher les trois premières lignes d’<code>airport</code> :</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="10-dplyr.html#cb396-1"></a>airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_head</span>(<span class="dt">n =</span> <span class="dv">3</span>)</span>
<span id="cb396-2"><a href="10-dplyr.html#cb396-2"></a><span class="co">#&gt; # A tibble: 3 × 8</span></span>
<span id="cb396-3"><a href="10-dplyr.html#cb396-3"></a><span class="co">#&gt;   faa   name                            lat   lon   alt    tz dst   tzone       </span></span>
<span id="cb396-4"><a href="10-dplyr.html#cb396-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       </span></span>
<span id="cb396-5"><a href="10-dplyr.html#cb396-5"></a><span class="co">#&gt; 1 04G   Lansdowne Airport              41.1 -80.6  1044    -5 A     America/New…</span></span>
<span id="cb396-6"><a href="10-dplyr.html#cb396-6"></a><span class="co">#&gt; 2 06A   Moton Field Municipal Airport  32.5 -85.7   264    -6 A     America/Chi…</span></span>
<span id="cb396-7"><a href="10-dplyr.html#cb396-7"></a><span class="co">#&gt; 3 06C   Schaumburg Regional            42.0 -88.1   801    -6 A     America/Chi…</span></span></code></pre></div>
<p>Si on veut afficher les dernières 20% des lignes de <code>airlines</code> :</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="10-dplyr.html#cb397-1"></a>airlines <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_tail</span>(<span class="dt">prop =</span> <span class="fl">0.2</span>)</span>
<span id="cb397-2"><a href="10-dplyr.html#cb397-2"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb397-3"><a href="10-dplyr.html#cb397-3"></a><span class="co">#&gt;   carrier name                  </span></span>
<span id="cb397-4"><a href="10-dplyr.html#cb397-4"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                 </span></span>
<span id="cb397-5"><a href="10-dplyr.html#cb397-5"></a><span class="co">#&gt; 1 VX      Virgin America        </span></span>
<span id="cb397-6"><a href="10-dplyr.html#cb397-6"></a><span class="co">#&gt; 2 WN      Southwest Airlines Co.</span></span>
<span id="cb397-7"><a href="10-dplyr.html#cb397-7"></a><span class="co">#&gt; 3 YV      Mesa Airlines Inc.</span></span></code></pre></div>
<p><code>slice_min</code> et <code>slice_max</code> prennent en argument supplémentaire une variable du tableau et affichent <code>n</code> ou <code>prop</code> lignes du tableau ayant les valeurs les plus ou les moins élevées de cette variable.</p>
<p>Ainsi si on veut les 1% de lignes de <code>flights</code> ayant les plus fortes valeurs de <code>dep_delay</code> :</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="10-dplyr.html#cb398-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_max</span>(dep_delay, <span class="dt">prop =</span> <span class="fl">0.01</span>)</span>
<span id="cb398-2"><a href="10-dplyr.html#cb398-2"></a><span class="co">#&gt; # A tibble: 3,387 × 22</span></span>
<span id="cb398-3"><a href="10-dplyr.html#cb398-3"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb398-4"><a href="10-dplyr.html#cb398-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb398-5"><a href="10-dplyr.html#cb398-5"></a><span class="co">#&gt;  1  2013     1     9      641            900      1301     1242           1530</span></span>
<span id="cb398-6"><a href="10-dplyr.html#cb398-6"></a><span class="co">#&gt;  2  2013     6    15     1432           1935      1137     1607           2120</span></span>
<span id="cb398-7"><a href="10-dplyr.html#cb398-7"></a><span class="co">#&gt;  3  2013     1    10     1121           1635      1126     1239           1810</span></span>
<span id="cb398-8"><a href="10-dplyr.html#cb398-8"></a><span class="co">#&gt;  4  2013     9    20     1139           1845      1014     1457           2210</span></span>
<span id="cb398-9"><a href="10-dplyr.html#cb398-9"></a><span class="co">#&gt;  5  2013     7    22      845           1600      1005     1044           1815</span></span>
<span id="cb398-10"><a href="10-dplyr.html#cb398-10"></a><span class="co">#&gt;  6  2013     4    10     1100           1900       960     1342           2211</span></span>
<span id="cb398-11"><a href="10-dplyr.html#cb398-11"></a><span class="co">#&gt;  7  2013     3    17     2321            810       911      135           1020</span></span>
<span id="cb398-12"><a href="10-dplyr.html#cb398-12"></a><span class="co">#&gt;  8  2013     6    27      959           1900       899     1236           2226</span></span>
<span id="cb398-13"><a href="10-dplyr.html#cb398-13"></a><span class="co">#&gt;  9  2013     7    22     2257            759       898      121           1026</span></span>
<span id="cb398-14"><a href="10-dplyr.html#cb398-14"></a><span class="co">#&gt; 10  2013    12     5      756           1700       896     1058           2020</span></span>
<span id="cb398-15"><a href="10-dplyr.html#cb398-15"></a><span class="co">#&gt; # … with 3,377 more rows, and 14 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb398-16"><a href="10-dplyr.html#cb398-16"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb398-17"><a href="10-dplyr.html#cb398-17"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,</span></span>
<span id="cb398-18"><a href="10-dplyr.html#cb398-18"></a><span class="co">#&gt; #   duree_h &lt;dbl&gt;, distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<p>Si on veut les 2 aéroports avec l’altitude la plus basse :</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="10-dplyr.html#cb399-1"></a>airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_min</span>(alt, <span class="dt">n =</span> <span class="dv">2</span>)</span>
<span id="cb399-2"><a href="10-dplyr.html#cb399-2"></a><span class="co">#&gt; # A tibble: 2 × 8</span></span>
<span id="cb399-3"><a href="10-dplyr.html#cb399-3"></a><span class="co">#&gt;   faa   name            lat   lon   alt    tz dst   tzone              </span></span>
<span id="cb399-4"><a href="10-dplyr.html#cb399-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              </span></span>
<span id="cb399-5"><a href="10-dplyr.html#cb399-5"></a><span class="co">#&gt; 1 IPL   Imperial Co    32.8 -116.   -54    -8 A     America/Los_Angeles</span></span>
<span id="cb399-6"><a href="10-dplyr.html#cb399-6"></a><span class="co">#&gt; 2 NJK   El Centro Naf  32.8 -116.   -42    -8 A     America/Los_Angeles</span></span></code></pre></div>
<p>On notera que le tableau renvoyé par <code>slice_min</code> et <code>slice_max</code> est trié selon la variable d’intérêt.</p>
</div>
<div id="lead-et-lag" class="section level3">
<h3><span class="header-section-number">10.5.3</span> <code>lead</code> et <code>lag</code></h3>
<p><code>lead</code> et <code>lag</code> permettent de décaler les observations d’une variable d’un cran vers l’arrière (pour <code>lead</code>) ou vers l’avant (pour <code>lag</code>).</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="10-dplyr.html#cb400-1"></a><span class="kw">lead</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb400-2"><a href="10-dplyr.html#cb400-2"></a><span class="co">#&gt; [1]  2  3  4  5 NA</span></span>
<span id="cb400-3"><a href="10-dplyr.html#cb400-3"></a><span class="kw">lag</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb400-4"><a href="10-dplyr.html#cb400-4"></a><span class="co">#&gt; [1] NA  1  2  3  4</span></span></code></pre></div>
<p>Ceci peut être utile pour des données de type “séries temporelles”. Par exemple, on peut facilement calculer l’écart entre le retard au départ de chaque vol et celui du vol précédent :</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="10-dplyr.html#cb401-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb401-2"><a href="10-dplyr.html#cb401-2"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb401-3"><a href="10-dplyr.html#cb401-3"></a>      <span class="dt">dep_delay_prev =</span> <span class="kw">lag</span>(dep_delay),</span>
<span id="cb401-4"><a href="10-dplyr.html#cb401-4"></a>      <span class="dt">dep_delay_diff =</span> dep_delay <span class="op">-</span><span class="st"> </span>dep_delay_prev</span>
<span id="cb401-5"><a href="10-dplyr.html#cb401-5"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb401-6"><a href="10-dplyr.html#cb401-6"></a><span class="st">  </span><span class="kw">select</span>(dep_delay_prev, dep_delay, dep_delay_diff)</span>
<span id="cb401-7"><a href="10-dplyr.html#cb401-7"></a><span class="co">#&gt; # A tibble: 336,776 × 3</span></span>
<span id="cb401-8"><a href="10-dplyr.html#cb401-8"></a><span class="co">#&gt;    dep_delay_prev dep_delay dep_delay_diff</span></span>
<span id="cb401-9"><a href="10-dplyr.html#cb401-9"></a><span class="co">#&gt;             &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb401-10"><a href="10-dplyr.html#cb401-10"></a><span class="co">#&gt;  1             NA         2             NA</span></span>
<span id="cb401-11"><a href="10-dplyr.html#cb401-11"></a><span class="co">#&gt;  2              2         4              2</span></span>
<span id="cb401-12"><a href="10-dplyr.html#cb401-12"></a><span class="co">#&gt;  3              4         2             -2</span></span>
<span id="cb401-13"><a href="10-dplyr.html#cb401-13"></a><span class="co">#&gt;  4              2        -1             -3</span></span>
<span id="cb401-14"><a href="10-dplyr.html#cb401-14"></a><span class="co">#&gt;  5             -1        -6             -5</span></span>
<span id="cb401-15"><a href="10-dplyr.html#cb401-15"></a><span class="co">#&gt;  6             -6        -4              2</span></span>
<span id="cb401-16"><a href="10-dplyr.html#cb401-16"></a><span class="co">#&gt;  7             -4        -5             -1</span></span>
<span id="cb401-17"><a href="10-dplyr.html#cb401-17"></a><span class="co">#&gt;  8             -5        -3              2</span></span>
<span id="cb401-18"><a href="10-dplyr.html#cb401-18"></a><span class="co">#&gt;  9             -3        -3              0</span></span>
<span id="cb401-19"><a href="10-dplyr.html#cb401-19"></a><span class="co">#&gt; 10             -3        -2              1</span></span>
<span id="cb401-20"><a href="10-dplyr.html#cb401-20"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
</div>
<div id="distinct-et-n_distinct" class="section level3">
<h3><span class="header-section-number">10.5.4</span> <code>distinct</code> et <code>n_distinct</code></h3>
<p><code>distinct</code> filtre les lignes du tableau pour ne conserver que les lignes distinctes, en supprimant toutes les lignes en double.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="10-dplyr.html#cb402-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb402-2"><a href="10-dplyr.html#cb402-2"></a><span class="st">  </span><span class="kw">select</span>(day, month) <span class="op">%&gt;%</span></span>
<span id="cb402-3"><a href="10-dplyr.html#cb402-3"></a><span class="st">  </span>distinct</span>
<span id="cb402-4"><a href="10-dplyr.html#cb402-4"></a><span class="co">#&gt; # A tibble: 365 × 2</span></span>
<span id="cb402-5"><a href="10-dplyr.html#cb402-5"></a><span class="co">#&gt;      day month</span></span>
<span id="cb402-6"><a href="10-dplyr.html#cb402-6"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb402-7"><a href="10-dplyr.html#cb402-7"></a><span class="co">#&gt;  1     1     1</span></span>
<span id="cb402-8"><a href="10-dplyr.html#cb402-8"></a><span class="co">#&gt;  2     2     1</span></span>
<span id="cb402-9"><a href="10-dplyr.html#cb402-9"></a><span class="co">#&gt;  3     3     1</span></span>
<span id="cb402-10"><a href="10-dplyr.html#cb402-10"></a><span class="co">#&gt;  4     4     1</span></span>
<span id="cb402-11"><a href="10-dplyr.html#cb402-11"></a><span class="co">#&gt;  5     5     1</span></span>
<span id="cb402-12"><a href="10-dplyr.html#cb402-12"></a><span class="co">#&gt;  6     6     1</span></span>
<span id="cb402-13"><a href="10-dplyr.html#cb402-13"></a><span class="co">#&gt;  7     7     1</span></span>
<span id="cb402-14"><a href="10-dplyr.html#cb402-14"></a><span class="co">#&gt;  8     8     1</span></span>
<span id="cb402-15"><a href="10-dplyr.html#cb402-15"></a><span class="co">#&gt;  9     9     1</span></span>
<span id="cb402-16"><a href="10-dplyr.html#cb402-16"></a><span class="co">#&gt; 10    10     1</span></span>
<span id="cb402-17"><a href="10-dplyr.html#cb402-17"></a><span class="co">#&gt; # … with 355 more rows</span></span></code></pre></div>
<p>On peut lui spécifier une liste de variables : dans ce cas, pour toutes les observations ayant des valeurs identiques pour les variables en question, <code>distinct</code> ne conservera que la première d’entre elles.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="10-dplyr.html#cb403-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb403-2"><a href="10-dplyr.html#cb403-2"></a><span class="st">  </span><span class="kw">distinct</span>(month, day)</span>
<span id="cb403-3"><a href="10-dplyr.html#cb403-3"></a><span class="co">#&gt; # A tibble: 365 × 2</span></span>
<span id="cb403-4"><a href="10-dplyr.html#cb403-4"></a><span class="co">#&gt;    month   day</span></span>
<span id="cb403-5"><a href="10-dplyr.html#cb403-5"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb403-6"><a href="10-dplyr.html#cb403-6"></a><span class="co">#&gt;  1     1     1</span></span>
<span id="cb403-7"><a href="10-dplyr.html#cb403-7"></a><span class="co">#&gt;  2     1     2</span></span>
<span id="cb403-8"><a href="10-dplyr.html#cb403-8"></a><span class="co">#&gt;  3     1     3</span></span>
<span id="cb403-9"><a href="10-dplyr.html#cb403-9"></a><span class="co">#&gt;  4     1     4</span></span>
<span id="cb403-10"><a href="10-dplyr.html#cb403-10"></a><span class="co">#&gt;  5     1     5</span></span>
<span id="cb403-11"><a href="10-dplyr.html#cb403-11"></a><span class="co">#&gt;  6     1     6</span></span>
<span id="cb403-12"><a href="10-dplyr.html#cb403-12"></a><span class="co">#&gt;  7     1     7</span></span>
<span id="cb403-13"><a href="10-dplyr.html#cb403-13"></a><span class="co">#&gt;  8     1     8</span></span>
<span id="cb403-14"><a href="10-dplyr.html#cb403-14"></a><span class="co">#&gt;  9     1     9</span></span>
<span id="cb403-15"><a href="10-dplyr.html#cb403-15"></a><span class="co">#&gt; 10     1    10</span></span>
<span id="cb403-16"><a href="10-dplyr.html#cb403-16"></a><span class="co">#&gt; # … with 355 more rows</span></span></code></pre></div>
<p>L’option <code>.keep_all</code> permet, dans l’opération précédente, de conserver l’ensemble des colonnes du tableau :</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="10-dplyr.html#cb404-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb404-2"><a href="10-dplyr.html#cb404-2"></a><span class="st">  </span><span class="kw">distinct</span>(month, day, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb404-3"><a href="10-dplyr.html#cb404-3"></a><span class="co">#&gt; # A tibble: 365 × 22</span></span>
<span id="cb404-4"><a href="10-dplyr.html#cb404-4"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb404-5"><a href="10-dplyr.html#cb404-5"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb404-6"><a href="10-dplyr.html#cb404-6"></a><span class="co">#&gt;  1  2013     1     1      517            515         2      830            819</span></span>
<span id="cb404-7"><a href="10-dplyr.html#cb404-7"></a><span class="co">#&gt;  2  2013     1     2       42           2359        43      518            442</span></span>
<span id="cb404-8"><a href="10-dplyr.html#cb404-8"></a><span class="co">#&gt;  3  2013     1     3       32           2359        33      504            442</span></span>
<span id="cb404-9"><a href="10-dplyr.html#cb404-9"></a><span class="co">#&gt;  4  2013     1     4       25           2359        26      505            442</span></span>
<span id="cb404-10"><a href="10-dplyr.html#cb404-10"></a><span class="co">#&gt;  5  2013     1     5       14           2359        15      503            445</span></span>
<span id="cb404-11"><a href="10-dplyr.html#cb404-11"></a><span class="co">#&gt;  6  2013     1     6       16           2359        17      451            442</span></span>
<span id="cb404-12"><a href="10-dplyr.html#cb404-12"></a><span class="co">#&gt;  7  2013     1     7       49           2359        50      531            444</span></span>
<span id="cb404-13"><a href="10-dplyr.html#cb404-13"></a><span class="co">#&gt;  8  2013     1     8      454            500        -6      625            648</span></span>
<span id="cb404-14"><a href="10-dplyr.html#cb404-14"></a><span class="co">#&gt;  9  2013     1     9        2           2359         3      432            444</span></span>
<span id="cb404-15"><a href="10-dplyr.html#cb404-15"></a><span class="co">#&gt; 10  2013     1    10        3           2359         4      426            437</span></span>
<span id="cb404-16"><a href="10-dplyr.html#cb404-16"></a><span class="co">#&gt; # … with 355 more rows, and 14 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,</span></span>
<span id="cb404-17"><a href="10-dplyr.html#cb404-17"></a><span class="co">#&gt; #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,</span></span>
<span id="cb404-18"><a href="10-dplyr.html#cb404-18"></a><span class="co">#&gt; #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, duree_h &lt;dbl&gt;,</span></span>
<span id="cb404-19"><a href="10-dplyr.html#cb404-19"></a><span class="co">#&gt; #   distance_km &lt;dbl&gt;, vitesse &lt;dbl&gt;</span></span></code></pre></div>
<p>La fonction <code>n_distinct</code>, elle, renvoie le nombre de valeurs distinctes d’un vecteur. On peut notamment l’utiliser dans un <code>summarise</code>.</p>
<p>Dans l’exemple qui suit on calcule, pour les trois aéroports de départ de la table <code>flights</code> le nombre de valeurs distinctes de l’aéroport d’arrivée :</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="10-dplyr.html#cb405-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb405-2"><a href="10-dplyr.html#cb405-2"></a><span class="st">  </span><span class="kw">group_by</span>(origin) <span class="op">%&gt;%</span></span>
<span id="cb405-3"><a href="10-dplyr.html#cb405-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_dest =</span> <span class="kw">n_distinct</span>(dest))</span>
<span id="cb405-4"><a href="10-dplyr.html#cb405-4"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb405-5"><a href="10-dplyr.html#cb405-5"></a><span class="co">#&gt;   origin n_dest</span></span>
<span id="cb405-6"><a href="10-dplyr.html#cb405-6"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt;</span></span>
<span id="cb405-7"><a href="10-dplyr.html#cb405-7"></a><span class="co">#&gt; 1 EWR        86</span></span>
<span id="cb405-8"><a href="10-dplyr.html#cb405-8"></a><span class="co">#&gt; 2 JFK        70</span></span>
<span id="cb405-9"><a href="10-dplyr.html#cb405-9"></a><span class="co">#&gt; 3 LGA        68</span></span></code></pre></div>
</div>
<div id="relocate" class="section level3">
<h3><span class="header-section-number">10.5.5</span> <code>relocate</code></h3>
<p><code>relocate</code> peut être utilisé pour réordonner les colonnes d’une table. Par défaut, si on lui passe un ou plusieurs noms de colonnes, <code>relocate</code> les place en début de tableau :</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="10-dplyr.html#cb406-1"></a>airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">relocate</span>(lat, lon)</span>
<span id="cb406-2"><a href="10-dplyr.html#cb406-2"></a><span class="co">#&gt; # A tibble: 1,458 × 8</span></span>
<span id="cb406-3"><a href="10-dplyr.html#cb406-3"></a><span class="co">#&gt;      lat    lon faa   name                             alt    tz dst   tzone    </span></span>
<span id="cb406-4"><a href="10-dplyr.html#cb406-4"></a><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    </span></span>
<span id="cb406-5"><a href="10-dplyr.html#cb406-5"></a><span class="co">#&gt;  1  41.1  -80.6 04G   Lansdowne Airport               1044    -5 A     America/…</span></span>
<span id="cb406-6"><a href="10-dplyr.html#cb406-6"></a><span class="co">#&gt;  2  32.5  -85.7 06A   Moton Field Municipal Airport    264    -6 A     America/…</span></span>
<span id="cb406-7"><a href="10-dplyr.html#cb406-7"></a><span class="co">#&gt;  3  42.0  -88.1 06C   Schaumburg Regional              801    -6 A     America/…</span></span>
<span id="cb406-8"><a href="10-dplyr.html#cb406-8"></a><span class="co">#&gt;  4  41.4  -74.4 06N   Randall Airport                  523    -5 A     America/…</span></span>
<span id="cb406-9"><a href="10-dplyr.html#cb406-9"></a><span class="co">#&gt;  5  31.1  -81.4 09J   Jekyll Island Airport             11    -5 A     America/…</span></span>
<span id="cb406-10"><a href="10-dplyr.html#cb406-10"></a><span class="co">#&gt;  6  36.4  -82.2 0A9   Elizabethton Municipal Airport  1593    -5 A     America/…</span></span>
<span id="cb406-11"><a href="10-dplyr.html#cb406-11"></a><span class="co">#&gt;  7  41.5  -84.5 0G6   Williams County Airport          730    -5 A     America/…</span></span>
<span id="cb406-12"><a href="10-dplyr.html#cb406-12"></a><span class="co">#&gt;  8  42.9  -76.8 0G7   Finger Lakes Regional Airport    492    -5 A     America/…</span></span>
<span id="cb406-13"><a href="10-dplyr.html#cb406-13"></a><span class="co">#&gt;  9  39.8  -76.6 0P2   Shoestring Aviation Airfield    1000    -5 U     America/…</span></span>
<span id="cb406-14"><a href="10-dplyr.html#cb406-14"></a><span class="co">#&gt; 10  48.1 -123.  0S9   Jefferson County Intl            108    -8 A     America/…</span></span>
<span id="cb406-15"><a href="10-dplyr.html#cb406-15"></a><span class="co">#&gt; # … with 1,448 more rows</span></span></code></pre></div>
<p>Les arguments supplémentaires <code>.before</code> et <code>.after</code> permettent de préciser à quel endroit déplacer la ou les colonnes indiquées :</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="10-dplyr.html#cb407-1"></a>airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">relocate</span>(<span class="kw">starts_with</span>(<span class="st">&#39;tz&#39;</span>), <span class="dt">.after =</span> name)</span>
<span id="cb407-2"><a href="10-dplyr.html#cb407-2"></a><span class="co">#&gt; # A tibble: 1,458 × 8</span></span>
<span id="cb407-3"><a href="10-dplyr.html#cb407-3"></a><span class="co">#&gt;    faa   name                              tz tzone       lat    lon   alt dst  </span></span>
<span id="cb407-4"><a href="10-dplyr.html#cb407-4"></a><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span id="cb407-5"><a href="10-dplyr.html#cb407-5"></a><span class="co">#&gt;  1 04G   Lansdowne Airport                 -5 America/…  41.1  -80.6  1044 A    </span></span>
<span id="cb407-6"><a href="10-dplyr.html#cb407-6"></a><span class="co">#&gt;  2 06A   Moton Field Municipal Airport     -6 America/…  32.5  -85.7   264 A    </span></span>
<span id="cb407-7"><a href="10-dplyr.html#cb407-7"></a><span class="co">#&gt;  3 06C   Schaumburg Regional               -6 America/…  42.0  -88.1   801 A    </span></span>
<span id="cb407-8"><a href="10-dplyr.html#cb407-8"></a><span class="co">#&gt;  4 06N   Randall Airport                   -5 America/…  41.4  -74.4   523 A    </span></span>
<span id="cb407-9"><a href="10-dplyr.html#cb407-9"></a><span class="co">#&gt;  5 09J   Jekyll Island Airport             -5 America/…  31.1  -81.4    11 A    </span></span>
<span id="cb407-10"><a href="10-dplyr.html#cb407-10"></a><span class="co">#&gt;  6 0A9   Elizabethton Municipal Airport    -5 America/…  36.4  -82.2  1593 A    </span></span>
<span id="cb407-11"><a href="10-dplyr.html#cb407-11"></a><span class="co">#&gt;  7 0G6   Williams County Airport           -5 America/…  41.5  -84.5   730 A    </span></span>
<span id="cb407-12"><a href="10-dplyr.html#cb407-12"></a><span class="co">#&gt;  8 0G7   Finger Lakes Regional Airport     -5 America/…  42.9  -76.8   492 A    </span></span>
<span id="cb407-13"><a href="10-dplyr.html#cb407-13"></a><span class="co">#&gt;  9 0P2   Shoestring Aviation Airfield      -5 America/…  39.8  -76.6  1000 U    </span></span>
<span id="cb407-14"><a href="10-dplyr.html#cb407-14"></a><span class="co">#&gt; 10 0S9   Jefferson County Intl             -8 America/…  48.1 -123.    108 A    </span></span>
<span id="cb407-15"><a href="10-dplyr.html#cb407-15"></a><span class="co">#&gt; # … with 1,448 more rows</span></span></code></pre></div>
</div>
</div>
<div id="tables-multiples" class="section level2">
<h2><span class="header-section-number">10.6</span> Tables multiples</h2>
<p>Le jeu de données <code>nycflights13</code> est un exemple de données réparties en plusieurs tables. Ici on en a trois : les informations sur les vols dans <code>flights</code>, celles sur les aéroports dans <code>airports</code> et celles sur les compagnies aériennes dans <code>airlines</code>.</p>
<p><code>dplyr</code> propose différentes fonctions permettant de travailler avec des données structurées de cette manière.</p>
<div id="concaténation-bind_rows-et-bind_cols" class="section level3">
<h3><span class="header-section-number">10.6.1</span> Concaténation : <code>bind_rows</code> et <code>bind_cols</code></h3>
<p>Les fonctions <code>bind_rows</code> et <code>bind_cols</code> permettent d’ajouter des lignes (respectivement des colonnes) à une table à partir d’une ou plusieurs autres tables.</p>
<p>L’exemple suivant (certes très artificiel) montre l’utilisation de <code>bind_rows</code>. On commence par créer trois tableaux <code>t1</code>, <code>t2</code> et <code>t3</code> :</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="10-dplyr.html#cb408-1"></a>t1 &lt;-<span class="st"> </span>airports <span class="op">%&gt;%</span></span>
<span id="cb408-2"><a href="10-dplyr.html#cb408-2"></a><span class="st">  </span><span class="kw">select</span>(faa, name, lat, lon) <span class="op">%&gt;%</span></span>
<span id="cb408-3"><a href="10-dplyr.html#cb408-3"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb408-4"><a href="10-dplyr.html#cb408-4"></a>t1</span>
<span id="cb408-5"><a href="10-dplyr.html#cb408-5"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb408-6"><a href="10-dplyr.html#cb408-6"></a><span class="co">#&gt;   faa   name                            lat   lon</span></span>
<span id="cb408-7"><a href="10-dplyr.html#cb408-7"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb408-8"><a href="10-dplyr.html#cb408-8"></a><span class="co">#&gt; 1 04G   Lansdowne Airport              41.1 -80.6</span></span>
<span id="cb408-9"><a href="10-dplyr.html#cb408-9"></a><span class="co">#&gt; 2 06A   Moton Field Municipal Airport  32.5 -85.7</span></span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="10-dplyr.html#cb409-1"></a>t2 &lt;-<span class="st"> </span>airports <span class="op">%&gt;%</span></span>
<span id="cb409-2"><a href="10-dplyr.html#cb409-2"></a><span class="st">  </span><span class="kw">select</span>(faa, name, lat, lon) <span class="op">%&gt;%</span></span>
<span id="cb409-3"><a href="10-dplyr.html#cb409-3"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb409-4"><a href="10-dplyr.html#cb409-4"></a></span>
<span id="cb409-5"><a href="10-dplyr.html#cb409-5"></a>t2</span>
<span id="cb409-6"><a href="10-dplyr.html#cb409-6"></a><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span id="cb409-7"><a href="10-dplyr.html#cb409-7"></a><span class="co">#&gt;   faa   name                             lat   lon</span></span>
<span id="cb409-8"><a href="10-dplyr.html#cb409-8"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb409-9"><a href="10-dplyr.html#cb409-9"></a><span class="co">#&gt; 1 09J   Jekyll Island Airport           31.1 -81.4</span></span>
<span id="cb409-10"><a href="10-dplyr.html#cb409-10"></a><span class="co">#&gt; 2 0A9   Elizabethton Municipal Airport  36.4 -82.2</span></span></code></pre></div>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="10-dplyr.html#cb410-1"></a>t3 &lt;-<span class="st"> </span>airports <span class="op">%&gt;%</span></span>
<span id="cb410-2"><a href="10-dplyr.html#cb410-2"></a><span class="st">  </span><span class="kw">select</span>(faa, name) <span class="op">%&gt;%</span></span>
<span id="cb410-3"><a href="10-dplyr.html#cb410-3"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">100</span><span class="op">:</span><span class="dv">101</span>)</span>
<span id="cb410-4"><a href="10-dplyr.html#cb410-4"></a>t3</span>
<span id="cb410-5"><a href="10-dplyr.html#cb410-5"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb410-6"><a href="10-dplyr.html#cb410-6"></a><span class="co">#&gt;   faa   name             </span></span>
<span id="cb410-7"><a href="10-dplyr.html#cb410-7"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;            </span></span>
<span id="cb410-8"><a href="10-dplyr.html#cb410-8"></a><span class="co">#&gt; 1 ADW   Andrews Afb      </span></span>
<span id="cb410-9"><a href="10-dplyr.html#cb410-9"></a><span class="co">#&gt; 2 AET   Allakaket Airport</span></span></code></pre></div>
<p>On concaténe ensuite les trois tables avec <code>bind_rows</code> :</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="10-dplyr.html#cb411-1"></a><span class="kw">bind_rows</span>(t1, t2, t3)</span>
<span id="cb411-2"><a href="10-dplyr.html#cb411-2"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb411-3"><a href="10-dplyr.html#cb411-3"></a><span class="co">#&gt;   faa   name                             lat   lon</span></span>
<span id="cb411-4"><a href="10-dplyr.html#cb411-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb411-5"><a href="10-dplyr.html#cb411-5"></a><span class="co">#&gt; 1 04G   Lansdowne Airport               41.1 -80.6</span></span>
<span id="cb411-6"><a href="10-dplyr.html#cb411-6"></a><span class="co">#&gt; 2 06A   Moton Field Municipal Airport   32.5 -85.7</span></span>
<span id="cb411-7"><a href="10-dplyr.html#cb411-7"></a><span class="co">#&gt; 3 09J   Jekyll Island Airport           31.1 -81.4</span></span>
<span id="cb411-8"><a href="10-dplyr.html#cb411-8"></a><span class="co">#&gt; 4 0A9   Elizabethton Municipal Airport  36.4 -82.2</span></span>
<span id="cb411-9"><a href="10-dplyr.html#cb411-9"></a><span class="co">#&gt; 5 ADW   Andrews Afb                     NA    NA  </span></span>
<span id="cb411-10"><a href="10-dplyr.html#cb411-10"></a><span class="co">#&gt; 6 AET   Allakaket Airport               NA    NA</span></span></code></pre></div>
<p>On remarquera que si des colonnes sont manquantes pour certaines tables, comme les colonnes <code>lat</code> et <code>lon</code> de <code>t3</code>, des <code>NA</code> sont automatiquement insérées.</p>
<p>Il peut être utile, quand on concatène des lignes, de garder une trace du tableau d’origine de chacune des lignes dans le tableau final. C’est possible grâce à l’argument <code>.id</code> de <code>bind_rows</code>. On passe à cet argument le nom d’une colonne qui contiendra l’indicateur d’origine des lignes :</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="10-dplyr.html#cb412-1"></a><span class="kw">bind_rows</span>(t1, t2, t3, <span class="dt">.id =</span> <span class="st">&quot;source&quot;</span>)</span>
<span id="cb412-2"><a href="10-dplyr.html#cb412-2"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb412-3"><a href="10-dplyr.html#cb412-3"></a><span class="co">#&gt;   source faa   name                             lat   lon</span></span>
<span id="cb412-4"><a href="10-dplyr.html#cb412-4"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb412-5"><a href="10-dplyr.html#cb412-5"></a><span class="co">#&gt; 1 1      04G   Lansdowne Airport               41.1 -80.6</span></span>
<span id="cb412-6"><a href="10-dplyr.html#cb412-6"></a><span class="co">#&gt; 2 1      06A   Moton Field Municipal Airport   32.5 -85.7</span></span>
<span id="cb412-7"><a href="10-dplyr.html#cb412-7"></a><span class="co">#&gt; 3 2      09J   Jekyll Island Airport           31.1 -81.4</span></span>
<span id="cb412-8"><a href="10-dplyr.html#cb412-8"></a><span class="co">#&gt; 4 2      0A9   Elizabethton Municipal Airport  36.4 -82.2</span></span>
<span id="cb412-9"><a href="10-dplyr.html#cb412-9"></a><span class="co">#&gt; 5 3      ADW   Andrews Afb                     NA    NA  </span></span>
<span id="cb412-10"><a href="10-dplyr.html#cb412-10"></a><span class="co">#&gt; 6 3      AET   Allakaket Airport               NA    NA</span></span></code></pre></div>
<p>Par défaut la colonne <code>.id</code> ne contient qu’un nombre, différent pour chaque tableau. On peut lui spécifier des valeurs plus explicites en “nommant” les tables dans <code>bind_rows</code> de la manière suivante :</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="10-dplyr.html#cb413-1"></a><span class="kw">bind_rows</span>(<span class="dt">table1 =</span> t1, <span class="dt">table2 =</span> t2, <span class="dt">table3 =</span> t3, <span class="dt">.id =</span> <span class="st">&quot;source&quot;</span>)</span>
<span id="cb413-2"><a href="10-dplyr.html#cb413-2"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb413-3"><a href="10-dplyr.html#cb413-3"></a><span class="co">#&gt;   source faa   name                             lat   lon</span></span>
<span id="cb413-4"><a href="10-dplyr.html#cb413-4"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb413-5"><a href="10-dplyr.html#cb413-5"></a><span class="co">#&gt; 1 table1 04G   Lansdowne Airport               41.1 -80.6</span></span>
<span id="cb413-6"><a href="10-dplyr.html#cb413-6"></a><span class="co">#&gt; 2 table1 06A   Moton Field Municipal Airport   32.5 -85.7</span></span>
<span id="cb413-7"><a href="10-dplyr.html#cb413-7"></a><span class="co">#&gt; 3 table2 09J   Jekyll Island Airport           31.1 -81.4</span></span>
<span id="cb413-8"><a href="10-dplyr.html#cb413-8"></a><span class="co">#&gt; 4 table2 0A9   Elizabethton Municipal Airport  36.4 -82.2</span></span>
<span id="cb413-9"><a href="10-dplyr.html#cb413-9"></a><span class="co">#&gt; 5 table3 ADW   Andrews Afb                     NA    NA  </span></span>
<span id="cb413-10"><a href="10-dplyr.html#cb413-10"></a><span class="co">#&gt; 6 table3 AET   Allakaket Airport               NA    NA</span></span></code></pre></div>
<p><code>bind_cols</code> permet de concaténer des colonnes et fonctionne de manière similaire :</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="10-dplyr.html#cb414-1"></a>t1 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(dep_delay, dep_time)</span>
<span id="cb414-2"><a href="10-dplyr.html#cb414-2"></a>t2 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(origin, dest)</span>
<span id="cb414-3"><a href="10-dplyr.html#cb414-3"></a>t3 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(arr_delay, arr_time)</span>
<span id="cb414-4"><a href="10-dplyr.html#cb414-4"></a><span class="kw">bind_cols</span>(t1, t2, t3)</span>
<span id="cb414-5"><a href="10-dplyr.html#cb414-5"></a><span class="co">#&gt; # A tibble: 5 × 6</span></span>
<span id="cb414-6"><a href="10-dplyr.html#cb414-6"></a><span class="co">#&gt;   dep_delay dep_time origin dest  arr_delay arr_time</span></span>
<span id="cb414-7"><a href="10-dplyr.html#cb414-7"></a><span class="co">#&gt;       &lt;dbl&gt;    &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;int&gt;</span></span>
<span id="cb414-8"><a href="10-dplyr.html#cb414-8"></a><span class="co">#&gt; 1         2      517 EWR    IAH          11      830</span></span>
<span id="cb414-9"><a href="10-dplyr.html#cb414-9"></a><span class="co">#&gt; 2         4      533 LGA    IAH          20      850</span></span>
<span id="cb414-10"><a href="10-dplyr.html#cb414-10"></a><span class="co">#&gt; 3         2      542 JFK    MIA          33      923</span></span>
<span id="cb414-11"><a href="10-dplyr.html#cb414-11"></a><span class="co">#&gt; 4        -1      544 JFK    BQN         -18     1004</span></span>
<span id="cb414-12"><a href="10-dplyr.html#cb414-12"></a><span class="co">#&gt; 5        -6      554 LGA    ATL         -25      812</span></span></code></pre></div>
<p>À noter que <code>bind_cols</code> associe les lignes uniquement <em>par position</em>. Les lignes des différents tableaux associés doivent donc correspondre (et leur nombre doit être identique). Pour associer des tables <em>par valeur</em>, on doit utiliser des jointures.</p>
</div>
<div id="jointures" class="section level3">
<h3><span class="header-section-number">10.6.2</span> Jointures</h3>
<div id="clés-implicites" class="section level4">
<h4><span class="header-section-number">10.6.2.1</span> Clés implicites</h4>
<p>Très souvent, les données relatives à une analyse sont réparties dans plusieurs tables différentes. Dans notre exemple, on peut voir que la table <code>flights</code> contient seulement le code de la compagnie aérienne du vol dans la variable <code>carrier</code> :</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="10-dplyr.html#cb415-1"></a>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(carrier)</span>
<span id="cb415-2"><a href="10-dplyr.html#cb415-2"></a><span class="co">#&gt; # A tibble: 336,776 × 1</span></span>
<span id="cb415-3"><a href="10-dplyr.html#cb415-3"></a><span class="co">#&gt;    carrier</span></span>
<span id="cb415-4"><a href="10-dplyr.html#cb415-4"></a><span class="co">#&gt;    &lt;chr&gt;  </span></span>
<span id="cb415-5"><a href="10-dplyr.html#cb415-5"></a><span class="co">#&gt;  1 UA     </span></span>
<span id="cb415-6"><a href="10-dplyr.html#cb415-6"></a><span class="co">#&gt;  2 UA     </span></span>
<span id="cb415-7"><a href="10-dplyr.html#cb415-7"></a><span class="co">#&gt;  3 AA     </span></span>
<span id="cb415-8"><a href="10-dplyr.html#cb415-8"></a><span class="co">#&gt;  4 B6     </span></span>
<span id="cb415-9"><a href="10-dplyr.html#cb415-9"></a><span class="co">#&gt;  5 DL     </span></span>
<span id="cb415-10"><a href="10-dplyr.html#cb415-10"></a><span class="co">#&gt;  6 UA     </span></span>
<span id="cb415-11"><a href="10-dplyr.html#cb415-11"></a><span class="co">#&gt;  7 B6     </span></span>
<span id="cb415-12"><a href="10-dplyr.html#cb415-12"></a><span class="co">#&gt;  8 EV     </span></span>
<span id="cb415-13"><a href="10-dplyr.html#cb415-13"></a><span class="co">#&gt;  9 B6     </span></span>
<span id="cb415-14"><a href="10-dplyr.html#cb415-14"></a><span class="co">#&gt; 10 AA     </span></span>
<span id="cb415-15"><a href="10-dplyr.html#cb415-15"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>Et que par ailleurs la table <code>airlines</code> contient une information supplémentaire relative à ces compagnies, à savoir le nom complet.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="10-dplyr.html#cb416-1"></a>airlines</span>
<span id="cb416-2"><a href="10-dplyr.html#cb416-2"></a><span class="co">#&gt; # A tibble: 16 × 2</span></span>
<span id="cb416-3"><a href="10-dplyr.html#cb416-3"></a><span class="co">#&gt;    carrier name                       </span></span>
<span id="cb416-4"><a href="10-dplyr.html#cb416-4"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;                      </span></span>
<span id="cb416-5"><a href="10-dplyr.html#cb416-5"></a><span class="co">#&gt;  1 9E      Endeavor Air Inc.          </span></span>
<span id="cb416-6"><a href="10-dplyr.html#cb416-6"></a><span class="co">#&gt;  2 AA      American Airlines Inc.     </span></span>
<span id="cb416-7"><a href="10-dplyr.html#cb416-7"></a><span class="co">#&gt;  3 AS      Alaska Airlines Inc.       </span></span>
<span id="cb416-8"><a href="10-dplyr.html#cb416-8"></a><span class="co">#&gt;  4 B6      JetBlue Airways            </span></span>
<span id="cb416-9"><a href="10-dplyr.html#cb416-9"></a><span class="co">#&gt;  5 DL      Delta Air Lines Inc.       </span></span>
<span id="cb416-10"><a href="10-dplyr.html#cb416-10"></a><span class="co">#&gt;  6 EV      ExpressJet Airlines Inc.   </span></span>
<span id="cb416-11"><a href="10-dplyr.html#cb416-11"></a><span class="co">#&gt;  7 F9      Frontier Airlines Inc.     </span></span>
<span id="cb416-12"><a href="10-dplyr.html#cb416-12"></a><span class="co">#&gt;  8 FL      AirTran Airways Corporation</span></span>
<span id="cb416-13"><a href="10-dplyr.html#cb416-13"></a><span class="co">#&gt;  9 HA      Hawaiian Airlines Inc.     </span></span>
<span id="cb416-14"><a href="10-dplyr.html#cb416-14"></a><span class="co">#&gt; 10 MQ      Envoy Air                  </span></span>
<span id="cb416-15"><a href="10-dplyr.html#cb416-15"></a><span class="co">#&gt; 11 OO      SkyWest Airlines Inc.      </span></span>
<span id="cb416-16"><a href="10-dplyr.html#cb416-16"></a><span class="co">#&gt; 12 UA      United Air Lines Inc.      </span></span>
<span id="cb416-17"><a href="10-dplyr.html#cb416-17"></a><span class="co">#&gt; 13 US      US Airways Inc.            </span></span>
<span id="cb416-18"><a href="10-dplyr.html#cb416-18"></a><span class="co">#&gt; 14 VX      Virgin America             </span></span>
<span id="cb416-19"><a href="10-dplyr.html#cb416-19"></a><span class="co">#&gt; 15 WN      Southwest Airlines Co.     </span></span>
<span id="cb416-20"><a href="10-dplyr.html#cb416-20"></a><span class="co">#&gt; 16 YV      Mesa Airlines Inc.</span></span></code></pre></div>
<p>Il est donc naturel de vouloir associer les deux, en l’occurrence pour ajouter les noms complets des compagnies à la table <code>flights</code>. Dans ce cas on va faire une <em>jointure</em> : les lignes d’une table seront associées à une autre en se basant non pas sur leur position, mais sur les valeurs d’une ou plusieurs colonnes. Ces colonnes sont appelées des <em>clés</em>.</p>
<p>Pour faire une jointure de ce type, on va utiliser la fonction <code>left_join</code> :</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="10-dplyr.html#cb417-1"></a><span class="kw">left_join</span>(flights, airlines)</span></code></pre></div>
<p>Pour faciliter la lecture, on va afficher seulement certaines colonnes du résultat :</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="10-dplyr.html#cb418-1"></a><span class="kw">left_join</span>(flights, airlines) <span class="op">%&gt;%</span></span>
<span id="cb418-2"><a href="10-dplyr.html#cb418-2"></a><span class="st">  </span><span class="kw">select</span>(month, day, carrier, name)</span>
<span id="cb418-3"><a href="10-dplyr.html#cb418-3"></a><span class="co">#&gt; Joining, by = &quot;carrier&quot;</span></span>
<span id="cb418-4"><a href="10-dplyr.html#cb418-4"></a><span class="co">#&gt; # A tibble: 336,776 × 4</span></span>
<span id="cb418-5"><a href="10-dplyr.html#cb418-5"></a><span class="co">#&gt;    month   day carrier name                    </span></span>
<span id="cb418-6"><a href="10-dplyr.html#cb418-6"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;                   </span></span>
<span id="cb418-7"><a href="10-dplyr.html#cb418-7"></a><span class="co">#&gt;  1     1     1 UA      United Air Lines Inc.   </span></span>
<span id="cb418-8"><a href="10-dplyr.html#cb418-8"></a><span class="co">#&gt;  2     1     1 UA      United Air Lines Inc.   </span></span>
<span id="cb418-9"><a href="10-dplyr.html#cb418-9"></a><span class="co">#&gt;  3     1     1 AA      American Airlines Inc.  </span></span>
<span id="cb418-10"><a href="10-dplyr.html#cb418-10"></a><span class="co">#&gt;  4     1     1 B6      JetBlue Airways         </span></span>
<span id="cb418-11"><a href="10-dplyr.html#cb418-11"></a><span class="co">#&gt;  5     1     1 DL      Delta Air Lines Inc.    </span></span>
<span id="cb418-12"><a href="10-dplyr.html#cb418-12"></a><span class="co">#&gt;  6     1     1 UA      United Air Lines Inc.   </span></span>
<span id="cb418-13"><a href="10-dplyr.html#cb418-13"></a><span class="co">#&gt;  7     1     1 B6      JetBlue Airways         </span></span>
<span id="cb418-14"><a href="10-dplyr.html#cb418-14"></a><span class="co">#&gt;  8     1     1 EV      ExpressJet Airlines Inc.</span></span>
<span id="cb418-15"><a href="10-dplyr.html#cb418-15"></a><span class="co">#&gt;  9     1     1 B6      JetBlue Airways         </span></span>
<span id="cb418-16"><a href="10-dplyr.html#cb418-16"></a><span class="co">#&gt; 10     1     1 AA      American Airlines Inc.  </span></span>
<span id="cb418-17"><a href="10-dplyr.html#cb418-17"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>On voit que la table résultat est bien la fusion des deux tables d’origine selon les valeurs des deux colonnes clés <code>carrier</code>. On est parti de la table <code>flights</code>, et pour chaque ligne on a ajouté les colonnes de <code>airlines</code> pour lesquelles la valeur de <code>carrier</code> est la même. On a donc bien une nouvelle colonne <code>name</code> dans notre table résultat, avec le nom complet de la compagnie aérienne.</p>
<div class="rmdnote">
<p>
À noter qu’on peut tout à fait utiliser le <em>pipe</em> avec les fonctions de jointure :
</p>
<p>
<code>flights %&gt;% left_join(airlines)</code>.
</p>
</div>
<p>Nous sommes ici dans le cas le plus simple concernant les clés de jointure : les deux clés sont uniques et portent le même nom dans les deux tables. Par défaut, si on ne lui spécifie pas explicitement les clés, <code>dplyr</code> fusionne en utilisant l’ensemble des colonnes communes aux deux tables. On peut d’ailleurs voir dans cet exemple qu’un message a été affiché précisant que la jointure s’est faite sur la variable <code>carrier</code>.</p>
</div>
<div id="clés-explicites" class="section level4">
<h4><span class="header-section-number">10.6.2.2</span> Clés explicites</h4>
<p>La table <code>airports</code>, elle, contient des informations supplémentaires sur les aéroports : nom complet, altitude, position géographique, etc. Chaque aéroport est identifié par un code contenu dans la colonne <code>faa</code>.</p>
<p>Si on regarde la table <code>flights</code>, on voit que le code d’identification des aéroports apparaît à deux endroits différents : pour l’aéroport de départ dans la colonne <code>origin</code>, et pour celui d’arrivée dans la colonne <code>dest</code>. On a donc deux clés de jointure possibles, et qui portent un nom différent de la clé de <code>airports</code>.</p>
<p>On va commencer par fusionner les données concernant l’aéroport de départ. Pour simplifier l’affichage des résultats, on va se contenter d’un sous-ensemble des deux tables :</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="10-dplyr.html#cb419-1"></a>flights_ex &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(month, day, origin, dest)</span>
<span id="cb419-2"><a href="10-dplyr.html#cb419-2"></a>airports_ex &lt;-<span class="st"> </span>airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(faa, alt, name)</span></code></pre></div>
<p>Si on se contente d’un <code>left_join</code> comme à l’étape précédente, on obtient un message d’erreur car aucune colonne commune ne peut être identifiée comme clé de jointure :</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="10-dplyr.html#cb420-1"></a><span class="kw">left_join</span>(flights_ex, airports_ex)</span>
<span id="cb420-2"><a href="10-dplyr.html#cb420-2"></a><span class="co">#&gt; Error: `by` must be supplied when `x` and `y` have no common variables.</span></span>
<span id="cb420-3"><a href="10-dplyr.html#cb420-3"></a><span class="co">#&gt; ℹ use by = character()` to perform a cross-join.</span></span></code></pre></div>
<p>On doit donc spécifier explicitement les clés avec l’argument <code>by</code> de <code>left_join</code>. Ici la clé est nommée <code>origin</code> dans la première table, et <code>faa</code> dans la seconde. La syntaxe est donc la suivante :</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="10-dplyr.html#cb421-1"></a><span class="kw">left_join</span>(flights_ex, airports_ex, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>))</span>
<span id="cb421-2"><a href="10-dplyr.html#cb421-2"></a><span class="co">#&gt; # A tibble: 336,776 × 6</span></span>
<span id="cb421-3"><a href="10-dplyr.html#cb421-3"></a><span class="co">#&gt;    month   day origin dest    alt name               </span></span>
<span id="cb421-4"><a href="10-dplyr.html#cb421-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;              </span></span>
<span id="cb421-5"><a href="10-dplyr.html#cb421-5"></a><span class="co">#&gt;  1     1     1 EWR    IAH      18 Newark Liberty Intl</span></span>
<span id="cb421-6"><a href="10-dplyr.html#cb421-6"></a><span class="co">#&gt;  2     1     1 LGA    IAH      22 La Guardia         </span></span>
<span id="cb421-7"><a href="10-dplyr.html#cb421-7"></a><span class="co">#&gt;  3     1     1 JFK    MIA      13 John F Kennedy Intl</span></span>
<span id="cb421-8"><a href="10-dplyr.html#cb421-8"></a><span class="co">#&gt;  4     1     1 JFK    BQN      13 John F Kennedy Intl</span></span>
<span id="cb421-9"><a href="10-dplyr.html#cb421-9"></a><span class="co">#&gt;  5     1     1 LGA    ATL      22 La Guardia         </span></span>
<span id="cb421-10"><a href="10-dplyr.html#cb421-10"></a><span class="co">#&gt;  6     1     1 EWR    ORD      18 Newark Liberty Intl</span></span>
<span id="cb421-11"><a href="10-dplyr.html#cb421-11"></a><span class="co">#&gt;  7     1     1 EWR    FLL      18 Newark Liberty Intl</span></span>
<span id="cb421-12"><a href="10-dplyr.html#cb421-12"></a><span class="co">#&gt;  8     1     1 LGA    IAD      22 La Guardia         </span></span>
<span id="cb421-13"><a href="10-dplyr.html#cb421-13"></a><span class="co">#&gt;  9     1     1 JFK    MCO      13 John F Kennedy Intl</span></span>
<span id="cb421-14"><a href="10-dplyr.html#cb421-14"></a><span class="co">#&gt; 10     1     1 LGA    ORD      22 La Guardia         </span></span>
<span id="cb421-15"><a href="10-dplyr.html#cb421-15"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>On constate que les deux nouvelles colonnes <code>name</code> et <code>alt</code> contiennent bien les données correspondant à l’aéroport de départ.</p>
<p>On va stocker le résultat de cette jointure dans la table <code>flights_ex</code> :</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="10-dplyr.html#cb422-1"></a>flights_ex &lt;-<span class="st"> </span>flights_ex <span class="op">%&gt;%</span></span>
<span id="cb422-2"><a href="10-dplyr.html#cb422-2"></a><span class="st">  </span><span class="kw">left_join</span>(airports_ex, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>))</span></code></pre></div>
<p>Supposons qu’on souhaite maintenant fusionner à nouveau les informations de la table <code>airports</code>, mais cette fois pour les aéroports d’arrivée de notre nouvelle table <code>flights_ex</code>. Les deux clés sont donc désormais <code>dest</code> dans la première table, et <code>faa</code> dans la deuxième. La syntaxe est donc la suivante :</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="10-dplyr.html#cb423-1"></a><span class="kw">left_join</span>(flights_ex, airports_ex, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;dest&quot;</span> =<span class="st"> &quot;faa&quot;</span>))</span>
<span id="cb423-2"><a href="10-dplyr.html#cb423-2"></a><span class="co">#&gt; # A tibble: 336,776 × 8</span></span>
<span id="cb423-3"><a href="10-dplyr.html#cb423-3"></a><span class="co">#&gt;    month   day origin dest  alt.x name.x              alt.y name.y              </span></span>
<span id="cb423-4"><a href="10-dplyr.html#cb423-4"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;               </span></span>
<span id="cb423-5"><a href="10-dplyr.html#cb423-5"></a><span class="co">#&gt;  1     1     1 EWR    IAH      18 Newark Liberty Intl    97 George Bush Interco…</span></span>
<span id="cb423-6"><a href="10-dplyr.html#cb423-6"></a><span class="co">#&gt;  2     1     1 LGA    IAH      22 La Guardia             97 George Bush Interco…</span></span>
<span id="cb423-7"><a href="10-dplyr.html#cb423-7"></a><span class="co">#&gt;  3     1     1 JFK    MIA      13 John F Kennedy Intl     8 Miami Intl          </span></span>
<span id="cb423-8"><a href="10-dplyr.html#cb423-8"></a><span class="co">#&gt;  4     1     1 JFK    BQN      13 John F Kennedy Intl    NA &lt;NA&gt;                </span></span>
<span id="cb423-9"><a href="10-dplyr.html#cb423-9"></a><span class="co">#&gt;  5     1     1 LGA    ATL      22 La Guardia           1026 Hartsfield Jackson …</span></span>
<span id="cb423-10"><a href="10-dplyr.html#cb423-10"></a><span class="co">#&gt;  6     1     1 EWR    ORD      18 Newark Liberty Intl   668 Chicago Ohare Intl  </span></span>
<span id="cb423-11"><a href="10-dplyr.html#cb423-11"></a><span class="co">#&gt;  7     1     1 EWR    FLL      18 Newark Liberty Intl     9 Fort Lauderdale Hol…</span></span>
<span id="cb423-12"><a href="10-dplyr.html#cb423-12"></a><span class="co">#&gt;  8     1     1 LGA    IAD      22 La Guardia            313 Washington Dulles I…</span></span>
<span id="cb423-13"><a href="10-dplyr.html#cb423-13"></a><span class="co">#&gt;  9     1     1 JFK    MCO      13 John F Kennedy Intl    96 Orlando Intl        </span></span>
<span id="cb423-14"><a href="10-dplyr.html#cb423-14"></a><span class="co">#&gt; 10     1     1 LGA    ORD      22 La Guardia            668 Chicago Ohare Intl  </span></span>
<span id="cb423-15"><a href="10-dplyr.html#cb423-15"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>Cela fonctionne, les informations de l’aéroport d’arrivée ont bien été ajoutées, mais on constate que les colonnes ont été renommées. En effet, ici les deux tables fusionnées contenaient toutes les deux des colonnes <code>name</code> et <code>alt</code>. Comme on ne peut pas avoir deux colonnes avec le même nom dans un tableau, <code>dplyr</code> a renommé les colonnes de la première table en <code>name.x</code> et <code>alt.x</code>, et celles de la deuxième en <code>name.y</code> et <code>alt.y</code>.</p>
<p>C’est pratique, mais pas forcément très parlant. On pourrait renommer manuellement les colonnes avec <code>rename</code> avant de faire la jointure pour avoir des intitulés plus explicites, mais on peut aussi utiliser l’argument <code>suffix</code> de <code>left_join</code>, qui permet d’indiquer les suffixes à ajouter aux colonnes. Ainsi, on peut faire :</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="10-dplyr.html#cb424-1"></a><span class="kw">left_join</span>(flights_ex, airports_ex,</span>
<span id="cb424-2"><a href="10-dplyr.html#cb424-2"></a>          <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;dest&quot;</span> =<span class="st"> &quot;faa&quot;</span>),</span>
<span id="cb424-3"><a href="10-dplyr.html#cb424-3"></a>          <span class="dt">suffix =</span> <span class="kw">c</span>(<span class="st">&quot;_depart&quot;</span>, <span class="st">&quot;_arrivee&quot;</span>))</span>
<span id="cb424-4"><a href="10-dplyr.html#cb424-4"></a><span class="co">#&gt; # A tibble: 336,776 × 8</span></span>
<span id="cb424-5"><a href="10-dplyr.html#cb424-5"></a><span class="co">#&gt;    month   day origin dest  alt_depart name_depart   alt_arrivee name_arrivee   </span></span>
<span id="cb424-6"><a href="10-dplyr.html#cb424-6"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;          </span></span>
<span id="cb424-7"><a href="10-dplyr.html#cb424-7"></a><span class="co">#&gt;  1     1     1 EWR    IAH           18 Newark Liber…          97 George Bush In…</span></span>
<span id="cb424-8"><a href="10-dplyr.html#cb424-8"></a><span class="co">#&gt;  2     1     1 LGA    IAH           22 La Guardia             97 George Bush In…</span></span>
<span id="cb424-9"><a href="10-dplyr.html#cb424-9"></a><span class="co">#&gt;  3     1     1 JFK    MIA           13 John F Kenne…           8 Miami Intl     </span></span>
<span id="cb424-10"><a href="10-dplyr.html#cb424-10"></a><span class="co">#&gt;  4     1     1 JFK    BQN           13 John F Kenne…          NA &lt;NA&gt;           </span></span>
<span id="cb424-11"><a href="10-dplyr.html#cb424-11"></a><span class="co">#&gt;  5     1     1 LGA    ATL           22 La Guardia           1026 Hartsfield Jac…</span></span>
<span id="cb424-12"><a href="10-dplyr.html#cb424-12"></a><span class="co">#&gt;  6     1     1 EWR    ORD           18 Newark Liber…         668 Chicago Ohare …</span></span>
<span id="cb424-13"><a href="10-dplyr.html#cb424-13"></a><span class="co">#&gt;  7     1     1 EWR    FLL           18 Newark Liber…           9 Fort Lauderdal…</span></span>
<span id="cb424-14"><a href="10-dplyr.html#cb424-14"></a><span class="co">#&gt;  8     1     1 LGA    IAD           22 La Guardia            313 Washington Dul…</span></span>
<span id="cb424-15"><a href="10-dplyr.html#cb424-15"></a><span class="co">#&gt;  9     1     1 JFK    MCO           13 John F Kenne…          96 Orlando Intl   </span></span>
<span id="cb424-16"><a href="10-dplyr.html#cb424-16"></a><span class="co">#&gt; 10     1     1 LGA    ORD           22 La Guardia            668 Chicago Ohare …</span></span>
<span id="cb424-17"><a href="10-dplyr.html#cb424-17"></a><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre></div>
<p>On obtient ainsi directement des noms de colonnes nettement plus clairs.</p>
</div>
</div>
<div id="types-de-jointures" class="section level3">
<h3><span class="header-section-number">10.6.3</span> Types de jointures</h3>
<p>Jusqu’à présent nous avons utilisé la fonction <code>left_join</code>, mais il existe plusieurs types de jointures.</p>
<p>Partons de deux tables d’exemple, <code>personnes</code> et <code>voitures</code> :</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="10-dplyr.html#cb425-1"></a>personnes &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb425-2"><a href="10-dplyr.html#cb425-2"></a>    <span class="dt">nom =</span> <span class="kw">c</span>(<span class="st">&quot;Sylvie&quot;</span>, <span class="st">&quot;Sylvie&quot;</span>, <span class="st">&quot;Monique&quot;</span>, <span class="st">&quot;Gunter&quot;</span>, <span class="st">&quot;Rayan&quot;</span>, <span class="st">&quot;Rayan&quot;</span>),</span>
<span id="cb425-3"><a href="10-dplyr.html#cb425-3"></a>    <span class="dt">voiture =</span> <span class="kw">c</span>(<span class="st">&quot;Twingo&quot;</span>, <span class="st">&quot;Ferrari&quot;</span>, <span class="st">&quot;Scenic&quot;</span>, <span class="st">&quot;Lada&quot;</span>, <span class="st">&quot;Twingo&quot;</span>, <span class="st">&quot;Clio&quot;</span>)</span>
<span id="cb425-4"><a href="10-dplyr.html#cb425-4"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sylvie</td>
<td align="left">Twingo</td>
</tr>
<tr class="even">
<td align="left">Sylvie</td>
<td align="left">Ferrari</td>
</tr>
<tr class="odd">
<td align="left">Monique</td>
<td align="left">Scenic</td>
</tr>
<tr class="even">
<td align="left">Gunter</td>
<td align="left">Lada</td>
</tr>
<tr class="odd">
<td align="left">Rayan</td>
<td align="left">Twingo</td>
</tr>
<tr class="even">
<td align="left">Rayan</td>
<td align="left">Clio</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="10-dplyr.html#cb426-1"></a>voitures &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb426-2"><a href="10-dplyr.html#cb426-2"></a>    <span class="dt">voiture =</span> <span class="kw">c</span>(<span class="st">&quot;Twingo&quot;</span>, <span class="st">&quot;Ferrari&quot;</span>, <span class="st">&quot;Clio&quot;</span>, <span class="st">&quot;Lada&quot;</span>, <span class="st">&quot;208&quot;</span>),</span>
<span id="cb426-3"><a href="10-dplyr.html#cb426-3"></a>    <span class="dt">vitesse =</span> <span class="kw">c</span>(<span class="st">&quot;140&quot;</span>, <span class="st">&quot;280&quot;</span>, <span class="st">&quot;160&quot;</span>, <span class="st">&quot;85&quot;</span>, <span class="st">&quot;160&quot;</span>)</span>
<span id="cb426-4"><a href="10-dplyr.html#cb426-4"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">voiture</th>
<th align="left">vitesse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Ferrari</td>
<td align="left">280</td>
</tr>
<tr class="odd">
<td align="left">Clio</td>
<td align="left">160</td>
</tr>
<tr class="even">
<td align="left">Lada</td>
<td align="left">85</td>
</tr>
<tr class="odd">
<td align="left">208</td>
<td align="left">160</td>
</tr>
</tbody>
</table>
<div id="left_join" class="section level4">
<h4><span class="header-section-number">10.6.3.1</span> left_join</h4>
<p>Si on fait un <code>left_join</code> de <code>voitures</code> sur <code>personnes</code> :</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="10-dplyr.html#cb427-1"></a><span class="kw">left_join</span>(personnes, voitures)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
<th align="left">vitesse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sylvie</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Sylvie</td>
<td align="left">Ferrari</td>
<td align="left">280</td>
</tr>
<tr class="odd">
<td align="left">Monique</td>
<td align="left">Scenic</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Gunter</td>
<td align="left">Lada</td>
<td align="left">85</td>
</tr>
<tr class="odd">
<td align="left">Rayan</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Rayan</td>
<td align="left">Clio</td>
<td align="left">160</td>
</tr>
</tbody>
</table>
<p>On voit que chaque ligne de <code>personnes</code> est bien présente, et qu’on lui a ajouté une ligne de <code>voitures</code> correspondante si elle existe. Dans le cas du <code>Scenic</code>, il n’y a avait pas de ligne dans <code>voitures</code>, donc <code>vitesse</code> a été mise à <code>NA</code>. Dans le cas de <code>208</code>, présente dans <code>voitures</code> mais pas dans <code>personnes</code>, la ligne n’apparaît pas.</p>
<p>Si on fait un <code>left_join</code> cette fois de <code>personnes</code> sur <code>voitures</code>, c’est l’inverse :</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="10-dplyr.html#cb429-1"></a><span class="kw">left_join</span>(voitures, personnes)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">voiture</th>
<th align="left">vitesse</th>
<th align="left">nom</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Twingo</td>
<td align="left">140</td>
<td align="left">Sylvie</td>
</tr>
<tr class="even">
<td align="left">Twingo</td>
<td align="left">140</td>
<td align="left">Rayan</td>
</tr>
<tr class="odd">
<td align="left">Ferrari</td>
<td align="left">280</td>
<td align="left">Sylvie</td>
</tr>
<tr class="even">
<td align="left">Clio</td>
<td align="left">160</td>
<td align="left">Rayan</td>
</tr>
<tr class="odd">
<td align="left">Lada</td>
<td align="left">85</td>
<td align="left">Gunter</td>
</tr>
<tr class="even">
<td align="left">208</td>
<td align="left">160</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>La ligne <code>208</code> est là, mais <code>nom</code> est à <code>NA</code>. Par contre <code>Monique</code> est absente. Et on remarquera que la ligne <code>Twingo</code>, présente deux fois dans <code>personnes</code>, a été dupliquée pour être associée aux deux lignes de données de <code>Sylvie</code> et <code>Rayan</code>.</p>
<p>En résumé, quand on fait un <code>left_join(x, y)</code>, toutes les lignes de <code>x</code> sont présentes, et dupliquées si nécessaire quand elles apparaissent plusieurs fois dans <code>y</code>. Les lignes de <code>y</code> non présentes dans <code>x</code> disparaissent. Les lignes de <code>x</code> non présentes dans <code>y</code> se voient attribuer des <code>NA</code> pour les nouvelles colonnes.</p>
<p>Intuitivement, on pourrait considérer que <code>left_join(x, y)</code> signifie “ramener l’information de la table <code>y</code> sur la table <code>x</code>”.</p>
<p>En général, <code>left_join</code> sera le type de jointures le plus fréquemment utilisé.</p>
</div>
<div id="right_join" class="section level4">
<h4><span class="header-section-number">10.6.3.2</span> right_join</h4>
<p>La jointure <code>right_join</code> est l’exacte symétrique de <code>left_join</code>, c’est-à dire que <code>right_join(x, y)</code> est équivalent à <code>left_join(y, x)</code> :</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="10-dplyr.html#cb431-1"></a><span class="kw">right_join</span>(personnes, voitures)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
<th align="left">vitesse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sylvie</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Sylvie</td>
<td align="left">Ferrari</td>
<td align="left">280</td>
</tr>
<tr class="odd">
<td align="left">Gunter</td>
<td align="left">Lada</td>
<td align="left">85</td>
</tr>
<tr class="even">
<td align="left">Rayan</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="odd">
<td align="left">Rayan</td>
<td align="left">Clio</td>
<td align="left">160</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">208</td>
<td align="left">160</td>
</tr>
</tbody>
</table>
</div>
<div id="inner_join" class="section level4">
<h4><span class="header-section-number">10.6.3.3</span> inner_join</h4>
<p>Dans le cas de <code>inner_join(x, y)</code>, seules les lignes présentes à la fois dans <code>x</code> et <code>y</code> sont conservées (et si nécessaire dupliquées) dans la table résultat :</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="10-dplyr.html#cb433-1"></a><span class="kw">inner_join</span>(personnes, voitures)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
<th align="left">vitesse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sylvie</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Sylvie</td>
<td align="left">Ferrari</td>
<td align="left">280</td>
</tr>
<tr class="odd">
<td align="left">Gunter</td>
<td align="left">Lada</td>
<td align="left">85</td>
</tr>
<tr class="even">
<td align="left">Rayan</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="odd">
<td align="left">Rayan</td>
<td align="left">Clio</td>
<td align="left">160</td>
</tr>
</tbody>
</table>
<p>Ici la ligne <code>208</code> est absente, ainsi que la ligne <code>Monique</code>, qui dans le cas d’un <code>left_join</code> avait été conservée et s’était vue attribuer une <code>vitesse</code> à <code>NA</code>.</p>
</div>
<div id="full_join" class="section level4">
<h4><span class="header-section-number">10.6.3.4</span> full_join</h4>
<p>Dans le cas de <code>full_join(x, y)</code>, toutes les lignes de <code>x</code> et toutes les lignes de <code>y</code> sont conservées (avec des <code>NA</code> ajoutés si nécessaire) même si elles sont absentes de l’autre table :</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="10-dplyr.html#cb435-1"></a><span class="kw">full_join</span>(personnes, voitures)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
<th align="left">vitesse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sylvie</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Sylvie</td>
<td align="left">Ferrari</td>
<td align="left">280</td>
</tr>
<tr class="odd">
<td align="left">Monique</td>
<td align="left">Scenic</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Gunter</td>
<td align="left">Lada</td>
<td align="left">85</td>
</tr>
<tr class="odd">
<td align="left">Rayan</td>
<td align="left">Twingo</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">Rayan</td>
<td align="left">Clio</td>
<td align="left">160</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">208</td>
<td align="left">160</td>
</tr>
</tbody>
</table>
</div>
<div id="semi_join-et-anti_join" class="section level4">
<h4><span class="header-section-number">10.6.3.5</span> semi_join et anti_join</h4>
<p><code>semi_join</code> et <code>anti_join</code> sont des jointures <em>filtrantes</em>, c’est-à-dire qu’elles sélectionnent les lignes de <code>x</code> sans ajouter les colonnes de <code>y</code>.</p>
<p>Ainsi, <code>semi_join</code> ne conservera que les lignes de <code>x</code> pour lesquelles une ligne de <code>y</code> existe également, et supprimera les autres. Dans notre exemple, la ligne <code>Monique</code> est donc supprimée :</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="10-dplyr.html#cb437-1"></a><span class="kw">semi_join</span>(personnes, voitures)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sylvie</td>
<td align="left">Twingo</td>
</tr>
<tr class="even">
<td align="left">Sylvie</td>
<td align="left">Ferrari</td>
</tr>
<tr class="odd">
<td align="left">Gunter</td>
<td align="left">Lada</td>
</tr>
<tr class="even">
<td align="left">Rayan</td>
<td align="left">Twingo</td>
</tr>
<tr class="odd">
<td align="left">Rayan</td>
<td align="left">Clio</td>
</tr>
</tbody>
</table>
<p>Un <code>anti_join</code> fait l’inverse, il ne conserve que les lignes de <code>x</code> absentes de <code>y</code>. Dans notre exemple, on ne garde donc que la ligne <code>Monique</code> :</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="10-dplyr.html#cb439-1"></a><span class="kw">anti_join</span>(personnes, voitures)</span></code></pre></div>
<pre><code>#&gt; Joining, by = &quot;voiture&quot;</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">nom</th>
<th align="left">voiture</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Monique</td>
<td align="left">Scenic</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ressources-2" class="section level2">
<h2><span class="header-section-number">10.7</span> Ressources</h2>
<p>Toutes les ressources ci-dessous sont en anglais…</p>
<p>Le livre <em>R for data science</em>, librement accessible en ligne, contient plusieurs chapitres très complets sur la manipulation des données, notamment :</p>
<ul>
<li><a href="http://r4ds.had.co.nz/transform.html">Data transformation</a> pour les manipulations</li>
<li><a href="http://r4ds.had.co.nz/relational-data.html">Relational data</a> pour les tables multiples</li>
</ul>
<p>Le <a href="http://dplyr.tidyverse.org/">site de l’extension</a> comprend une <a href="http://dplyr.tidyverse.org/reference/index.html">liste des fonctions</a> et les pages d’aide associées, mais aussi une <a href="http://dplyr.tidyverse.org/articles/dplyr.html">introduction</a> au package et plusieurs articles dont un spécifiquement sur les <a href="http://dplyr.tidyverse.org/articles/two-table.html">jointures</a>.</p>
<p>Enfin, une “antisèche” très synthétique est également accessible depuis RStudio, en allant dans le menu <em>Help</em> puis <em>Cheatsheets</em> et <em>Data Transformation with dplyr</em>.</p>
</div>
<div id="exercices-5" class="section level2">
<h2><span class="header-section-number">10.8</span> Exercices</h2>
<p>On commence par charger les extensions et les données nécessaires.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="10-dplyr.html#cb441-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb441-2"><a href="10-dplyr.html#cb441-2"></a><span class="kw">library</span>(nycflights13)</span>
<span id="cb441-3"><a href="10-dplyr.html#cb441-3"></a><span class="kw">data</span>(flights)</span>
<span id="cb441-4"><a href="10-dplyr.html#cb441-4"></a><span class="kw">data</span>(airports)</span>
<span id="cb441-5"><a href="10-dplyr.html#cb441-5"></a><span class="kw">data</span>(airlines)</span></code></pre></div>
<div id="les-verbes-de-base-de-dplyr" class="section level3">
<h3><span class="header-section-number">10.8.1</span> Les verbes de base de <code>dplyr</code></h3>
<p><strong>Exercice 1.1</strong></p>
<p>Sélectionner les lignes 100 à 105 du tableau des vols (<code>flights</code>).</p>
<pre><code>#&gt; # A tibble: 6 × 19
#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt; 1  2013     1     1      752            759        -7      955            959
#&gt; 2  2013     1     1      753            755        -2     1056           1110
#&gt; 3  2013     1     1      754            759        -5     1039           1041
#&gt; 4  2013     1     1      754            755        -1     1103           1030
#&gt; 5  2013     1     1      758            800        -2     1053           1054
#&gt; 6  2013     1     1      759            800        -1     1057           1127
#&gt; # … with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#&gt; #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#&gt; #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="10-dplyr.html#cb443-1"></a><span class="kw">slice</span>(flights, <span class="dv">100</span><span class="op">:</span><span class="dv">105</span>)</span></code></pre></div>
</div>

<p><strong>Exercice 1.2</strong></p>
<p>Sélectionnez les vols du mois de juillet (variable <code>month</code>).</p>
<pre><code>#&gt; # A tibble: 29,425 × 19
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     7     1        1           2029       212      236           2359
#&gt;  2  2013     7     1        2           2359         3      344            344
#&gt;  3  2013     7     1       29           2245       104      151              1
#&gt;  4  2013     7     1       43           2130       193      322             14
#&gt;  5  2013     7     1       44           2150       174      300            100
#&gt;  6  2013     7     1       46           2051       235      304           2358
#&gt;  7  2013     7     1       48           2001       287      308           2305
#&gt;  8  2013     7     1       58           2155       183      335             43
#&gt;  9  2013     7     1      100           2146       194      327             30
#&gt; 10  2013     7     1      100           2245       135      337            135
#&gt; # … with 29,415 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="10-dplyr.html#cb445-1"></a><span class="kw">filter</span>(flights, month <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span></code></pre></div>
</div>

<p>Sélectionnez les vols avec un retard à l’arrivée (variable <code>arr_delay</code>) compris entre 5 et 15 minutes.</p>
<pre><code>#&gt; # A tibble: 36,392 × 19
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     1     1      517            515         2      830            819
#&gt;  2  2013     1     1      554            558        -4      740            728
#&gt;  3  2013     1     1      558            600        -2      753            745
#&gt;  4  2013     1     1      558            600        -2      924            917
#&gt;  5  2013     1     1      600            600         0      837            825
#&gt;  6  2013     1     1      611            600        11      945            931
#&gt;  7  2013     1     1      623            610        13      920            915
#&gt;  8  2013     1     1      624            630        -6      840            830
#&gt;  9  2013     1     1      629            630        -1      824            810
#&gt; 10  2013     1     1      632            608        24      740            728
#&gt; # … with 36,382 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="10-dplyr.html#cb447-1"></a><span class="kw">filter</span>(flights, arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;</span><span class="st"> </span>arr_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">15</span>)</span></code></pre></div>
</div>

<p>Sélectionnez les vols des compagnies Delta, United et American (codes <code>DL</code>, <code>UA</code> et <code>AA</code> de la variable <code>carrier</code>).</p>
<pre><code>#&gt; # A tibble: 139,504 × 19
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     1     1      517            515         2      830            819
#&gt;  2  2013     1     1      533            529         4      850            830
#&gt;  3  2013     1     1      542            540         2      923            850
#&gt;  4  2013     1     1      554            600        -6      812            837
#&gt;  5  2013     1     1      554            558        -4      740            728
#&gt;  6  2013     1     1      558            600        -2      753            745
#&gt;  7  2013     1     1      558            600        -2      924            917
#&gt;  8  2013     1     1      558            600        -2      923            937
#&gt;  9  2013     1     1      559            600        -1      941            910
#&gt; 10  2013     1     1      559            600        -1      854            902
#&gt; # … with 139,494 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="10-dplyr.html#cb449-1"></a><span class="kw">filter</span>(flights, carrier <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;DL&quot;</span>, <span class="st">&quot;UA&quot;</span>, <span class="st">&quot;AA&quot;</span>))</span></code></pre></div>
</div>

<p><strong>Exercice 1.3</strong></p>
<p>Triez la table <code>flights</code> par retard au départ décroissant.</p>
<pre><code>#&gt; # A tibble: 336,776 × 19
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     1     9      641            900      1301     1242           1530
#&gt;  2  2013     6    15     1432           1935      1137     1607           2120
#&gt;  3  2013     1    10     1121           1635      1126     1239           1810
#&gt;  4  2013     9    20     1139           1845      1014     1457           2210
#&gt;  5  2013     7    22      845           1600      1005     1044           1815
#&gt;  6  2013     4    10     1100           1900       960     1342           2211
#&gt;  7  2013     3    17     2321            810       911      135           1020
#&gt;  8  2013     6    27      959           1900       899     1236           2226
#&gt;  9  2013     7    22     2257            759       898      121           1026
#&gt; 10  2013    12     5      756           1700       896     1058           2020
#&gt; # … with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="10-dplyr.html#cb451-1"></a><span class="kw">arrange</span>(flights, <span class="kw">desc</span>(dep_delay))</span></code></pre></div>
</div>

<p><strong>Exercice 1.4</strong></p>
<p>Sélectionnez les colonnes <code>name</code>, <code>lat</code> et <code>lon</code> de la table <code>airports</code></p>
<pre><code>#&gt; # A tibble: 1,458 × 3
#&gt;    name                             lat    lon
#&gt;    &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1 Lansdowne Airport               41.1  -80.6
#&gt;  2 Moton Field Municipal Airport   32.5  -85.7
#&gt;  3 Schaumburg Regional             42.0  -88.1
#&gt;  4 Randall Airport                 41.4  -74.4
#&gt;  5 Jekyll Island Airport           31.1  -81.4
#&gt;  6 Elizabethton Municipal Airport  36.4  -82.2
#&gt;  7 Williams County Airport         41.5  -84.5
#&gt;  8 Finger Lakes Regional Airport   42.9  -76.8
#&gt;  9 Shoestring Aviation Airfield    39.8  -76.6
#&gt; 10 Jefferson County Intl           48.1 -123. 
#&gt; # … with 1,448 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="10-dplyr.html#cb453-1"></a><span class="kw">select</span>(airports, name, lat, lon)</span></code></pre></div>
</div>

<p>Sélectionnez toutes les colonnes de la table <code>airports</code> sauf les colonnes <code>tz</code> et <code>tzone</code></p>
<pre><code>#&gt; # A tibble: 1,458 × 6
#&gt;    faa   name                             lat    lon   alt dst  
#&gt;    &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
#&gt;  1 04G   Lansdowne Airport               41.1  -80.6  1044 A    
#&gt;  2 06A   Moton Field Municipal Airport   32.5  -85.7   264 A    
#&gt;  3 06C   Schaumburg Regional             42.0  -88.1   801 A    
#&gt;  4 06N   Randall Airport                 41.4  -74.4   523 A    
#&gt;  5 09J   Jekyll Island Airport           31.1  -81.4    11 A    
#&gt;  6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593 A    
#&gt;  7 0G6   Williams County Airport         41.5  -84.5   730 A    
#&gt;  8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492 A    
#&gt;  9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000 U    
#&gt; 10 0S9   Jefferson County Intl           48.1 -123.    108 A    
#&gt; # … with 1,448 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="10-dplyr.html#cb455-1"></a><span class="kw">select</span>(airports, <span class="op">-</span>tz, <span class="op">-</span>tzone)</span></code></pre></div>
</div>

<p>Toujours dans la table <code>airports</code>, renommez la colonne <code>lat</code> en <code>latitude</code> et <code>lon</code> en <code>longitude</code>.</p>
<pre><code>#&gt; # A tibble: 1,458 × 8
#&gt;    faa   name                 latitude longitude   alt    tz dst   tzone        
#&gt;    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        
#&gt;  1 04G   Lansdowne Airport        41.1     -80.6  1044    -5 A     America/New_…
#&gt;  2 06A   Moton Field Municip…     32.5     -85.7   264    -6 A     America/Chic…
#&gt;  3 06C   Schaumburg Regional      42.0     -88.1   801    -6 A     America/Chic…
#&gt;  4 06N   Randall Airport          41.4     -74.4   523    -5 A     America/New_…
#&gt;  5 09J   Jekyll Island Airpo…     31.1     -81.4    11    -5 A     America/New_…
#&gt;  6 0A9   Elizabethton Munici…     36.4     -82.2  1593    -5 A     America/New_…
#&gt;  7 0G6   Williams County Air…     41.5     -84.5   730    -5 A     America/New_…
#&gt;  8 0G7   Finger Lakes Region…     42.9     -76.8   492    -5 A     America/New_…
#&gt;  9 0P2   Shoestring Aviation…     39.8     -76.6  1000    -5 U     America/New_…
#&gt; 10 0S9   Jefferson County In…     48.1    -123.    108    -8 A     America/Los_…
#&gt; # … with 1,448 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="10-dplyr.html#cb457-1"></a><span class="kw">rename</span>(airports, <span class="dt">latitude =</span> lat, <span class="dt">longitude =</span> lon)</span></code></pre></div>
</div>

<p><strong>Exercice 1.5</strong></p>
<p>Dans la table <code>airports</code>, la colonne <code>alt</code> contient l’altitude de l’aéroport en pieds. Créer une nouvelle variable <code>alt_m</code> contenant l’altitude en mètres (on convertit des pieds en mètres en les divisant par 3.2808). Sélectionner dans la table obtenue uniquement les deux colonnes <code>alt</code> et <code>alt_m</code>.</p>
<pre><code>#&gt; # A tibble: 1,458 × 2
#&gt;      alt  alt_m
#&gt;    &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1  1044 318.  
#&gt;  2   264  80.5 
#&gt;  3   801 244.  
#&gt;  4   523 159.  
#&gt;  5    11   3.35
#&gt;  6  1593 486.  
#&gt;  7   730 223.  
#&gt;  8   492 150.  
#&gt;  9  1000 305.  
#&gt; 10   108  32.9 
#&gt; # … with 1,448 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="10-dplyr.html#cb459-1"></a>tmp &lt;-<span class="st"> </span><span class="kw">mutate</span>(airports, <span class="dt">alt_m =</span> alt <span class="op">/</span><span class="st"> </span><span class="fl">3.2808</span>)</span>
<span id="cb459-2"><a href="10-dplyr.html#cb459-2"></a><span class="kw">select</span>(tmp, alt, alt_m)</span></code></pre></div>
</div>

</div>
<div id="enchaîner-des-opérations" class="section level3">
<h3><span class="header-section-number">10.8.2</span> Enchaîner des opérations</h3>
<p><strong>Exercice 2.1</strong></p>
<p>Réécrire le code de l’exercice précédent en utilisant le <em>pipe</em> <code>%&gt;%</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="10-dplyr.html#cb460-1"></a>airports <span class="op">%&gt;%</span></span>
<span id="cb460-2"><a href="10-dplyr.html#cb460-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">alt_m =</span> alt <span class="op">/</span><span class="st"> </span><span class="fl">3.2808</span>) <span class="op">%&gt;%</span></span>
<span id="cb460-3"><a href="10-dplyr.html#cb460-3"></a><span class="st">  </span><span class="kw">select</span>(alt, alt_m)</span></code></pre></div>
</div>

<p><strong>Exercice 2.2</strong></p>
<p>En utilisant le <em>pipe</em>, sélectionnez les vols à destination de San Francico (code <code>SFO</code> de la variable <code>dest</code>) et triez-les selon le retard au départ décroissant (variable <code>dep_delay</code>).</p>
<pre><code>#&gt; # A tibble: 13,331 × 19
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     9    20     1139           1845      1014     1457           2210
#&gt;  2  2013     7     7     2123           1030       653       17           1345
#&gt;  3  2013     7     7     2059           1030       629      106           1350
#&gt;  4  2013     7     6      149           1600       589      456           1935
#&gt;  5  2013     7    10      133           1800       453      455           2130
#&gt;  6  2013     7    10     2342           1630       432      312           1959
#&gt;  7  2013     7     7     2204           1525       399      107           1823
#&gt;  8  2013     7     7     2306           1630       396      250           1959
#&gt;  9  2013     6    23     1833           1200       393       NA           1507
#&gt; 10  2013     7    10     2232           1609       383      138           1928
#&gt; # … with 13,321 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="10-dplyr.html#cb462-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb462-2"><a href="10-dplyr.html#cb462-2"></a><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;SFO&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb462-3"><a href="10-dplyr.html#cb462-3"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(dep_delay))</span></code></pre></div>
</div>

<p><strong>Exercice 2.3</strong></p>
<p>Sélectionnez les vols des mois de septembre et octobre, conservez les colonnes <code>dest</code> et <code>dep_delay</code>, créez une nouvelle variable <code>retard_h</code> contenant le retard au départ en heures, triez selon <code>retard_h</code> par ordre décroissant et conservez uniquement les 5 premières lignes.</p>
<pre><code>#&gt; # A tibble: 5 × 3
#&gt;   dest  dep_delay retard_h
#&gt;   &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1 SFO        1014    16.9 
#&gt; 2 ATL         702    11.7 
#&gt; 3 DTW         696    11.6 
#&gt; 4 ATL         602    10.0 
#&gt; 5 MSP         593     9.88</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="10-dplyr.html#cb464-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb464-2"><a href="10-dplyr.html#cb464-2"></a><span class="st">  </span><span class="kw">filter</span>(month <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">10</span>)) <span class="op">%&gt;%</span></span>
<span id="cb464-3"><a href="10-dplyr.html#cb464-3"></a><span class="st">  </span><span class="kw">select</span>(dest, dep_delay) <span class="op">%&gt;%</span></span>
<span id="cb464-4"><a href="10-dplyr.html#cb464-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">retard_h =</span> dep_delay <span class="op">/</span><span class="st"> </span><span class="dv">60</span>) <span class="op">%&gt;%</span></span>
<span id="cb464-5"><a href="10-dplyr.html#cb464-5"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(retard_h)) <span class="op">%&gt;%</span></span>
<span id="cb464-6"><a href="10-dplyr.html#cb464-6"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span></code></pre></div>
</div>

</div>
<div id="group_by-et-summarise" class="section level3">
<h3><span class="header-section-number">10.8.3</span> <code>group_by</code> et <code>summarise</code></h3>
<p><strong>Exercice 3.1</strong></p>
<p>Affichez le nombre de vols par mois.</p>
<pre><code>#&gt; # A tibble: 12 × 2
#&gt;    month     n
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt;  1     1 27004
#&gt;  2     2 24951
#&gt;  3     3 28834
#&gt;  4     4 28330
#&gt;  5     5 28796
#&gt;  6     6 28243
#&gt;  7     7 29425
#&gt;  8     8 29327
#&gt;  9     9 27574
#&gt; 10    10 28889
#&gt; 11    11 27268
#&gt; 12    12 28135</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="10-dplyr.html#cb466-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb466-2"><a href="10-dplyr.html#cb466-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb466-3"><a href="10-dplyr.html#cb466-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</span></code></pre></div>
</div>

<p>Triez la table résultat selon le nombre de vols croissant.</p>
<pre><code>#&gt; # A tibble: 12 × 2
#&gt;    month     n
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt;  1     2 24951
#&gt;  2     1 27004
#&gt;  3    11 27268
#&gt;  4     9 27574
#&gt;  5    12 28135
#&gt;  6     6 28243
#&gt;  7     4 28330
#&gt;  8     5 28796
#&gt;  9     3 28834
#&gt; 10    10 28889
#&gt; 11     8 29327
#&gt; 12     7 29425</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="10-dplyr.html#cb468-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb468-2"><a href="10-dplyr.html#cb468-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb468-3"><a href="10-dplyr.html#cb468-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb468-4"><a href="10-dplyr.html#cb468-4"></a><span class="st">  </span><span class="kw">arrange</span>(n)</span></code></pre></div>
</div>

<p><strong>Exercice 3.2</strong></p>
<p>Calculer la distance moyenne des vols selon l’aéroport de départ.</p>
<pre><code>#&gt; # A tibble: 3 × 2
#&gt;   origin distance_moyenne
#&gt;   &lt;chr&gt;             &lt;dbl&gt;
#&gt; 1 EWR               1057.
#&gt; 2 JFK               1266.
#&gt; 3 LGA                780.</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="10-dplyr.html#cb470-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb470-2"><a href="10-dplyr.html#cb470-2"></a><span class="st">  </span><span class="kw">group_by</span>(origin) <span class="op">%&gt;%</span></span>
<span id="cb470-3"><a href="10-dplyr.html#cb470-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">distance_moyenne =</span> <span class="kw">mean</span>(distance))</span></code></pre></div>
</div>

<p><strong>Exercice 3.3</strong></p>
<p>Calculer le nombre de vols à destination de Los Angeles (code <code>LAX</code>) pour chaque mois de l’année.</p>
<pre><code>#&gt; # A tibble: 12 × 2
#&gt;    month     n
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt;  1     1  1159
#&gt;  2     2  1030
#&gt;  3     3  1178
#&gt;  4     4  1382
#&gt;  5     5  1453
#&gt;  6     6  1430
#&gt;  7     7  1500
#&gt;  8     8  1505
#&gt;  9     9  1384
#&gt; 10    10  1409
#&gt; 11    11  1336
#&gt; 12    12  1408</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="10-dplyr.html#cb472-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb472-2"><a href="10-dplyr.html#cb472-2"></a><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;LAX&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb472-3"><a href="10-dplyr.html#cb472-3"></a><span class="st">  </span><span class="kw">count</span>(month)</span></code></pre></div>
</div>

<p><strong>Exercice 3.4</strong></p>
<p>Calculer le nombre de vols selon le mois et la destination.</p>
<pre><code>#&gt; # A tibble: 1,113 × 3
#&gt;    month dest      n
#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;
#&gt;  1     1 ALB      64
#&gt;  2     1 ATL    1396
#&gt;  3     1 AUS     169
#&gt;  4     1 AVL       2
#&gt;  5     1 BDL      37
#&gt;  6     1 BHM      25
#&gt;  7     1 BNA     399
#&gt;  8     1 BOS    1245
#&gt;  9     1 BQN      93
#&gt; 10     1 BTV     223
#&gt; # … with 1,103 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="10-dplyr.html#cb474-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb474-2"><a href="10-dplyr.html#cb474-2"></a><span class="st">  </span><span class="kw">count</span>(month, dest)</span></code></pre></div>
</div>

<p>Ne conserver, pour chaque mois, que la destination avec le nombre maximal de vols.</p>
<pre><code>#&gt; # A tibble: 12 × 3
#&gt; # Groups:   month [12]
#&gt;    month dest      n
#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;
#&gt;  1     1 ATL    1396
#&gt;  2     2 ATL    1267
#&gt;  3     3 ATL    1448
#&gt;  4     4 ATL    1490
#&gt;  5     5 ORD    1582
#&gt;  6     6 ORD    1547
#&gt;  7     7 ORD    1573
#&gt;  8     8 ORD    1604
#&gt;  9     9 ORD    1582
#&gt; 10    10 ORD    1604
#&gt; 11    11 ATL    1384
#&gt; 12    12 ATL    1463</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="10-dplyr.html#cb476-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb476-2"><a href="10-dplyr.html#cb476-2"></a><span class="st">  </span><span class="kw">count</span>(month, dest) <span class="op">%&gt;%</span></span>
<span id="cb476-3"><a href="10-dplyr.html#cb476-3"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb476-4"><a href="10-dplyr.html#cb476-4"></a><span class="st">  </span><span class="kw">filter</span>(n <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(n))</span></code></pre></div>
</div>

<p><strong>Exercice 3.5</strong></p>
<p>Calculer le nombre de vols selon le mois. Ajouter une colonne comportant le pourcentage de vols annuels réalisés par mois.</p>
<pre><code>#&gt; # A tibble: 12 × 3
#&gt;    month     n pourcentage
#&gt;    &lt;int&gt; &lt;int&gt;       &lt;dbl&gt;
#&gt;  1     1 27004        8.02
#&gt;  2     2 24951        7.41
#&gt;  3     3 28834        8.56
#&gt;  4     4 28330        8.41
#&gt;  5     5 28796        8.55
#&gt;  6     6 28243        8.39
#&gt;  7     7 29425        8.74
#&gt;  8     8 29327        8.71
#&gt;  9     9 27574        8.19
#&gt; 10    10 28889        8.58
#&gt; 11    11 27268        8.10
#&gt; 12    12 28135        8.35</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="10-dplyr.html#cb478-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb478-2"><a href="10-dplyr.html#cb478-2"></a><span class="st">  </span><span class="kw">count</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb478-3"><a href="10-dplyr.html#cb478-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pourcentage =</span> n<span class="op">/</span><span class="kw">sum</span>(n) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span></code></pre></div>
</div>

<p><strong>Exercice 3.6</strong></p>
<p>Calculer, pour chaque destination et chaque mois, le retard moyen à l’arrivée. Pour chaque mois, trier les destinations selon ce retard moyen décroissant, et (toujours pour chaque mois) ne conserver que les trois destinations avec le retard le plus important.</p>
<pre><code>#&gt; `summarise()` has grouped output by &#39;month&#39;. You can override using the `.groups` argument.
#&gt; # A tibble: 36 × 3
#&gt; # Groups:   month [12]
#&gt;    month dest  retard_moyen
#&gt;    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
#&gt;  1     1 TUL           68.1
#&gt;  2     1 OKC           57.7
#&gt;  3     1 CAE           55.9
#&gt;  4     2 DSM           48.2
#&gt;  5     2 TUL           33.5
#&gt;  6     2 GSP           32.9
#&gt;  7     3 DSM           60.6
#&gt;  8     3 CAE           46.9
#&gt;  9     3 PVD           44.3
#&gt; 10     4 CAE           71.3
#&gt; # … with 26 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="10-dplyr.html#cb480-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb480-2"><a href="10-dplyr.html#cb480-2"></a><span class="st">  </span><span class="kw">group_by</span>(month, dest) <span class="op">%&gt;%</span></span>
<span id="cb480-3"><a href="10-dplyr.html#cb480-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">retard_moyen =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb480-4"><a href="10-dplyr.html#cb480-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb480-5"><a href="10-dplyr.html#cb480-5"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(retard_moyen), <span class="dt">.by_group =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb480-6"><a href="10-dplyr.html#cb480-6"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
</div>

</div>
<div id="jointures-1" class="section level3">
<h3><span class="header-section-number">10.8.4</span> Jointures</h3>
<p><strong>Exercice 4.1</strong></p>
<p>Faire la jointure de la table <code>airlines</code> sur la table <code>flights</code> à l’aide de <code>left_join</code>.</p>
<pre><code>#&gt; # A tibble: 336,776 × 20
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     1     1      517            515         2      830            819
#&gt;  2  2013     1     1      533            529         4      850            830
#&gt;  3  2013     1     1      542            540         2      923            850
#&gt;  4  2013     1     1      544            545        -1     1004           1022
#&gt;  5  2013     1     1      554            600        -6      812            837
#&gt;  6  2013     1     1      554            558        -4      740            728
#&gt;  7  2013     1     1      555            600        -5      913            854
#&gt;  8  2013     1     1      557            600        -3      709            723
#&gt;  9  2013     1     1      557            600        -3      838            846
#&gt; 10  2013     1     1      558            600        -2      753            745
#&gt; # … with 336,766 more rows, and 12 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,
#&gt; #   name &lt;chr&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="10-dplyr.html#cb482-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb482-2"><a href="10-dplyr.html#cb482-2"></a><span class="st">  </span><span class="kw">left_join</span>(airlines)</span></code></pre></div>
</div>

<p><strong>Exercice 4.2</strong></p>
<p>À partir de la table résultat de l’exercice précédent, calculer le retard moyen au départ pour chaque compagnie, trier selon ce retard décroissant et ne conserver que le nom de la compagnie et le retard correspondant.</p>
<pre><code>#&gt; # A tibble: 16 × 2
#&gt;    name                        retard_moyen
#&gt;    &lt;chr&gt;                              &lt;dbl&gt;
#&gt;  1 Frontier Airlines Inc.             20.2 
#&gt;  2 ExpressJet Airlines Inc.           20.0 
#&gt;  3 Mesa Airlines Inc.                 19.0 
#&gt;  4 AirTran Airways Corporation        18.7 
#&gt;  5 Southwest Airlines Co.             17.7 
#&gt;  6 Endeavor Air Inc.                  16.7 
#&gt;  7 JetBlue Airways                    13.0 
#&gt;  8 Virgin America                     12.9 
#&gt;  9 SkyWest Airlines Inc.              12.6 
#&gt; 10 United Air Lines Inc.              12.1 
#&gt; 11 Envoy Air                          10.6 
#&gt; 12 Delta Air Lines Inc.                9.26
#&gt; 13 American Airlines Inc.              8.59
#&gt; 14 Alaska Airlines Inc.                5.80
#&gt; 15 Hawaiian Airlines Inc.              4.90
#&gt; 16 US Airways Inc.                     3.78</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="10-dplyr.html#cb484-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb484-2"><a href="10-dplyr.html#cb484-2"></a><span class="st">  </span><span class="kw">left_join</span>(airlines) <span class="op">%&gt;%</span></span>
<span id="cb484-3"><a href="10-dplyr.html#cb484-3"></a><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span></span>
<span id="cb484-4"><a href="10-dplyr.html#cb484-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">retard_moyen =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb484-5"><a href="10-dplyr.html#cb484-5"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(retard_moyen))</span></code></pre></div>
</div>

<p><strong>Exercice 4.3</strong></p>
<p>Faire la jointure de la table <code>airports</code> sur la table <code>flights</code> en utilisant comme clé le code de l’aéroport de destination.</p>
<pre><code>#&gt; # A tibble: 336,776 × 26
#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
#&gt;  1  2013     1     1      517            515         2      830            819
#&gt;  2  2013     1     1      533            529         4      850            830
#&gt;  3  2013     1     1      542            540         2      923            850
#&gt;  4  2013     1     1      544            545        -1     1004           1022
#&gt;  5  2013     1     1      554            600        -6      812            837
#&gt;  6  2013     1     1      554            558        -4      740            728
#&gt;  7  2013     1     1      555            600        -5      913            854
#&gt;  8  2013     1     1      557            600        -3      709            723
#&gt;  9  2013     1     1      557            600        -3      838            846
#&gt; 10  2013     1     1      558            600        -2      753            745
#&gt; # … with 336,766 more rows, and 18 more variables: arr_delay &lt;dbl&gt;,
#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,
#&gt; #   name &lt;chr&gt;, lat &lt;dbl&gt;, lon &lt;dbl&gt;, alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;,
#&gt; #   tzone &lt;chr&gt;</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="10-dplyr.html#cb486-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb486-2"><a href="10-dplyr.html#cb486-2"></a><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;dest&quot;</span> =<span class="st"> &quot;faa&quot;</span>))</span></code></pre></div>
</div>

<p>À partir de cette table, afficher pour chaque mois le nom de l’aéroport de destination ayant eu le plus petit nombre de vol.</p>
<pre><code>#&gt; # A tibble: 14 × 3
#&gt; # Groups:   month [12]
#&gt;    month name                      n
#&gt;    &lt;int&gt; &lt;chr&gt;                 &lt;int&gt;
#&gt;  1     1 Key West Intl             1
#&gt;  2     2 Jackson Hole Airport      3
#&gt;  3     3 Bangor Intl               2
#&gt;  4     4 Key West Intl             1
#&gt;  5     4 Myrtle Beach Intl         1
#&gt;  6     5 Columbia Metropolitan     9
#&gt;  7     6 Myrtle Beach Intl         1
#&gt;  8     7 La Guardia                1
#&gt;  9     8 South Bend Rgnl           1
#&gt; 10     9 South Bend Rgnl           5
#&gt; 11    10 Albany Intl               1
#&gt; 12    10 South Bend Rgnl           1
#&gt; 13    11 Blue Grass                1
#&gt; 14    12 South Bend Rgnl           1</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="10-dplyr.html#cb488-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb488-2"><a href="10-dplyr.html#cb488-2"></a><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;dest&quot;</span> =<span class="st"> &quot;faa&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb488-3"><a href="10-dplyr.html#cb488-3"></a><span class="st">  </span><span class="kw">count</span>(month, name) <span class="op">%&gt;%</span></span>
<span id="cb488-4"><a href="10-dplyr.html#cb488-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb488-5"><a href="10-dplyr.html#cb488-5"></a><span class="st">  </span><span class="kw">filter</span>(n <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(n))</span></code></pre></div>
</div>

<p><strong>Exercice 4.4</strong></p>
<p>Créer une table indiquant, pour chaque trajet, le nom de l’aéroport de départ et celui de l’aéroport d’arrivée.</p>
<pre><code>#&gt; # A tibble: 336,776 × 2
#&gt;    orig_name           dest_name                      
#&gt;    &lt;chr&gt;               &lt;chr&gt;                          
#&gt;  1 Newark Liberty Intl George Bush Intercontinental   
#&gt;  2 La Guardia          George Bush Intercontinental   
#&gt;  3 John F Kennedy Intl Miami Intl                     
#&gt;  4 John F Kennedy Intl &lt;NA&gt;                           
#&gt;  5 La Guardia          Hartsfield Jackson Atlanta Intl
#&gt;  6 Newark Liberty Intl Chicago Ohare Intl             
#&gt;  7 Newark Liberty Intl Fort Lauderdale Hollywood Intl 
#&gt;  8 La Guardia          Washington Dulles Intl         
#&gt;  9 John F Kennedy Intl Orlando Intl                   
#&gt; 10 La Guardia          Chicago Ohare Intl             
#&gt; # … with 336,766 more rows</code></pre>

<div class="solution-exo">
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="10-dplyr.html#cb490-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb490-2"><a href="10-dplyr.html#cb490-2"></a><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;dest&quot;</span> =<span class="st"> &quot;faa&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb490-3"><a href="10-dplyr.html#cb490-3"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">dest_name =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb490-4"><a href="10-dplyr.html#cb490-4"></a><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb490-5"><a href="10-dplyr.html#cb490-5"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">orig_name =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb490-6"><a href="10-dplyr.html#cb490-6"></a><span class="st">  </span><span class="kw">select</span>(orig_name, dest_name)</span></code></pre></div>
</div>

</div>
<div id="bonus" class="section level3">
<h3><span class="header-section-number">10.8.5</span> Bonus</h3>
<p><strong>Exercice 5.1</strong></p>
<p>Calculer le nombre de vols selon l’aéroport de destination, et fusionnez la table <code>airports</code> sur le résultat avec <code>left_join</code>. Stocker le résultat final dans un objet nommé <code>flights_dest</code>.</p>

<div class="solution-exo">
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="10-dplyr.html#cb491-1"></a>flights_dest &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span></span>
<span id="cb491-2"><a href="10-dplyr.html#cb491-2"></a><span class="st">  </span><span class="kw">count</span>(dest) <span class="op">%&gt;%</span></span>
<span id="cb491-3"><a href="10-dplyr.html#cb491-3"></a><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;dest&quot;</span>=<span class="st">&quot;faa&quot;</span>))</span></code></pre></div>
</div>

<p>Créez une carte interactive des résultats avec le package <code>leaflet</code> et le code suivant :</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="10-dplyr.html#cb492-1"></a><span class="kw">library</span>(leaflet)</span>
<span id="cb492-2"><a href="10-dplyr.html#cb492-2"></a><span class="kw">leaflet</span>(<span class="dt">data =</span> flights_dest) <span class="op">%&gt;%</span></span>
<span id="cb492-3"><a href="10-dplyr.html#cb492-3"></a><span class="st">  </span>addTiles <span class="op">%&gt;%</span></span>
<span id="cb492-4"><a href="10-dplyr.html#cb492-4"></a><span class="st">  </span><span class="kw">addCircles</span>(<span class="dt">lng =</span> <span class="op">~</span>lon, <span class="dt">lat =</span> <span class="op">~</span>lat, <span class="dt">radius =</span> <span class="op">~</span>n <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">popup =</span> <span class="op">~</span>name)</span>
<span id="cb492-5"><a href="10-dplyr.html#cb492-5"></a><span class="co">#&gt; Warning in validateCoords(lng, lat, funcName): Data contains 4 rows with either</span></span>
<span id="cb492-6"><a href="10-dplyr.html#cb492-6"></a><span class="co">#&gt; missing or invalid lat/lon values and will be ignored</span></span></code></pre></div>
<div id="htmlwidget-d638cade90071f18b513" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-d638cade90071f18b513">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircles","args":[[35.0402222,41.253053,42.748267,61.174361,33.636719,30.194528,35.436194,41.938889,44.807444,33.562942,36.124472,42.364347,null,44.471861,42.940525,34.200667,39.175361,45.777643,33.938833,40.9160833,38.138639,32.898647,41.411689,35.214,39.997972,38.373147,39.048836,39.902375,38.852083,39.861656,32.896828,41.533972,42.212444,39.642556,24.556111,26.072583,42.880833,36.09775,34.895556,40.481181,21.318681,29.645419,38.944533,29.984433,34.270615,39.717331,43.607333333,30.494056,36.080056,33.942536,38.0365,40.777245,33.817722,39.297606,28.429394,41.785972,35.042417,42.932556,25.79325,42.947222,43.139858,44.881956,29.993389,38.509794,41.391667,33.67975,37.721278,35.393089,41.303167,41.978603,36.894611,26.683161,45.588722,39.871944,33.434278,40.491467,null,33.829667,41.732581,43.646161,35.877639,37.505167,43.118866,26.536167,32.733556,29.533694,32.127583,41.708661,38.1740858,47.449,37.618972,37.3626,null,40.788389,38.695417,33.675667,27.395444,38.748697,null,43.111187,27.975472,36.198389,44.741445,35.810972,36.2818694],[-106.6091944,-70.060181,-73.801692,-149.996361,-84.428067,-97.669889,-82.541806,-72.683222,-68.828139,-86.75355,-86.678194,-71.005181,null,-73.153278,-78.732167,-118.358667,-76.668333,-111.160151,-81.119528,-81.4421944,-78.452861,-80.040528,-81.849794,-80.943139,-82.891889,-81.593189,-84.667822,-84.219375,-77.037722,-104.673178,-97.037997,-93.663083,-83.353389,-106.917694,-81.759556,-80.15275,-85.522806,-79.937306,-82.218889,-107.21766,-157.922428,-95.278889,-77.455811,-95.341442,-77.902569,-86.294383,-110.73775,-81.687861,-115.15225,-118.408075,-84.605889,-73.872608,-118.151611,-94.713905,-81.308994,-87.752417,-89.976667,-71.435667,-80.290556,-87.896583,-89.337514,-93.221767,-90.258028,-107.894242,-70.615278,-78.928333,-122.220722,-97.600733,-95.894069,-87.904842,-76.201222,-80.095589,-122.5975,-75.241139,-112.011583,-80.232872,null,-116.506694,-71.420383,-70.309281,-78.787472,-77.319667,-77.672389,-81.755167,-117.189667,-98.469778,-81.202139,-86.31725,-85.7364989,-122.309306,-122.374889,-121.929022,null,-111.977772,-121.590778,-117.868222,-82.554389,-90.370028,null,-76.106311,-82.53325,-95.888111,-85.582235,-83.994028,-94.3068111],[2540,2650,4390,80,172150,24390,2750,4430,3750,2970,63330,155080,8960,25890,46810,3710,17810,360,1160,8640,520,28840,45730,140640,35240,1380,39410,15250,97050,72660,87380,5690,93840,2130,170,120550,7650,16060,8490,150,7070,21150,57000,71980,1100,20770,250,27200,59970,161740,10,10,6680,20080,140820,41130,17890,10090,117280,28020,5720,71850,37990,150,2210,590,3120,3460,8490,172830,15360,65540,13540,16320,46560,28750,3650,190,3760,23520,81630,24540,24160,35370,27370,6860,8040,100,11570,39230,133310,3290,58190,24670,2840,8250,12110,43390,5220,17610,74660,3150,1010,6310,10360],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},["Albuquerque International Sunport","Nantucket Mem","Albany Intl","Ted Stevens Anchorage Intl","Hartsfield Jackson Atlanta Intl","Austin Bergstrom Intl","Asheville Regional Airport","Bradley Intl","Bangor Intl","Birmingham Intl","Nashville Intl","General Edward Lawrence Logan Intl",null,"Burlington Intl","Buffalo Niagara Intl","Bob Hope","Baltimore Washington Intl","Gallatin Field","Columbia Metropolitan","Akron Canton Regional Airport","Charlottesville-Albemarle","Charleston Afb Intl","Cleveland Hopkins Intl","Charlotte Douglas Intl","Port Columbus Intl","Yeager","Cincinnati Northern Kentucky Intl","James M Cox Dayton Intl","Ronald Reagan Washington Natl","Denver Intl","Dallas Fort Worth Intl","Des Moines Intl","Detroit Metro Wayne Co","Eagle Co Rgnl","Key West Intl","Fort Lauderdale Hollywood Intl","Gerald R Ford Intl","Piedmont Triad","Greenville-Spartanburg International","Yampa Valley","Honolulu Intl","William P Hobby","Washington Dulles Intl","George Bush Intercontinental","Wilmington Intl","Indianapolis Intl","Jackson Hole Airport","Jacksonville Intl","Mc Carran Intl","Los Angeles Intl","Blue Grass","La Guardia","Long Beach","Kansas City Intl","Orlando Intl","Chicago Midway Intl","Memphis Intl","Manchester Regional Airport","Miami Intl","General Mitchell Intl","Dane Co Rgnl Truax Fld","Minneapolis St Paul Intl","Louis Armstrong New Orleans Intl","Montrose Regional Airport","Martha\\\\'s Vineyard","Myrtle Beach Intl","Metropolitan Oakland Intl","Will Rogers World","Eppley Afld","Chicago Ohare Intl","Norfolk Intl","Palm Beach Intl","Portland Intl","Philadelphia Intl","Phoenix Sky Harbor Intl","Pittsburgh Intl",null,"Palm Springs Intl","Theodore Francis Green State","Portland Intl Jetport","Raleigh Durham Intl","Richmond Intl","Greater Rochester Intl","Southwest Florida Intl","San Diego Intl","San Antonio Intl","Savannah Hilton Head Intl","South Bend Rgnl","Louisville International Airport","Seattle Tacoma Intl","San Francisco Intl","Norman Y Mineta San Jose Intl",null,"Salt Lake City Intl","Sacramento Intl","John Wayne Arpt Orange Co","Sarasota Bradenton Intl","Lambert St Louis Intl",null,"Syracuse Hancock Intl","Tampa Intl","Tulsa Intl","Cherry Capital Airport","Mc Ghee Tyson","NW Arkansas Regional"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[21.318681,61.174361],"lng":[-157.922428,-68.828139]}},"evals":[],"jsHooks":[]}</script>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="15">
<li id="fn15"><p>À noter que cette opération est un peu plus “fragile” que les autres, car si l’ordre des colonnes change elle peut renvoyer un résultat différent.<a href="10-dplyr.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Il est également possible de renommer des colonnes directement avec <code>select</code>, avec la même syntaxe que pour <code>rename</code>.<a href="10-dplyr.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>Le <em>pipe</em> a été introduit à l’origine par l’extension <code>magrittr</code>, et repris par <code>dplyr</code><a href="10-dplyr.html#fnref17" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="09-recodages.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="11-stringr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/juba/tidyverse/blob/main/10-dplyr.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["introduction_au_tidyverse.epub", "introduction_au_tidyverse.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
